import numpy as np
import matplotlib.pyplot as plt

### IMAGES HERE ARE BINARIZED !!

#### RING LIKE SCHEME (FM + ANSATZ) w GALAXY (256 features)

loss16_1_rl = [4.722474575042725, 4.663247108459473, 4.602138519287109, 4.3593902587890625, 4.25773811340332, 3.958470582962036, 4.272881031036377, 4.231320858001709, 3.8467395305633545, 3.567568302154541, 3.4140732288360596, 3.2621610164642334, 3.181107521057129, 3.4569644927978516, 3.3754491806030273, 3.1291823387145996, 3.094163656234741, 2.9710967540740967, 2.9564297199249268, 2.9019949436187744]
tr_acc16_1_rl = [0.16666666666666666, 0.3333333333333333, 0.3333333333333333, 0.5, 0.5, 0.6666666666666666, 0.16666666666666666, 0.5, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss16_2_rl = [3.561580181121826, 3.544593095779419, 3.43224835395813, 3.3862850666046143, 3.2485013008117676, 3.16645884513855, 3.198777675628662, 3.1313629150390625, 3.0364415645599365, 2.928337574005127, 2.9063169956207275, 2.892383098602295, 4.189720153808594, 4.032607555389404, 4.009553909301758, 3.753098964691162, 3.72709059715271, 3.6587328910827637, 3.570147752761841, 3.4277126789093018]
tr_acc16_2_rl = [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0]
loss16_3_rl=[3.505011796951294, 3.458282709121704, 3.4398622512817383, 3.357456922531128, 3.2259583473205566, 3.1396522521972656, 3.132546901702881, 3.0532937049865723, 2.989684581756592, 3.0131311416625977, 2.9614834785461426, 2.9397435188293457, 2.903062105178833, 2.907540798187256, 2.8677268028259277, 2.8770649433135986, 2.8917717933654785, 2.843400478363037, 2.8466098308563232, 2.7820560932159424]
tr_acc16_3_rl =  [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss16_4_rl=[3.2628281116485596, 3.2675859928131104, 3.2014975547790527, 3.172727108001709, 3.0891683101654053, 3.0446910858154297, 3.0389888286590576, 2.9621262550354004, 2.895451068878174, 2.879744052886963, 2.872483730316162, 2.854367971420288, 2.7842094898223877, 2.7401373386383057, 2.701249599456787, 2.7007830142974854, 2.6434967517852783, 2.6187713146209717, 2.6302623748779297, 2.6216585636138916]
tr_acc16_4_rl = [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss16_5_rl=[3.2233262062072754, 3.220836639404297, 3.1098639965057373, 3.1095821857452393, 3.0612235069274902, 3.0639986991882324, 2.980123281478882, 2.904275417327881, 2.9297075271606445, 2.9013853073120117, 2.931748867034912, 2.9445242881774902, 2.9275972843170166, 2.8712832927703857, 2.844701051712036, 2.885002374649048, 2.8783798217773438, 2.860236406326294, 2.8630781173706055, 2.8407933712005615]
tr_acc16_5_rl =  [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

tr_acc_fin =[1.0,1.0,1.0,1.0,1.0]
test_acc_fin=[0.75,0.75,0.79,0.72,0.64]

loss6_rl_16=np.array([loss16_1_rl,loss16_2_rl,loss16_3_rl,loss16_4_rl,loss16_5_rl])
tracc6_rl_16=np.array([tr_acc16_1_rl,tr_acc16_2_rl,tr_acc16_3_rl,tr_acc16_4_rl,tr_acc16_5_rl])

missed_rl_6_16 = [46, 48, 53, 60, 56]
missed0_rl_6_16 = [34, 28, 29, 34, 31]
missed1_rl_6_16= [12, 20, 24, 26, 25]
"""
Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.66666667, 1.        ]), array([1. , 0.5]), array([0.8       , 0.66666667]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.66666667, 1.        ]), array([1. , 0.5]), array([0.8       , 0.66666667]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.70422535, 1.        ]), array([1.  , 0.58]), array([0.82644628, 0.73417722]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.64102564, 1.        ]), array([1.  , 0.44]), array([0.78125   , 0.61111111]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.58139535, 1.        ]), array([1.  , 0.28]), array([0.73529412, 0.4375    ]), array([50, 50]))
"""

# Training w 10 images
loss16_1_rl_10 =[7.8453688621521, 7.824584484100342, 7.689943790435791, 7.217511177062988, 6.9274091720581055, 6.5150227546691895, 5.847369194030762, 5.814847946166992, 5.634822368621826, 5.532459735870361, 5.470279216766357, 5.298142433166504, 5.143604755401611, 5.110236644744873, 5.065192699432373, 4.956639766693115, 4.864565372467041, 4.84466552734375, 4.816254138946533, 4.7788310050964355]
tr_acc16_1_rl_10 = [0.2, 0.2, 0.2, 0.4, 0.6, 0.7, 0.9, 0.8, 1.0, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 1.0, 0.9, 1.0, 1.0]
loss16_2_rl_10 = [5.798250198364258, 5.761418342590332, 5.53690767288208, 5.580387592315674, 5.520416259765625, 5.420717239379883, 5.350193977355957, 5.349160671234131, 5.099610805511475, 5.112287521362305, 5.152731895446777, 5.076793670654297, 5.084355354309082, 5.112615585327148, 5.083977699279785, 5.078372478485107, 5.072859764099121, 5.060051918029785, 5.044002532958984, 5.041031837463379]
tr_acc16_2_rl_10 =[0.6, 0.6, 0.8, 0.7, 0.7, 0.8, 0.8, 0.8, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss16_3_rl_10=[5.958460807800293, 5.9036478996276855, 5.7736968994140625, 5.621166706085205, 5.650363922119141, 5.466150760650635, 5.340267181396484, 5.281360626220703, 5.280589580535889, 5.241693496704102, 5.21215295791626, 5.190091133117676, 5.185779571533203, 5.188366413116455, 5.203258037567139, 5.218881607055664, 5.194953918457031, 5.169953346252441, 5.166969299316406, 5.117254257202148]
tr_acc16_3_rl_10 =[0.6, 0.6, 0.7, 0.7, 0.7, 0.8, 0.7, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.9]
loss16_4_rl_10=[5.949822425842285, 5.86838436126709, 5.816717147827148, 5.7249555587768555, 5.316564083099365, 5.174129486083984, 5.114570617675781, 5.1124067306518555, 5.060357570648193, 5.044110298156738, 4.686972618103027, 4.6994452476501465, 4.6895833015441895, 4.647224426269531, 4.620738506317139, 4.687601089477539, 4.644739151000977, 4.657887935638428, 4.6134538650512695, 4.683820724487305]
tr_acc16_4_rl_10 =[0.7, 0.7, 0.7, 0.7, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss16_5_rl_10=[5.527805328369141, 5.558783054351807, 5.424278736114502, 5.309602737426758, 5.342523097991943, 5.314031600952148, 5.182512283325195, 5.12058687210083, 5.084928512573242, 5.056274890899658, 4.969464302062988, 4.9697136878967285, 4.942012786865234, 4.8806281089782715, 4.840365409851074, 4.820066452026367, 4.743010520935059, 4.728873252868652, 4.7709150314331055, 4.758779525756836]
tr_acc16_5_rl_10 =[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

tr_acc_fin10 =[1.0,1.0,0.9,1.0,1.0]
test_acc_fin10 =[0.71,0.71,0.75,0.79,0.83]

loss10_rl_16=np.array([loss16_1_rl_10,loss16_2_rl_10,loss16_3_rl_10,loss16_4_rl_10,loss16_5_rl_10])
tracc10_rl_16=np.array([tr_acc16_1_rl_10,tr_acc16_2_rl_10,tr_acc16_3_rl_10,tr_acc16_4_rl_10,tr_acc16_5_rl_10])

missed_rl_10_16 = [29, 29, 25, 21, 17]
missed0_rl_10_16 = [0, 0, 0, 0, 0]
missed1_rl_10_16= [29, 29, 25, 21, 17]
"""
Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([5, 5]))
Precision, recall, f_score, support: (array([0.63291139, 1.        ]), array([1.  , 0.42]), array([0.7751938, 0.5915493]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([5, 5]))
Precision, recall, f_score, support: (array([0.63291139, 1.        ]), array([1.  , 0.42]), array([0.7751938, 0.5915493]), array([50, 50]))

Precision, recall, f_score, support: (array([0.83333333, 1.        ]), array([1. , 0.8]), array([0.90909091, 0.88888889]), array([5, 5]))
Precision, recall, f_score, support: (array([0.66666667, 1.        ]), array([1. , 0.5]), array([0.8       , 0.66666667]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([5, 5]))
Precision, recall, f_score, support: (array([0.70422535, 1.        ]), array([1.  , 0.58]), array([0.82644628, 0.73417722]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([5, 5]))
Precision, recall, f_score, support: (array([0.74626866, 1.        ]), array([1.  , 0.66]), array([0.85470085, 0.79518072]), array([50, 50]))

"""

# Training w 20 images
loss16_1_rl_20 =[16.611480712890625, 16.501131057739258, 15.801280975341797, 14.329237937927246, 12.940704345703125, 12.71647834777832, 12.314558029174805, 12.133614540100098, 11.846283912658691, 11.844276428222656, 11.559574127197266, 11.419158935546875, 11.276386260986328, 11.285770416259766, 11.234150886535645, 11.00495719909668, 10.841020584106445, 10.723639488220215, 10.744277000427246, 10.776590347290039]
tr_acc16_1_rl_20 = [0.15, 0.15, 0.2, 0.35, 0.7, 0.65, 0.65, 0.65, 0.65, 0.65, 0.7, 0.7, 0.7, 0.75, 0.7, 0.75, 0.75, 0.8, 0.75, 0.85]
loss16_2_rl_20 = [11.317957878112793, 11.314059257507324, 11.508073806762695, 11.350799560546875, 11.210150718688965, 11.108927726745605, 10.924907684326172, 10.86373519897461, 10.751890182495117, 10.629151344299316, 10.537111282348633, 10.472282409667969, 10.452962875366211, 10.423189163208008, 10.308479309082031, 10.272371292114258, 10.248826026916504, 10.152748107910156, 10.074336051940918, 10.017578125]
tr_acc16_2_rl_20 =[0.8, 0.8, 1.0, 0.95, 0.9, 0.95, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.95, 0.95, 0.95, 0.95]
loss16_3_rl_20=[10.908003807067871, 10.913745880126953, 10.709397315979004, 10.595857620239258, 10.588631629943848, 10.471545219421387, 10.458324432373047, 10.401101112365723, 10.376119613647461, 10.353271484375, 10.354454040527344, 10.308465957641602, 10.316462516784668, 10.208646774291992, 10.1875581741333, 10.240742683410645, 10.274959564208984, 10.246087074279785, 10.225358963012695, 10.292013168334961]
tr_acc16_3_rl_20 =[0.8, 0.8, 0.9, 0.85, 0.9, 0.9, 0.9, 0.9, 0.9, 0.85, 0.85, 0.85, 0.85, 0.9, 0.9, 0.85, 0.85, 0.85, 0.85, 0.9]
loss16_4_rl_20=[10.601799011230469, 10.518202781677246, 10.356743812561035, 10.117706298828125, 10.044673919677734, 9.91916275024414, 9.804183959960938, 9.72774887084961, 9.765182495117188, 9.629584312438965, 9.613004684448242, 9.512341499328613, 9.500804901123047, 9.55274486541748, 9.474546432495117, 9.478535652160645, 9.487543106079102, 9.535554885864258, 9.540730476379395, 9.514840126037598]
tr_acc16_4_rl_20 =[0.8, 0.8, 0.85, 0.9, 0.9, 0.9, 0.95, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.95, 0.95]
loss16_5_rl_20=[10.613812446594238, 10.626652717590332, 10.515435218811035, 10.511924743652344, 10.373087882995605, 10.1708345413208, 10.102792739868164, 10.139060974121094, 10.09595012664795, 10.088297843933105, 10.170783042907715, 10.152445793151855, 10.023653030395508, 10.0117769241333, 9.983806610107422, 10.017523765563965, 10.019865036010742, 10.058206558227539, 10.077150344848633, 9.91525936126709]
tr_acc16_5_rl_20 =[0.85, 0.8, 0.85, 0.85, 0.85, 0.9, 0.9, 0.95, 0.95, 0.9, 0.95, 0.95, 0.95, 0.95, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

tr_acc_fin20 =[0.85,0.95,0.9,0.95,1.0]
test_acc_fin20 =[0.81,0.85,0.83,0.85,0.9]

loss20_rl_16=np.array([loss16_1_rl_20,loss16_2_rl_20,loss16_3_rl_20,loss16_4_rl_20,loss16_5_rl_20])
tracc20_rl_16=np.array([tr_acc16_1_rl_20,tr_acc16_2_rl_20,tr_acc16_3_rl_20,tr_acc16_4_rl_20,tr_acc16_5_rl_20])

missed_rl_20_16 = [19, 15, 17, 15, 10]
missed0_rl_20_16 = [0, 0, 0, 0, 0]
missed1_rl_20_16= [19, 15, 17, 15, 10]
"""
Precision, recall, f_score, support: (array([0.76923077, 1.        ]), array([1. , 0.7]), array([0.86956522, 0.82352941]), array([10, 10]))
Precision, recall, f_score, support: (array([0.72463768, 1.        ]), array([1.  , 0.62]), array([0.84033613, 0.7654321 ]), array([50, 50]))

Precision, recall, f_score, support: (array([0.90909091, 1.        ]), array([1. , 0.9]), array([0.95238095, 0.94736842]), array([10, 10]))
Precision, recall, f_score, support: (array([0.76923077, 1.        ]), array([1. , 0.7]), array([0.86956522, 0.82352941]), array([50, 50]))

Precision, recall, f_score, support: (array([0.83333333, 1.        ]), array([1. , 0.8]), array([0.90909091, 0.88888889]), array([10, 10]))
Precision, recall, f_score, support: (array([0.74626866, 1.        ]), array([1.  , 0.66]), array([0.85470085, 0.79518072]), array([50, 50]))

Precision, recall, f_score, support: (array([0.90909091, 1.        ]), array([1. , 0.9]), array([0.95238095, 0.94736842]), array([10, 10]))
Precision, recall, f_score, support: (array([0.76923077, 1.        ]), array([1. , 0.7]), array([0.86956522, 0.82352941]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([10, 10]))
Precision, recall, f_score, support: (array([0.83333333, 1.        ]), array([1. , 0.8]), array([0.90909091, 0.88888889]), array([50, 50]))

"""

#### MANCANO 30 E 40 !!!!

# Training w 30 images
loss16_1_rl_30 =[24.335006713867188, 24.262813568115234, 22.322935104370117, 19.609683990478516, 19.22787094116211, 18.81073570251465, 18.469406127929688, 18.230934143066406, 17.540597915649414, 17.42568016052246, 17.477930068969727, 17.32693099975586, 17.117300033569336, 16.730009078979492, 16.68132972717285, 16.51373863220215, 16.374372482299805, 16.181472778320312, 16.061616897583008, 15.982547760009766]
tr_acc16_1_rl_30 =  [0.16666666666666666, 0.16666666666666666, 0.26666666666666666, 0.7, 0.7, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.8333333333333334, 0.8333333333333334]
loss16_2_rl_30 = [16.63238525390625, 16.600502014160156, 16.492815017700195, 16.410661697387695, 16.453914642333984, 16.3782901763916, 16.104869842529297, 16.256046295166016, 16.20602035522461, 16.213531494140625, 16.17024803161621, 16.086719512939453, 16.15823745727539, 16.19687271118164, 16.09469985961914, 16.156461715698242, 16.049339294433594, 16.01094627380371, 16.0469913482666, 20.44095230102539]
tr_acc16_2_rl_30 =[0.8666666666666667, 0.8666666666666667, 0.8, 0.8666666666666667, 0.8333333333333334, 0.8, 0.8333333333333334, 0.8333333333333334, 0.8, 0.8333333333333334, 0.8333333333333334, 0.9, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8666666666666667, 0.8666666666666667, 0.8666666666666667, 0.6]
loss16_3_rl_30=[19.605716705322266, 19.587501525878906, 19.37360191345215, 18.118255615234375, 17.747390747070312, 17.317035675048828, 16.965457916259766, 16.932039260864258, 16.652822494506836, 16.57123374938965, 16.126258850097656, 16.137126922607422, 16.119308471679688, 16.176301956176758, 15.970441818237305, 16.027231216430664, 15.98298168182373, 15.916147232055664, 15.884471893310547, 15.856167793273926]
tr_acc16_3_rl_30 =[0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7, 0.7666666666666667, 0.8, 0.8666666666666667, 0.8666666666666667, 0.8666666666666667, 0.8666666666666667, 0.8333333333333334, 0.8666666666666667, 0.8333333333333334, 0.8, 0.8333333333333334, 0.9, 0.8666666666666667, 0.8666666666666667, 0.8333333333333334, 0.8666666666666667]
loss16_4_rl_30=[16.98580551147461, 16.967544555664062, 16.69290542602539, 16.505395889282227, 16.561782836914062, 16.467504501342773, 16.349388122558594, 16.26401138305664, 16.081703186035156, 15.981956481933594, 15.902420043945312, 15.84422492980957, 15.845518112182617, 15.565421104431152, 15.469536781311035, 15.443723678588867, 15.41972541809082, 15.40282154083252, 15.568452835083008, 15.538159370422363]
tr_acc16_4_rl_30 = [0.7666666666666667, 0.7666666666666667, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8666666666666667, 0.8333333333333334, 0.8666666666666667, 0.9, 0.8666666666666667, 0.8666666666666667, 0.8666666666666667, 0.9333333333333333, 0.9, 0.9333333333333333, 0.9666666666666667, 0.9666666666666667, 0.9666666666666667, 0.9666666666666667, 1.0]
loss16_5_rl_30=[16.180496215820312, 16.108901977539062, 15.702691078186035, 15.62486457824707, 15.463140487670898, 15.5184965133667, 15.457571029663086, 15.414546966552734, 15.254528045654297, 15.361191749572754, 15.340248107910156, 15.177934646606445, 15.119635581970215, 15.147863388061523, 15.1337890625, 15.141834259033203, 15.174040794372559, 15.137725830078125, 15.104987144470215, 16.228513717651367]
tr_acc16_5_rl_30 =[0.8666666666666667, 0.8666666666666667, 0.9, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9666666666666667, 0.9666666666666667, 0.9666666666666667, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 0.8333333333333334]

tr_acc_fin30 =[0.8666666666666667,0.6,0.8333333333333334,0.9666666666666667,0.8666666666666667]
test_acc_fin30 =[0.8,0.61,0.74,0.74,0.76]

loss30_rl_16=np.array([loss16_1_rl_30,loss16_2_rl_30,loss16_3_rl_30,loss16_4_rl_30,loss16_5_rl_30])
tracc30_rl_16=np.array([tr_acc16_1_rl_30,tr_acc16_2_rl_30,tr_acc16_3_rl_30,tr_acc16_4_rl_30,tr_acc16_5_rl_30])

missed_rl_30_16 = [20, 39, 26, 26, 24]
missed0_rl_30_16 = [0, 6, 0, 0, 0]
missed1_rl_30_16= [20, 33, 26, 26, 24]
"""
Precision, recall, f_score, support: (array([0.78947368, 1.        ]), array([1.        , 0.73333333]), array([0.88235294, 0.84615385]), array([15, 15]))
Precision, recall, f_score, support: (array([0.71428571, 1.        ]), array([1. , 0.6]), array([0.83333333, 0.75      ]), array([50, 50]))

Precision, recall, f_score, support: (array([0.56, 0.8 ]), array([0.93333333, 0.26666667]), array([0.7, 0.4]), array([15, 15]))
Precision, recall, f_score, support: (array([0.57142857, 0.73913043]), array([0.88, 0.34]), array([0.69291339, 0.46575342]), array([50, 50]))

Precision, recall, f_score, support: (array([0.75, 1.  ]), array([1.        , 0.66666667]), array([0.85714286, 0.8       ]), array([15, 15]))
Precision, recall, f_score, support: (array([0.65789474, 1.        ]), array([1.  , 0.48]), array([0.79365079, 0.64864865]), array([50, 50]))

Precision, recall, f_score, support: (array([0.9375, 1.    ]), array([1.        , 0.93333333]), array([0.96774194, 0.96551724]), array([15, 15]))
Precision, recall, f_score, support: (array([0.65789474, 1.        ]), array([1.  , 0.48]), array([0.79365079, 0.64864865]), array([50, 50]))

Precision, recall, f_score, support: (array([0.78947368, 1.        ]), array([1.        , 0.73333333]), array([0.88235294, 0.84615385]), array([15, 15]))
Precision, recall, f_score, support: (array([0.67567568, 1.        ]), array([1.  , 0.52]), array([0.80645161, 0.68421053]), array([50, 50]))

"""

# Training w 40 images
loss16_1_rl_40 =[32.34001541137695, 32.272769927978516, 29.533401489257812, 25.506507873535156, 25.22754669189453, 24.4583797454834, 24.39177894592285, 23.9206485748291, 23.734987258911133, 23.40953254699707, 22.714078903198242, 22.503067016601562, 22.323823928833008, 22.147493362426758, 22.06801414489746, 21.941551208496094, 21.826824188232422, 21.70217514038086, 21.62919044494629, 21.4680118560791]
tr_acc16_1_rl_40 =[0.2, 0.225, 0.25, 0.675, 0.7, 0.725, 0.7, 0.7, 0.7, 0.725, 0.775, 0.775, 0.825, 0.8, 0.825, 0.8, 0.825, 0.825, 0.825, 0.825]
loss16_2_rl_40 =[21.685667037963867, 21.56739616394043, 21.68832778930664, 21.50450897216797, 21.192331314086914, 21.2094669342041, 21.20308494567871, 21.16132164001465, 21.058488845825195, 21.037626266479492, 20.984542846679688, 20.851139068603516, 20.86678695678711, 20.932098388671875, 20.895849227905273, 20.66033935546875, 20.561800003051758, 20.495140075683594, 20.61444664001465, 20.76990509033203]
tr_acc16_2_rl_40 =[0.825, 0.825, 0.825, 0.825, 0.825, 0.85, 0.825, 0.825, 0.825, 0.825, 0.825, 0.875, 0.85, 0.825, 0.9, 0.875, 0.9, 0.9, 0.875, 0.9]
loss16_3_rl_40=[22.272130966186523, 22.254594802856445, 22.1060848236084, 22.061264038085938, 22.036588668823242, 22.032304763793945, 21.484220504760742, 21.44617462158203, 21.394794464111328, 21.30720329284668, 21.25436019897461, 21.240352630615234, 21.23352813720703, 21.34686279296875, 21.456775665283203, 21.37687110900879, 21.423856735229492, 21.36945343017578, 21.416091918945312, 21.375335693359375]
tr_acc16_3_rl_40 =[0.8, 0.8, 0.825, 0.825, 0.8, 0.825, 0.825, 0.8, 0.8, 0.875, 0.8, 0.8, 0.85, 0.85, 0.825, 0.85, 0.875, 0.825, 0.85, 0.875]
loss16_4_rl_40=[21.69580078125, 21.676685333251953, 21.14633560180664, 21.194190979003906, 21.187971115112305, 21.079925537109375, 21.100229263305664, 20.985198974609375, 20.903165817260742, 20.80172348022461, 20.766944885253906, 20.641874313354492, 20.396007537841797, 20.265729904174805, 20.362621307373047, 20.33049201965332, 20.22951316833496, 20.206056594848633, 20.247034072875977, 20.175535202026367]
tr_acc16_4_rl_40 =[0.8, 0.8, 0.875, 0.875, 0.875, 0.9, 0.9, 0.875, 0.875, 0.9, 0.9, 0.9, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95, 0.95]
loss16_5_rl_40=[21.79920768737793, 21.737157821655273, 21.737571716308594, 21.60662078857422, 21.481159210205078, 21.321714401245117, 21.219846725463867, 21.089496612548828, 20.86682891845703, 20.73986053466797, 20.611711502075195, 20.4500789642334, 20.37366485595703, 20.255409240722656, 20.265066146850586, 27.89183807373047, 28.146255493164062, 27.36210823059082, 25.52765655517578, 24.9456729888916]
tr_acc16_5_rl_40 =[0.825, 0.825, 0.75, 0.8, 0.775, 0.8, 0.825, 0.825, 0.9, 0.9, 0.9, 0.9, 0.9, 0.925, 0.925, 0.575, 0.375, 0.425, 0.8, 0.825]

tr_acc_fin40 =[0.825,0.875,0.875,0.95,0.825]
test_acc_fin40 =[0.78,0.87,0.79,0.84,0.77]

loss40_rl_16=np.array([loss16_1_rl_40,loss16_2_rl_40,loss16_3_rl_40,loss16_4_rl_40,loss16_5_rl_40])
tracc40_rl_16=np.array([tr_acc16_1_rl_40,tr_acc16_2_rl_40,tr_acc16_3_rl_40,tr_acc16_4_rl_40,tr_acc16_5_rl_40])

missed_rl_40_16 = [22, 13, 21, 16, 23]
missed0_rl_40_16 = [0, 0, 0, 0, 0]
missed1_rl_40_16= [22, 13, 21, 16, 23]
"""
Precision, recall, f_score, support: (array([0.74074074, 1.        ]), array([1.  , 0.65]), array([0.85106383, 0.78787879]), array([20, 20]))
Precision, recall, f_score, support: (array([0.69444444, 1.        ]), array([1.  , 0.56]), array([0.81967213, 0.71794872]), array([50, 50]))

Precision, recall, f_score, support: (array([0.8, 1. ]), array([1.  , 0.75]), array([0.88888889, 0.85714286]), array([20, 20]))
Precision, recall, f_score, support: (array([0.79365079, 1.        ]), array([1.  , 0.74]), array([0.88495575, 0.85057471]), array([50, 50]))

Precision, recall, f_score, support: (array([0.8, 1. ]), array([1.  , 0.75]), array([0.88888889, 0.85714286]), array([20, 20]))
Precision, recall, f_score, support: (array([0.70422535, 1.        ]), array([1.  , 0.58]), array([0.82644628, 0.73417722]), array([50, 50]))

Precision, recall, f_score, support: (array([0.95, 0.95]), array([0.95, 0.95]), array([0.95, 0.95]), array([20, 20]))
Precision, recall, f_score, support: (array([0.75757576, 1.        ]), array([1.  , 0.68]), array([0.86206897, 0.80952381]), array([50, 50]))

Precision, recall, f_score, support: (array([0.74074074, 1.        ]), array([1.  , 0.65]), array([0.85106383, 0.78787879]), array([20, 20]))
Precision, recall, f_score, support: (array([0.68493151, 1.        ]), array([1.  , 0.54]), array([0.81300813, 0.7012987 ]), array([50, 50]))

"""

# Training w 50 images
loss16_1_rl_50 =[40.238189697265625, 40.16147994995117, 36.0883674621582, 31.154924392700195, 31.16744613647461, 30.651334762573242, 30.2673282623291, 29.69851303100586, 29.224132537841797, 28.769765853881836, 28.484603881835938, 28.34146499633789, 28.06492042541504, 27.750411987304688, 27.71942710876465, 27.427350997924805, 27.536392211914062, 27.490694046020508, 27.350605010986328, 27.191190719604492]
tr_acc16_1_rl_50 = [0.24, 0.22, 0.36, 0.7, 0.66, 0.66, 0.68, 0.68, 0.72, 0.72, 0.72, 0.76, 0.78, 0.76, 0.76, 0.78, 0.74, 0.78, 0.74, 0.78]
loss16_2_rl_50 =[27.725322723388672, 27.763229370117188, 27.75552749633789, 27.47431755065918, 27.46202850341797, 27.396989822387695, 27.201730728149414, 26.879289627075195, 26.88730239868164, 26.717531204223633, 26.67390251159668, 26.360164642333984, 26.505998611450195, 26.073240280151367, 26.144729614257812, 26.17658233642578, 26.14303207397461, 26.148344039916992, 26.26133155822754, 26.185834884643555]
tr_acc16_2_rl_50 =[0.86, 0.86, 0.82, 0.88, 0.86, 0.86, 0.84, 0.84, 0.84, 0.86, 0.86, 0.88, 0.88, 0.9, 0.9, 0.88, 0.88, 0.88, 0.88, 0.88]
loss16_3_rl_50=[26.095746994018555, 26.086116790771484, 25.94513702392578, 25.855863571166992, 25.659456253051758, 25.603097915649414, 25.47378921508789, 25.516035079956055, 25.45859146118164, 25.456689834594727, 25.534664154052734, 25.398820877075195, 25.31216049194336, 25.248188018798828, 25.294721603393555, 25.23316764831543, 25.321407318115234, 25.346555709838867, 25.558408737182617, 25.476058959960938]
tr_acc16_3_rl_50 =[0.88, 0.86, 0.9, 0.9, 0.94, 0.94, 0.92, 0.92, 0.94, 0.92, 0.92, 0.92, 0.92, 0.92, 0.92, 0.9, 0.9, 0.9, 0.9, 0.9]
loss16_4_rl_50=[26.075973510742188, 26.055335998535156, 25.86731719970703, 25.796764373779297, 25.73706817626953, 25.61383819580078, 25.558429718017578, 25.307645797729492, 25.201292037963867, 25.095497131347656, 25.047025680541992, 24.927303314208984, 25.022397994995117, 25.064178466796875, 25.1718807220459, 25.129478454589844, 25.130563735961914, 25.103681564331055, 24.98412322998047, 24.97161293029785]
tr_acc16_4_rl_50 =[0.84, 0.84, 0.88, 0.88, 0.86, 0.88, 0.88, 0.92, 0.92, 0.96, 0.94, 0.94, 0.92, 0.94, 0.9, 0.9, 0.92, 0.92, 0.94, 0.94]
loss16_5_rl_50=[26.864105224609375, 26.741863250732422, 26.473373413085938, 26.2764835357666, 26.277769088745117, 26.102596282958984, 25.988975524902344, 25.730365753173828, 25.704940795898438, 25.559099197387695, 25.448633193969727, 25.46296501159668, 25.574312210083008, 25.654111862182617, 25.533376693725586, 25.462646484375, 25.41322898864746, 25.280038833618164, 25.256986618041992, 25.258148193359375]
tr_acc16_5_rl_50 =[0.82, 0.8, 0.8, 0.86, 0.84, 0.82, 0.84, 0.86, 0.82, 0.88, 0.88, 0.86, 0.88, 0.88, 0.9, 0.92, 0.92, 0.92, 0.9, 0.9]

tr_acc_fin50 =[0.84,0.88,0.92,0.96,0.94]
test_acc_fin50 =[0.79,0.79,0.82,0.81,0.77]

loss50_rl_16=np.array([loss16_1_rl_50,loss16_2_rl_50,loss16_3_rl_50,loss16_4_rl_50,loss16_5_rl_50], dtype=object)
tracc50_rl_16=np.array([tr_acc16_1_rl_50,tr_acc16_2_rl_50,tr_acc16_3_rl_50,tr_acc16_4_rl_50,tr_acc16_5_rl_50], dtype=object)

missed_rl_50_16 = [19, 15, 17, 15, 10]
missed0_rl_50_16 = [0, 0, 0, 0, 0]
missed1_rl_50_16= [19, 15, 17, 15, 10]
"""
Precision, recall, f_score, support: (array([0.75757576, 1.        ]), array([1.  , 0.68]), array([0.86206897, 0.80952381]), array([25, 25]))
Precision, recall, f_score, support: (array([0.70422535, 1.        ]), array([1.  , 0.58]), array([0.82644628, 0.73417722]), array([50, 50]))

Precision, recall, f_score, support: (array([0.80645161, 1.        ]), array([1.  , 0.76]), array([0.89285714, 0.86363636]), array([25, 25]))
Precision, recall, f_score, support: (array([0.70422535, 1.        ]), array([1.  , 0.58]), array([0.82644628, 0.73417722]), array([50, 50]))

Precision, recall, f_score, support: (array([0.86206897, 1.        ]), array([1.  , 0.84]), array([0.92592593, 0.91304348]), array([25, 25]))
Precision, recall, f_score, support: (array([0.73529412, 1.        ]), array([1.  , 0.64]), array([0.84745763, 0.7804878 ]), array([50, 50]))

Precision, recall, f_score, support: (array([0.92592593, 1.        ]), array([1.  , 0.92]), array([0.96153846, 0.95833333]), array([25, 25]))
Precision, recall, f_score, support: (array([0.72463768, 1.        ]), array([1.  , 0.62]), array([0.84033613, 0.7654321 ]), array([50, 50]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([10, 10]))
Precision, recall, f_score, support: (array([0.83333333, 1.        ]), array([1. , 0.8]), array([0.90909091, 0.88888889]), array([50, 50]))

"""

training_sets = np.array([6,10,20,30,40,50])

train_accf_rl = np.array([tr_acc_fin, tr_acc_fin10, tr_acc_fin20, tr_acc16_3_rl_30,tr_acc16_3_rl_40,tr_acc_fin50])
test_accf_rl = np.array([test_acc_fin,test_acc_fin10,test_acc_fin20, test_acc_fin30,test_acc_fin40, test_acc_fin50])

av_train_rl = [np.mean(sublist) for sublist in train_accf_rl]
std_train_rl= [np.std(sublist) for sublist in train_accf_rl]
av_test_rl = [np.mean(sublist) for sublist in test_accf_rl]
std_test_rl = [np.std(sublist) for sublist in test_accf_rl]



x = np.array(training_sets)


random_guess = 0.5*np.ones(len(x))
plt.plot(x, av_train_rl, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_rl, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_rl,yerr=std_train_rl,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_rl, yerr=std_test_rl,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("RLRL 3L",fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.1)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/RL_train_test.jpg', dpi=800)
#



def train_error(train_acc):
    tr_acc = np.asarray(train_acc)
    tr_error = np.zeros(len(train_acc))
    for i in range(len(train_acc)):
        tr_error[i]=1.0-tr_acc[i]
    return tr_error

def test_error(test_acc):
    test_acc = np.asarray(test_acc)
    test_error = np.zeros(len(test_acc))
    for i in range(len(test_acc)):
        test_error[i]=1.0-test_acc[i]
    return test_error

#print(train_error(train_acc50_fin_qcnnRL))

#print(test_error(test_acc50_fin_qcnnRL))
tr_error = train_error(av_train_rl)
te_error = test_error(av_test_rl)
def gen_error(tr_error, te_error):
    generalization_error = np.subtract(te_error,tr_error)
    return generalization_error

g = gen_error(tr_error, te_error)
#plt.plot(x,g, ls=':', label='')
plt.plot(x,tr_error, ls=':', label='Train error', color='darkblue', marker='s', linewidth=1.)
plt.plot(x,te_error, ls=':', label='Test error', color='orangered', marker='v', linewidth=1.)
plt.legend(loc=1,prop={'size': 16})
plt.xlabel('Training set')
plt.ylabel('Values')
plt.title("Error progression")
plt.ylim(0.,0.5)
plt.savefig('/Users/francescoaldoventurelli/Desktop/CIRCUITSSS/ERROR_RLIKE.jpg')
#


##### QCNN W RL ENCODING  ### TUTTI I QUBIT SONO MISURATI!!!
# 6 IMAGES

loss6_QCNN_1 = [3.780935287475586, 3.7673087120056152, 3.7373552322387695, 3.7682642936706543, 3.709138870239258, 3.6937131881713867, 3.7028911113739014, 3.682600975036621, 3.6776909828186035, 3.678727626800537, 3.6743054389953613, 3.73876690864563, 3.759993553161621, 3.7768571376800537, 3.7528421878814697, 3.8083696365356445, 3.7887697219848633, 3.771282911300659, 3.781785726547241, 3.734156847000122]
acc6_QCNN_1 = [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.8333333333333334]
loss6_QCNN_2 = [3.7397892475128174, 3.7606022357940674, 3.7628042697906494, 3.736154556274414, 3.7287254333496094, 3.646010160446167, 3.615706205368042, 3.5749640464782715, 3.553499221801758, 3.6127676963806152, 3.5912418365478516, 3.6185784339904785, 3.598433494567871, 3.6324262619018555, 3.63991641998291, 3.5892961025238037, 3.5889759063720703, 3.564640522003174, 3.5655102729797363, 3.5275650024414062]
acc6_QCNN_2 = [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss6_QCNN_3 = [4.009271621704102, 3.951720952987671, 3.8544809818267822, 3.7989940643310547, 3.7911224365234375, 3.7334847450256348, 3.7781283855438232, 3.8064589500427246, 3.7325658798217773, 3.7660586833953857, 3.769613265991211, 3.8037867546081543, 3.780975341796875, 3.7001476287841797, 3.646698474884033, 3.703421115875244, 3.641932487487793, 3.643655300140381, 3.6685664653778076, 3.7164552211761475]
acc6_QCNN_3 = [0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss6_QCNN_4 = [3.5592947006225586, 3.565185070037842, 3.5796451568603516, 3.518986225128174, 3.522700786590576, 3.508162021636963, 3.412238121032715, 3.409965753555298, 3.407517910003662, 3.4335086345672607, 3.444286584854126, 3.819026231765747, 3.719707727432251, 3.678239583969116, 3.6364684104919434, 3.6179094314575195, 3.604668617248535, 3.5393283367156982, 3.5272793769836426, 3.530935764312744]
acc6_QCNN_4 = [1.0, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8333333333333334, 0.8333333333333334, 1.0, 0.8333333333333334, 1.0, 0.8333333333333334, 1.0, 1.0, 0.8333333333333334]
loss6_QCNN_5 = [3.763352155685425, 3.8309078216552734, 3.746333360671997, 3.8206632137298584, 3.7427988052368164, 3.9066781997680664, 3.8330163955688477, 3.881415843963623, 3.8257572650909424, 3.8829610347747803, 3.833379030227661, 4.157837390899658, 4.1614155769348145, 3.9929542541503906, 4.0408525466918945, 4.031896114349365, 3.7301831245422363, 4.090025901794434, 4.046365261077881, 3.929142475128174]
acc6_QCNN_5 = [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 1.0, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]

train_acc_fin6_QCNN = [0.8333333333333334,1.0,1.0,1.0,0.6666666666666666]
test_acc_fin6_QCNN = [0.77,0.71,0.75,0.73,0.71]


loss10_QCNN_1 = [6.538951873779297, 6.4578752517700195, 6.451762676239014, 6.382309436798096, 6.390519142150879, 6.427317142486572, 6.369098663330078, 6.390800952911377, 6.276273250579834, 6.303857326507568, 6.2671895027160645, 6.243252754211426, 6.318455219268799, 6.2851057052612305, 6.294917583465576, 6.2566022872924805, 6.23721170425415, 6.268662929534912, 6.2871222496032715, 6.394759654998779]
acc10_QCNN_1 = [0.8, 0.8, 0.8, 0.9, 0.8, 0.9, 0.9, 0.9, 0.8, 0.9, 0.9, 0.8, 0.7, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.7]
loss10_QCNN_2 = [6.434123516082764, 6.416149139404297, 6.305850028991699, 6.316577434539795, 6.3562421798706055, 6.346321105957031, 6.316988468170166, 6.257038593292236, 6.288952827453613, 6.158201694488525, 6.149906635284424, 6.179599285125732, 6.185516834259033, 6.296801567077637, 6.223753929138184, 6.276904582977295, 6.255455017089844, 6.37808895111084, 6.3341383934021, 6.3955078125]
acc10_QCNN_2 = [0.8, 0.8, 0.8, 0.8, 0.9, 0.9, 0.9, 0.7, 0.7, 0.9, 1.0, 0.9, 0.9, 0.9, 0.9, 0.9, 0.8, 0.8, 0.9, 0.8]
loss10_QCNN_3 =[6.678960800170898, 6.647852420806885, 6.564779281616211, 6.267090797424316, 6.257625102996826, 6.260038375854492, 6.3065266609191895, 6.30439567565918, 6.41721248626709, 6.247066497802734, 6.269209384918213, 6.3470354080200195, 6.2384257316589355, 6.255248069763184, 6.24015474319458, 6.2644805908203125, 6.263548851013184, 6.076321125030518, 5.969610691070557, 6.13170862197876]
acc10_QCNN_3 =  [0.8, 0.8, 0.8, 0.9, 0.8, 0.9, 0.8, 0.8, 0.8, 0.9, 0.8, 0.8, 0.8, 0.7, 0.7, 0.7, 0.7, 0.7, 0.8, 0.8]
loss10_QCNN_4 = [6.27438497543335, 6.226474285125732, 6.263159275054932, 6.24801778793335, 6.283419132232666, 6.183725357055664, 6.11112117767334, 6.028808116912842, 6.0554704666137695, 5.915677547454834, 5.925010681152344, 5.942154407501221, 5.874064922332764, 5.890220642089844, 5.854390621185303, 5.880320072174072, 5.887714385986328, 5.895336151123047, 5.906275272369385, 5.905568599700928]
acc10_QCNN_4 = [0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.9, 0.9, 0.8, 0.9, 1.0, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
loss10_QCNN_5 = [6.122505187988281, 6.133519649505615, 6.152060508728027, 5.987192630767822, 6.012187480926514, 6.024758815765381, 6.050656318664551, 6.069398880004883, 6.154072284698486, 6.133183479309082, 6.09256649017334, 6.026086330413818, 6.0372633934021, 6.023886203765869, 6.02381706237793, 6.005888938903809, 5.973607540130615, 5.983867645263672, 5.974106311798096, 5.959483623504639]
acc10_QCNN_5 = [0.9, 0.9, 0.9, 1.0, 1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

train_acc_fin10_QCNN = [0.7,0.9,0.7,1.0,1.0]
test_acc_fin10_QCNN = [0.74,0.7,0.79,0.73,0.78]

### 20 images
loss20_QCNN_1 =[13.466328620910645, 13.225822448730469, 13.053976058959961, 12.954206466674805, 12.712334632873535, 12.643836975097656, 12.498979568481445, 12.55821704864502, 12.593093872070312, 12.48764419555664, 12.458701133728027, 12.315851211547852, 12.339051246643066, 12.352189064025879, 12.361030578613281, 12.382776260375977, 12.351546287536621, 12.378231048583984, 12.316645622253418, 12.333044052124023]
acc20_QCNN_1 = [0.7, 0.7, 0.75, 0.7, 0.85, 0.85, 0.8, 0.8, 0.75, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.85, 0.85, 0.85, 0.85, 0.85]
loss20_QCNN_2 = [12.771736145019531, 12.647985458374023, 12.650322914123535, 12.802824020385742, 12.829584121704102, 12.838587760925293, 12.895967483520508, 12.959419250488281, 12.841548919677734, 12.872784614562988, 12.712048530578613, 12.762335777282715, 12.598772048950195, 12.627128601074219, 13.006706237792969, 12.75881576538086, 12.824966430664062, 12.893808364868164, 12.895953178405762, 13.107519149780273]
acc20_QCNN_2 = [0.7, 0.75, 0.75, 0.75, 0.65, 0.65, 0.65, 0.65, 0.7, 0.65, 0.75, 0.75, 0.8, 0.8, 0.7, 0.75, 0.7, 0.8, 0.7, 0.7]
loss20_QCNN_3 =[12.569353103637695, 12.518078804016113, 12.539947509765625, 12.239489555358887, 12.25165843963623, 12.099600791931152, 12.183544158935547, 12.107380867004395, 12.078938484191895, 12.049795150756836, 12.036569595336914, 12.087430953979492, 12.119399070739746, 12.058215141296387, 12.056317329406738, 12.062210083007812, 12.101354598999023, 12.080551147460938, 12.065576553344727, 12.105619430541992]
acc20_QCNN_3 =  [0.8, 0.8, 0.85, 0.85, 0.85, 0.8, 0.8, 0.8, 0.75, 0.8, 0.75, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.75, 0.8, 0.8]
loss20_QCNN_4 = [12.721508979797363, 12.701744079589844, 12.651031494140625, 12.695704460144043, 12.558477401733398, 12.423857688903809, 12.262458801269531, 12.28918170928955, 12.20357894897461, 12.248392105102539, 12.294013023376465, 12.337394714355469, 12.180919647216797, 12.161994934082031, 12.281981468200684, 12.360122680664062, 12.444488525390625, 12.280057907104492, 12.33793830871582, 12.282611846923828]
acc20_QCNN_4 = [0.65, 0.75, 0.65, 0.65, 0.65, 0.7, 0.8, 0.7, 0.85, 0.85, 0.85, 0.85, 0.85, 0.85, 0.85, 0.9, 0.85, 0.8, 0.8, 0.75]
loss20_QCNN_5 = [12.215020179748535, 12.2626953125, 12.31006908416748, 12.235246658325195, 12.189873695373535, 12.133044242858887, 12.11937427520752, 12.111056327819824, 12.067387580871582, 12.144697189331055, 12.125360488891602, 12.100963592529297, 12.10917854309082, 12.050559997558594, 12.090836524963379, 11.972326278686523, 11.989768981933594, 12.166090965270996, 12.1588134765625, 12.261314392089844]
acc20_QCNN_5 = [0.85, 0.85, 0.9, 0.8, 0.85, 0.85, 0.85, 0.85, 0.8, 0.8, 0.8, 0.75, 0.75, 0.85, 0.85, 0.9, 0.85, 0.8, 0.75, 0.75]

train_acc_fin20_QCNN = [0.85,0.6,0.75,0.75,0.75]
test_acc_fin20_QCNN = [0.75,0.73,0.75,0.72,0.79]


### 30 images
loss30_QCNN_1 =[20.25510597229004, 20.011117935180664, 19.752464294433594, 19.50269317626953, 19.24095344543457, 19.247629165649414, 19.183252334594727, 19.11088752746582, 19.078868865966797, 19.086578369140625, 18.977684020996094, 19.009756088256836, 18.947650909423828, 18.971450805664062, 18.945268630981445, 19.146137237548828, 19.136579513549805, 18.95206642150879, 18.9111328125, 18.88096809387207]
acc30_QCNN_1 = [0.6333333333333333, 0.6333333333333333, 0.7, 0.6666666666666666, 0.7333333333333333, 0.8, 0.8, 0.8, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333, 0.7333333333333333, 0.8, 0.7666666666666667, 0.7, 0.7666666666666667, 0.7333333333333333]
loss30_QCNN_2 =[19.538875579833984, 19.525691986083984, 19.40268898010254, 19.32257843017578, 19.354843139648438, 19.1262149810791, 19.128259658813477, 19.100496292114258, 18.95760726928711, 18.8984375, 18.95261573791504, 18.933788299560547, 18.850839614868164, 18.884849548339844, 19.053455352783203, 18.791091918945312, 18.85142707824707, 18.502212524414062, 18.28486442565918, 18.315908432006836]
acc30_QCNN_2 = [0.6, 0.6, 0.7, 0.7, 0.7, 0.6666666666666666, 0.7, 0.7333333333333333, 0.6666666666666666, 0.7, 0.6666666666666666, 0.7666666666666667, 0.7, 0.7333333333333333, 0.7, 0.8, 0.8, 0.8, 0.8333333333333334, 0.8]
loss30_QCNN_3 =[17.874032974243164, 17.831079483032227, 17.952327728271484, 17.95641326904297, 17.962465286254883, 17.772708892822266, 17.809938430786133, 17.828065872192383, 17.81119728088379, 17.75147247314453, 17.733055114746094, 17.620014190673828, 17.593021392822266, 17.585113525390625, 17.379554748535156, 17.363292694091797, 17.379337310791016, 17.401865005493164, 17.379581451416016, 17.475933074951172]
acc30_QCNN_3 = [0.8666666666666667, 0.8, 0.8333333333333334, 0.8, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.8, 0.8, 0.8, 0.8, 0.7666666666666667, 0.7666666666666667, 0.8666666666666667, 0.8333333333333334, 0.8, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334]
loss30_QCNN_4 =[17.83560562133789, 17.83287811279297, 17.843109130859375, 17.7524471282959, 17.74911880493164, 17.698055267333984, 17.686498641967773, 17.494598388671875, 17.535053253173828, 17.49489402770996, 17.593547821044922, 17.63870620727539, 17.627511978149414, 17.681001663208008, 17.689022064208984, 17.594409942626953, 17.544944763183594, 17.584877014160156, 17.571046829223633, 17.611408233642578]
acc30_QCNN_4 =[0.8, 0.7666666666666667, 0.8, 0.7333333333333333, 0.7666666666666667, 0.8333333333333334, 0.8, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8, 0.8, 0.8666666666666667, 0.8, 0.7666666666666667, 0.8333333333333334, 0.8333333333333334]
loss30_QCNN_5 = [18.215925216674805, 18.219480514526367, 18.05732536315918, 18.004018783569336, 17.915557861328125, 17.897310256958008, 17.812908172607422, 17.840986251831055, 17.77237319946289, 17.72816276550293, 17.68150520324707, 17.67445945739746, 17.819469451904297, 17.880298614501953, 17.91730499267578, 17.811927795410156, 17.796499252319336, 17.81586265563965, 17.711715698242188, 17.662338256835938]
acc30_QCNN_5 = [0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.8, 0.8, 0.7666666666666667, 0.7, 0.7, 0.7, 0.6666666666666666, 0.7, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333]

train_acc_fin30_QCNN = [0.7666666666666667,0.7666666666666667,0.8333333333333334,0.8666666666666667,0.7666666666666667]
test_acc_fin30_QCNN = [0.76,0.69,0.74,0.75,0.76]


### 40 images
loss40_QCNN_1 =[26.940933227539062, 26.610614776611328, 26.441051483154297, 26.13820457458496, 26.00080680847168, 25.984167098999023, 25.88117027282715, 25.76244354248047, 25.64527702331543, 25.490406036376953, 25.32099723815918, 25.259077072143555, 25.066247940063477, 25.120765686035156, 25.152523040771484, 25.23906135559082, 25.344717025756836, 24.96458625793457, 25.048721313476562, 24.97193145751953]
acc40_QCNN_1 = [0.65, 0.675, 0.7, 0.7, 0.725, 0.675, 0.75, 0.775, 0.8, 0.8, 0.825, 0.8, 0.775, 0.8, 0.8, 0.75, 0.775, 0.825, 0.8, 0.75]
loss40_QCNN_2 =[26.090301513671875, 25.9852294921875, 25.96285057067871, 25.609895706176758, 25.46672821044922, 25.206668853759766, 25.102970123291016, 24.405704498291016, 24.350513458251953, 24.36328887939453, 24.244382858276367, 24.31389045715332, 24.273529052734375, 24.324440002441406, 24.16382598876953, 24.241506576538086, 24.207666397094727, 24.19391441345215, 24.18709945678711, 24.13431739807129]
acc40_QCNN_2 = [0.65, 0.7, 0.675, 0.6, 0.65, 0.675, 0.675, 0.75, 0.75, 0.725, 0.725, 0.75, 0.775, 0.75, 0.8, 0.75, 0.75, 0.7, 0.725, 0.75]
loss40_QCNN_3 =[23.574186325073242, 23.524328231811523, 23.45478630065918, 23.299110412597656, 23.22502326965332, 23.254201889038086, 23.292497634887695, 23.325807571411133, 23.269001007080078, 23.276508331298828, 23.2334041595459, 23.256572723388672, 23.148197174072266, 23.11153793334961, 23.096826553344727, 23.107553482055664, 23.200298309326172, 23.175155639648438, 23.155736923217773, 23.230989456176758]
acc40_QCNN_3 = [0.825, 0.875, 0.85, 0.9, 0.9, 0.875, 0.875, 0.9, 0.875, 0.85, 0.925, 0.925, 0.925, 0.875, 0.875, 0.9, 0.875, 0.875, 0.875, 0.875]
loss40_QCNN_4 =[23.782190322875977, 23.762435913085938, 23.748931884765625, 23.67786979675293, 23.680421829223633, 23.599853515625, 23.539875030517578, 23.56329345703125, 23.568002700805664, 23.605802536010742, 23.524276733398438, 23.50442886352539, 23.636354446411133, 23.560375213623047, 23.33548355102539, 23.556560516357422, 23.630582809448242, 23.561983108520508, 23.642690658569336, 23.67671775817871]
acc40_QCNN_4 =[0.775, 0.75, 0.75, 0.8, 0.75, 0.8, 0.75, 0.725, 0.725, 0.75, 0.775, 0.775, 0.775, 0.8, 0.85, 0.825, 0.85, 0.85, 0.8, 0.825]
loss40_QCNN_5 = [24.21758460998535, 24.212411880493164, 24.104686737060547, 23.9981746673584, 23.946523666381836, 23.86897850036621, 23.86334800720215, 23.942869186401367, 23.964372634887695, 23.947202682495117, 23.863895416259766, 23.924882888793945, 23.86904525756836, 23.83171844482422, 23.813552856445312, 23.8419246673584, 23.754056930541992, 23.75741958618164, 23.68280029296875, 23.736652374267578]
acc40_QCNN_5 = [0.725, 0.725, 0.725, 0.725, 0.7, 0.725, 0.75, 0.75, 0.7, 0.75, 0.75, 0.775, 0.775, 0.775, 0.75, 0.75, 0.725, 0.75, 0.75, 0.725]

train_acc_fin40_QCNN = [0.775,0.7,0.9,0.825,0.775]
test_acc_fin40_QCNN = [0.68,0.71,0.74,0.74,0.78]

### 50 images
loss50_QCNN_1 =[33.656898498535156, 33.336456298828125, 33.013301849365234, 32.85774230957031, 32.811981201171875, 32.571800231933594, 32.4457893371582, 32.45060348510742, 32.275634765625, 32.23075866699219, 31.864988327026367, 31.802799224853516, 31.914169311523438, 31.94169044494629, 31.92361831665039, 31.921001434326172, 31.96438980102539, 32.01482009887695, 31.900362014770508, 32.16501235961914]
acc50_QCNN_1 =  [0.66, 0.68, 0.7, 0.7, 0.72, 0.7, 0.76, 0.76, 0.8, 0.76, 0.74, 0.76, 0.76, 0.76, 0.78, 0.76, 0.76, 0.76, 0.8, 0.76]
loss50_QCNN_2 =[32.363277435302734, 32.2968864440918, 32.25129318237305, 32.25667953491211, 32.230186462402344, 32.37583541870117, 32.36444854736328, 32.29690933227539, 32.06193923950195, 34.534095764160156, 34.382076263427734, 34.31449890136719, 34.142032623291016, 33.93367004394531, 34.001041412353516, 33.75632858276367, 33.40621566772461, 33.114376068115234, 32.463844299316406, 34.805580139160156]
acc50_QCNN_2 = [0.78, 0.72, 0.7, 0.7, 0.7, 0.64, 0.66, 0.66, 0.74, 0.64, 0.58, 0.58, 0.6, 0.74, 0.62, 0.68, 0.78, 0.68, 0.72, 0.48]
loss50_QCNN_3 =[34.77937316894531, 34.744224548339844, 34.70408248901367, 34.53063201904297, 33.59914779663086, 33.423683166503906, 33.292667388916016, 33.334983825683594, 33.2512092590332, 32.985443115234375, 33.064430236816406, 32.92344284057617, 32.89543533325195, 32.84815979003906, 32.841033935546875, 32.86962890625, 32.884647369384766, 32.951568603515625, 32.730525970458984, 32.37428283691406]
acc50_QCNN_3 = [0.5, 0.52, 0.42, 0.6, 0.74, 0.66, 0.68, 0.7, 0.74, 0.7, 0.74, 0.68, 0.72, 0.7, 0.72, 0.72, 0.7, 0.72, 0.76, 0.72]
loss50_QCNN_4 =[32.62451934814453, 32.61311340332031, 32.46727752685547, 31.682716369628906, 31.5382022857666, 31.22187042236328, 30.934648513793945, 30.704782485961914, 30.82118797302246, 30.73988914489746, 30.594282150268555, 30.52271842956543, 30.55577278137207, 30.45894432067871, 30.471927642822266, 30.53891372680664, 30.611608505249023, 30.56303596496582, 30.675119400024414, 30.73220443725586]
acc50_QCNN_4 = [0.76, 0.76, 0.74, 0.72, 0.84, 0.76, 0.82, 0.92, 0.86, 0.84, 0.82, 0.82, 0.8, 0.84, 0.88, 0.82, 0.82, 0.8, 0.8, 0.8]
loss50_QCNN_5 = [30.18129539489746, 30.11044692993164, 29.99970245361328, 30.021312713623047, 30.24311065673828, 30.289608001708984, 30.283857345581055, 30.471220016479492, 30.36086082458496, 30.072101593017578, 30.0771427154541, 29.98611831665039, 29.92048454284668, 30.054840087890625, 29.837203979492188, 33.2788200378418, 33.067108154296875, 33.055702209472656, 32.83694076538086, 32.24436569213867]
acc50_QCNN_5 = [0.74, 0.72, 0.74, 0.7, 0.7, 0.72, 0.72, 0.72, 0.74, 0.72, 0.72, 0.7, 0.7, 0.7, 0.72, 0.78, 0.78, 0.78, 0.78, 0.76]

train_acc_fin50_QCNN = [0.8,0.42,0.72,0.76,0.78]
test_acc_fin50_QCNN = [0.73,0.45,0.7,0.71,0.61]

train_accf_rl_QCNN = np.array([train_acc_fin6_QCNN, train_acc_fin10_QCNN, train_acc_fin20_QCNN, train_acc_fin30_QCNN,train_acc_fin40_QCNN,train_acc_fin50_QCNN])
test_accf_rl_QCNN = np.array([test_acc_fin6_QCNN,test_acc_fin10_QCNN,test_acc_fin20_QCNN, test_acc_fin30_QCNN,test_acc_fin40_QCNN, test_acc_fin50_QCNN])

av_train_rl_QCNN = [np.mean(sublist) for sublist in train_accf_rl_QCNN]
std_train_rl_QCNN= [np.std(sublist) for sublist in train_accf_rl_QCNN]
av_test_rl_QCNN = [np.mean(sublist) for sublist in test_accf_rl_QCNN]
std_test_rl_QCNN = [np.std(sublist) for sublist in test_accf_rl_QCNN]


plt.plot(x, av_train_rl_QCNN, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_rl_QCNN, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_rl_QCNN,yerr=std_train_rl_QCNN,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_rl_QCNN, yerr=std_test_rl_QCNN,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("RLQCNN", fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.1)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/RL_QCNN_train_test.jpg', dpi=800)
#


tr_errorQCNN = train_error(av_train_rl_QCNN)
te_errorQCNN = test_error(av_test_rl_QCNN)

plt.plot(x,tr_errorQCNN, ls=':', label='Train error', color='darkblue', marker='s', linewidth=1.)
plt.plot(x,te_errorQCNN, ls=':', label='Test error', color='orangered', marker='v', linewidth=1.)
plt.legend(loc=4,prop={'size': 16})
plt.xlabel('Training set')
plt.ylabel('Values')
plt.title("Error progression")
plt.ylim(0.,0.5)
#plt.savefig('/Users/francescoaldoventurelli/Desktop/CIRCUITSSS/ERROR_QCNN.jpg')
#


#### FEATURE MAP : RINGLIKE, ANSATZ : WATERFALL 3 layer 6 immagini
loss6_rl_wf3L_1 = [3.758669137954712, 3.759746789932251, 3.688199996948242, 3.69219708442688, 3.6634645462036133, 3.6224076747894287, 3.634282112121582, 3.6739845275878906, 3.637004852294922, 3.619229555130005, 3.5272390842437744, 3.5003769397735596, 3.521636962890625, 3.5107319355010986, 3.4844553470611572, 3.499055862426758, 3.4334065914154053, 3.4127557277679443, 3.4507863521575928, 3.404637336730957]
acc6_rl_wf3L_1 =  [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
loss6_rl_wf3L_2 = [3.808591842651367, 3.8170180320739746, 3.81254506111145, 3.7485315799713135, 3.7093911170959473, 3.699568748474121, 3.69087553024292, 3.623699426651001, 3.623674154281616, 3.7211859226226807, 3.7030222415924072, 3.701829433441162, 3.691878080368042, 3.7075576782226562, 3.713289499282837, 3.6774864196777344, 3.647989511489868, 3.6573197841644287, 3.6425857543945312, 3.599940299987793]
acc6_rl_wf3L_2 =  [0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]
loss6_rl_wf3L_3 = [3.6433568000793457, 3.653691291809082, 3.5865745544433594, 3.559600591659546, 3.5630264282226562, 3.5650339126586914, 3.5775771141052246, 3.545192241668701, 3.5210094451904297, 3.499509811401367, 3.502965211868286, 3.5137295722961426, 3.5109853744506836, 3.502408504486084, 3.4989194869995117, 3.493868350982666, 3.4962525367736816, 3.5251431465148926, 3.5243072509765625, 4.607454299926758]
acc6_rl_wf3L_3 = [0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.0]
loss6_rl_wf3L_4 = [4.797740459442139, 4.774066925048828, 4.699502468109131, 4.510153293609619, 4.281881809234619, 4.172883033752441, 4.274418830871582, 4.232474327087402, 4.199654579162598, 4.065703392028809, 4.032125473022461, 3.9711010456085205, 3.9606568813323975, 3.9091999530792236, 3.8736958503723145, 3.8615469932556152, 3.8399624824523926, 3.8114969730377197, 3.797487735748291, 3.7941832542419434]
acc6_rl_wf3L_4 = [0.16666666666666666, 0.16666666666666666, 0.16666666666666666, 0.16666666666666666, 0.16666666666666666, 0.3333333333333333, 0.5, 0.5, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334]
loss6_rl_wf3L_5 = [3.9600186347961426, 3.9223127365112305, 3.897648811340332, 3.9353184700012207, 3.9563164710998535, 3.9189844131469727, 3.8587443828582764, 3.864475965499878, 3.8439602851867676, 3.79902982711792, 3.743471145629883, 3.7323036193847656, 3.727090358734131, 3.7223594188690186, 3.718611001968384, 3.7116684913635254, 3.6845836639404297, 3.576901912689209, 3.5132193565368652, 3.5786948204040527]
acc6_rl_wf3L_5 =  [0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]

train_acc_fin6_rl_wf_3L = [1.0,0.6666666666666666,0.0,0.8333333333333334,0.5]
test_acc_fin6_rl_wf_3L = [0.72, 0.76,0.21,0.75,0.46]


#### 10 immagini
loss10_rl_wf3L_1 = [6.189143657684326, 6.1828107833862305, 6.186239719390869, 6.1561055183410645, 6.167064666748047, 6.119951248168945, 6.061084270477295, 6.043691158294678, 6.0657477378845215, 6.039882183074951, 6.0259599685668945, 6.033430576324463, 6.086813449859619, 6.145788669586182, 6.196253776550293, 6.211984157562256, 6.309621810913086, 6.2128119468688965, 6.231067657470703, 6.193345546722412]
acc10_rl_wf3L_1 =  [0.8, 0.9, 0.7, 0.8, 0.7, 0.7, 0.7, 0.7, 0.7, 0.8, 0.9, 0.9, 0.9, 0.8, 0.8, 0.9, 0.7, 0.9, 0.8, 0.9]
loss10_rl_wf3L_2 = [6.302560329437256, 6.301375865936279, 6.193605422973633, 5.891774654388428, 5.8791680335998535, 5.819889545440674, 5.7734575271606445, 5.748254299163818, 5.71295166015625, 5.732082366943359, 5.639472961425781, 5.682351589202881, 5.653399467468262, 5.682971954345703, 5.645527362823486, 5.625146389007568, 5.710859298706055, 5.778529644012451, 5.806413650512695, 5.776465892791748]
acc10_rl_wf3L_2 =  [0.7, 0.7, 0.7, 0.8, 0.9, 0.8, 0.8, 0.8, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.8, 0.8, 0.8, 0.8]
loss10_rl_wf3L_3 = [5.829983234405518, 5.871901035308838, 5.838593006134033, 5.90823221206665, 5.892815589904785, 5.889133453369141, 5.8740692138671875, 5.886655330657959, 5.946518421173096, 5.89283561706543, 5.8639912605285645, 5.87570858001709, 5.908908843994141, 5.9037957191467285, 5.899363994598389, 5.953041076660156, 5.9660258293151855, 5.94234561920166, 5.949903964996338, 6.293219566345215]
acc10_rl_wf3L_3 = [0.7, 0.6, 0.7, 0.7, 0.6, 0.7, 0.7, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.5, 0.6, 0.6, 0.6, 0.8]
loss10_rl_wf3L_4 = [6.10077428817749, 6.034894943237305, 5.956942081451416, 5.81542444229126, 5.817030906677246, 5.765181064605713, 5.757469177246094, 5.751886367797852, 5.732689380645752, 5.746334075927734, 5.796725273132324, 6.682952880859375, 6.755970478057861, 7.634705543518066, 7.3026885986328125, 7.190364360809326, 7.209506988525391, 7.242550373077393, 7.194331169128418, 7.2082319259643555]
acc10_rl_wf3L_4 = [0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.8, 0.7, 0.0, 0.2, 0.4, 0.4, 0.3, 0.3, 0.3]
loss10_rl_wf3L_5 =[7.047192573547363, 7.021970272064209, 6.889268398284912, 6.914444446563721, 6.81199836730957, 6.7573561668396, 6.731394290924072, 6.0981950759887695, 6.047529220581055, 6.0317888259887695, 6.0500946044921875, 5.9747419357299805, 5.965673923492432, 5.9340386390686035, 5.954043388366699, 5.933080196380615, 5.899858474731445, 5.871359348297119, 5.896395206451416, 5.900540351867676]
acc10_rl_wf3L_5 =  [0.3, 0.3, 0.6, 0.6, 0.6, 0.6, 0.7, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8]

train_acc_fin10_rl_wf_3L = [0.8,0.8,0.8,0.3,0.9]
test_acc_fin10_rl_wf_3L = [0.75, 0.76,0.7,0.48,0.72]

#### 20 immagini
loss20_rl_wf3L_1 = [12.149927139282227, 12.122002601623535, 12.08387565612793, 11.91922378540039, 11.988725662231445, 11.972558975219727, 12.017556190490723, 12.039064407348633, 12.098991394042969, 12.028205871582031, 12.023735046386719, 12.004756927490234, 12.053178787231445, 12.08519458770752, 12.353559494018555, 12.335554122924805, 12.486140251159668, 12.487654685974121, 12.483481407165527, 12.424147605895996]
acc20_rl_wf3L_1 =  [0.8, 0.8, 0.8, 0.75, 0.75, 0.75, 0.7, 0.7, 0.7, 0.75, 0.8, 0.75, 0.75, 0.7, 0.75, 0.7, 0.7, 0.7, 0.7, 0.7]
loss20_rl_wf3L_2 = [12.253791809082031, 12.220261573791504, 13.495490074157715, 13.263465881347656, 12.724895477294922, 12.223730087280273, 12.20604133605957, 12.121698379516602, 12.169282913208008, 12.15279769897461, 12.189318656921387, 12.452401161193848, 12.295676231384277, 12.186180114746094, 12.206111907958984, 12.152861595153809, 12.163558959960938, 12.123937606811523, 12.804548263549805, 12.632858276367188]
acc20_rl_wf3L_2 =  [0.8, 0.8, 0.55, 0.6, 0.85, 0.9, 0.95, 0.9, 0.8, 0.8, 0.8, 0.85, 0.85, 0.9, 0.8, 0.75, 0.75, 0.8, 0.7, 0.7]
loss20_rl_wf3L_3 = [12.682464599609375, 12.678430557250977, 12.64921760559082, 12.538939476013184, 12.36794662475586, 12.356663703918457, 13.65572452545166, 13.430398941040039, 12.747865676879883, 12.383783340454102, 12.125555038452148, 11.784588813781738, 11.750717163085938, 11.752120971679688, 11.754251480102539, 11.755413055419922, 11.79049301147461, 11.783172607421875, 11.860633850097656, 12.24793815612793]
acc20_rl_wf3L_3 = [0.65, 0.7, 0.7, 0.7, 0.65, 0.65, 0.65, 0.7, 0.65, 0.7, 0.75, 0.6, 0.6, 0.6, 0.6, 0.65, 0.65, 0.65, 0.65, 0.7]
loss20_rl_wf3L_4 = [12.07924747467041, 12.06314754486084, 11.936891555786133, 12.003775596618652, 12.041540145874023, 11.909736633300781, 11.871874809265137, 11.92003345489502, 11.893157005310059, 11.853168487548828, 11.854204177856445, 11.84329605102539, 11.824603080749512, 11.901214599609375, 11.794713973999023, 11.811223030090332, 11.800089836120605, 11.841601371765137, 12.164287567138672, 12.18502426147461]
acc20_rl_wf3L_4 = [0.8, 0.85, 0.8, 0.85, 0.75, 0.8, 0.8, 0.75, 0.75, 0.75, 0.7, 0.7, 0.75, 0.65, 0.7, 0.7, 0.75, 0.7, 0.8, 0.8]
loss20_rl_wf3L_5 =[12.835417747497559, 12.84473991394043, 12.758378982543945, 12.619714736938477, 12.675909042358398, 12.596780776977539, 12.549997329711914, 12.415384292602539, 12.436750411987305, 12.498791694641113, 12.523353576660156, 12.661706924438477, 12.631770133972168, 12.601723670959473, 12.63910961151123, 12.578012466430664, 12.632091522216797, 12.513045310974121, 12.288423538208008, 12.245148658752441]
acc20_rl_wf3L_5 = [0.55, 0.6, 0.6, 0.6, 0.55, 0.55, 0.55, 0.65, 0.7, 0.65, 0.65, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]

train_acc_fin20_rl_wf_3L = [0.75,0.75,0.75,0.8,0.75]
test_acc_fin20_rl_wf_3L = [0.71, 0.71,0.75,0.74,0.71]

#### 30 immagini
loss30_rl_wf3L_1 = [18.435903549194336, 18.42494010925293, 18.354158401489258, 18.36890983581543, 18.354623794555664, 18.3023681640625, 18.254674911499023, 18.268129348754883, 17.925249099731445, 18.04530906677246, 18.048486709594727, 18.068796157836914, 18.00974464416504, 17.95024871826172, 18.117895126342773, 18.119714736938477, 18.197402954101562, 18.218761444091797, 18.316633224487305, 18.245803833007812]
acc30_rl_wf3L_1 =  [0.8, 0.8333333333333334, 0.7666666666666667, 0.8, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.8, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667]
loss30_rl_wf3L_2 = [18.22936248779297, 18.18952751159668, 18.229862213134766, 18.28447723388672, 18.290761947631836, 18.364017486572266, 18.345539093017578, 20.268980026245117, 20.211769104003906, 19.768611907958984, 19.140975952148438, 18.581947326660156, 18.322813034057617, 18.253637313842773, 18.366518020629883, 18.209915161132812, 18.28192901611328, 18.367033004760742, 18.406740188598633, 18.421091079711914]
acc30_rl_wf3L_2 =  [0.8, 0.8, 0.8, 0.8, 0.7333333333333333, 0.7, 0.8, 0.6333333333333333, 0.6333333333333333, 0.7, 0.7666666666666667, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7, 0.7, 0.7333333333333333, 0.7666666666666667, 0.7, 0.7333333333333333]
loss30_rl_wf3L_3 = [18.145116806030273, 18.132831573486328, 18.09792137145996, 17.9445858001709, 17.87850570678711, 17.83104705810547, 17.88665199279785, 17.730812072753906, 17.74121856689453, 17.671817779541016, 17.736915588378906, 17.686172485351562, 17.717967987060547, 17.704673767089844, 17.690231323242188, 17.735074996948242, 17.4639892578125, 17.66781997680664, 17.58770179748535, 17.661470413208008]
acc30_rl_wf3L_3 = [0.7, 0.7, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7, 0.7333333333333333, 0.7666666666666667, 0.7, 0.7, 0.7, 0.6666666666666666, 0.6666666666666666, 0.7, 0.7, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333]
loss30_rl_wf3L_4 =[18.038414001464844, 18.04887580871582, 18.08567237854004, 18.01471710205078, 17.993913650512695, 17.87825584411621, 17.857755661010742, 17.89840316772461, 18.020627975463867, 18.01462173461914, 18.009647369384766, 18.175628662109375, 18.161447525024414, 18.239225387573242, 18.401527404785156, 18.406938552856445, 18.304964065551758, 18.19724464416504, 18.16860008239746, 18.194631576538086]
acc30_rl_wf3L_4 = [0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.8, 0.8, 0.8, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667]
loss30_rl_wf3L_5 =[18.67393684387207, 18.6483154296875, 18.829421997070312, 18.540037155151367, 18.477811813354492, 18.36248016357422, 18.416982650756836, 18.300180435180664, 18.255687713623047, 18.105390548706055, 18.07683753967285, 17.892898559570312, 17.977619171142578, 17.849781036376953, 17.861087799072266, 17.876970291137695, 17.893220901489258, 17.958181381225586, 17.96346664428711, 17.985206604003906]
acc30_rl_wf3L_5 = [0.7333333333333333, 0.7333333333333333, 0.7, 0.7, 0.7, 0.7, 0.7333333333333333, 0.7, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.8, 0.8, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333]

train_acc_fin30_rl_wf_3L = [0.7666666666666667,0.7333333333333333, 0.7666666666666667,0.7666666666666667,0.7333333333333333]
test_acc_fin30_rl_wf_3L = [0.74, 0.76,0.74,0.67,0.76]


#### 40 immagini
loss40_rl_wf3L_1 = [24.60735321044922, 24.56182098388672, 24.42862319946289, 24.14556884765625, 24.255401611328125, 24.105697631835938, 24.261674880981445, 24.197147369384766, 24.144329071044922, 24.05755043029785, 23.74028778076172, 23.996387481689453, 24.067094802856445, 23.907108306884766, 24.092424392700195, 24.10284996032715, 24.382831573486328, 24.378419876098633, 24.304487228393555, 24.325178146362305]
acc40_rl_wf3L_1 =  [0.8, 0.8, 0.75, 0.775, 0.775, 0.75, 0.725, 0.725, 0.75, 0.775, 0.75, 0.775, 0.8, 0.825, 0.775, 0.75, 0.75, 0.75, 0.75, 0.775]
loss40_rl_wf3L_2 = [24.332387924194336, 24.270692825317383, 24.354171752929688, 24.252288818359375, 24.099010467529297, 24.181488037109375, 24.132186889648438, 24.06342124938965, 24.317350387573242, 24.26446533203125, 24.332365036010742, 24.192293167114258, 24.433805465698242, 24.672210693359375, 24.50069808959961, 24.623680114746094, 24.59529685974121, 24.583742141723633, 24.544618606567383, 24.643239974975586]
acc40_rl_wf3L_2 =  [0.7, 0.725, 0.725, 0.7, 0.8, 0.8, 0.825, 0.8, 0.725, 0.75, 0.725, 0.75, 0.75, 0.725, 0.75, 0.725, 0.75, 0.725, 0.725, 0.725]
loss40_rl_wf3L_3 = [24.526365280151367, 24.505647659301758, 24.278152465820312, 24.455472946166992, 24.41202163696289, 24.4710750579834, 24.387664794921875, 24.57994270324707, 24.661922454833984, 24.468950271606445, 24.242481231689453, 24.32469367980957, 24.402135848999023, 24.425010681152344, 23.72321891784668, 23.83370590209961, 24.025388717651367, 28.559152603149414, 28.684162139892578, 27.386049270629883]
acc40_rl_wf3L_3 = [0.7, 0.7, 0.725, 0.75, 0.775, 0.825, 0.825, 0.8, 0.8, 0.8, 0.8, 0.8, 0.825, 0.8, 0.8, 0.8, 0.8, 0.45, 0.475, 0.6]
loss40_rl_wf3L_4 =[26.367033004760742, 26.336711883544922, 25.959522247314453, 25.743053436279297, 25.6351318359375, 25.69796371459961, 25.52393913269043, 25.614160537719727, 25.375804901123047, 25.547607421875, 25.811281204223633, 25.71146011352539, 25.69229507446289, 25.790632247924805, 25.634578704833984, 25.47422981262207, 25.64708137512207, 25.638811111450195, 25.445253372192383, 25.488569259643555]
acc40_rl_wf3L_4 = [0.675, 0.65, 0.675, 0.7, 0.7, 0.65, 0.725, 0.725, 0.725, 0.725, 0.675, 0.675, 0.625, 0.65, 0.65, 0.625, 0.625, 0.675, 0.7, 0.675]
loss40_rl_wf3L_5 =[25.497957229614258, 25.499025344848633, 25.471290588378906, 25.46757698059082, 25.661165237426758, 25.64542579650879, 25.437856674194336, 25.49995231628418, 25.483095169067383, 25.459762573242188, 25.36760902404785, 25.500629425048828, 25.470428466796875, 25.54496955871582, 25.450441360473633, 25.518421173095703, 25.392797470092773, 26.471323013305664, 26.37441062927246, 25.516155242919922]
acc40_rl_wf3L_5 = [0.7, 0.725, 0.75, 0.725, 0.725, 0.725, 0.725, 0.725, 0.75, 0.75, 0.725, 0.725, 0.725, 0.725, 0.725, 0.75, 0.75, 0.725, 0.75, 0.725]

train_acc_fin40_rl_wf_3L = [0.775,0.725, 0.7,0.675,0.8]
test_acc_fin40_rl_wf_3L = [0.75, 0.72,0.78,0.77,0.7]

train_acc_fin50_rl_wf_3L = [0.8,0.76, 0.74,0.76,0.68]
test_acc_fin50_rl_wf_3L = [0.72, 0.75,0.78,0.72,0.76]

train_accf_rl_WF = np.array([train_acc_fin6_rl_wf_3L, train_acc_fin10_rl_wf_3L, train_acc_fin20_rl_wf_3L, train_acc_fin30_rl_wf_3L, train_acc_fin40_rl_wf_3L, train_acc_fin50_rl_wf_3L])
test_accf_rl_WF = np.array([test_acc_fin6_rl_wf_3L, test_acc_fin10_rl_wf_3L, test_acc_fin20_rl_wf_3L, test_acc_fin30_rl_wf_3L, test_acc_fin40_rl_wf_3L, test_acc_fin50_rl_wf_3L])

av_train_rl_WF = [np.mean(sublist) for sublist in train_accf_rl_WF]
std_train_rl_WF= [np.std(sublist) for sublist in train_accf_rl_WF]
av_test_rl_WF= [np.mean(sublist) for sublist in test_accf_rl_WF]
std_test_rl_WF = [np.std(sublist) for sublist in test_accf_rl_WF]


plt.plot(x, av_train_rl_WF, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_rl_WF, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_rl_WF,yerr=std_train_rl_WF,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_rl_WF, yerr=std_test_rl_WF,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("RLWF 3L",fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc='best',prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.1)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/RL_WF_train_test.jpg', dpi=800)
#

tr_errorRLWF = train_error(av_train_rl_WF)
te_errorRLWF = test_error(av_test_rl_WF)

plt.plot(x,tr_errorRLWF, ls=':', label='Train error', color='darkblue', marker='s', linewidth=1.)
plt.plot(x,te_errorRLWF, ls=':', label='Test error', color='orangered', marker='v', linewidth=1.)
plt.legend(loc=4,prop={'size': 16})
plt.xlabel('Training set')
plt.ylabel('Value')
plt.title("Error progression")
plt.ylim(0.,0.5)
#plt.savefig('/Users/francescoaldoventurelli/Desktop/CIRCUITSSS/ERROR_QCNN.jpg')
#


#### WFWF MODEL
## 6 immagini

tr_acc16_wfwf6 =[0.5,0.8333333333333334,0.6666666666666666,0.8333333333333334,0.6666666666666666]
test_acc16_wfwf6=[0.63,0.73,0.58,0.58,0.65]

#### WFWF MODEL
## 10 immagini

tr_acc16_wfwf10=[0.7,0.9,0.7,0.8,0.8]
test_acc16_wfwf10=[0.59,0.66,0.54,0.57,0.66]

## 20 immagini
tr_acc16_wfwf20=[0.65,0.5,0.7,0.6,0.55]
test_acc16_wfwf20=[0.6,0.59,0.72,0.67,0.61]

## 30 immagini
tr_acc16_wfwf30=[0.6333333333333333,0.7,0.6666666666666666,0.7,0.5666666666666667]
test_acc16_wfwf30=[0.56,0.6,0.58,0.6,0.56]
## 40 immagini
tr_acc16_wfwf40=[0.625,0.7,0.65,0.6,0.55]
test_acc16_wfwf40=[0.56,0.58,0.58,0.58,0.58]
## 50 immagini
tr_acc16_wfwf50=[0.58,0.66,0.6,0.36,0.55]
test_acc16_wfwf50=[0.61,0.59,0.56,0.25,0.58]

train_accf_WFWF = np.array([tr_acc16_wfwf6, tr_acc16_wfwf10, tr_acc16_wfwf20, tr_acc16_wfwf30, tr_acc16_wfwf40, tr_acc16_wfwf50])
test_accf_WFWF = np.array([test_acc16_wfwf6, test_acc16_wfwf10, test_acc16_wfwf20, test_acc16_wfwf30, test_acc16_wfwf40, test_acc16_wfwf50])
av_train_WFWF = [np.mean(sublist) for sublist in train_accf_WFWF]
std_train_WFWF= [np.std(sublist) for sublist in train_accf_WFWF]
av_test_WFWF= [np.mean(sublist) for sublist in test_accf_WFWF]
std_test_WFWF = [np.std(sublist) for sublist in test_accf_WFWF]

plt.plot(x, av_train_WFWF, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_WFWF, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_WFWF,yerr=std_train_WFWF,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_WFWF, yerr=std_test_WFWF,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("WFWF 3L",fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.1)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/WFWF_train_test.jpg', dpi=800)
#

tr_errorWFWF = train_error(av_train_WFWF)
te_errorWFWF = test_error(av_test_WFWF)

plt.plot(x,tr_errorWFWF, ls=':', label='Train error', color='darkblue', marker='s', linewidth=1.)
plt.plot(x,te_errorWFWF, ls=':', label='Test error', color='orangered', marker='v', linewidth=1.)
plt.legend(loc=4,prop={'size': 16})
plt.xlabel('Training set')
plt.ylabel('Value')
plt.title("Error progression WFWF")
plt.ylim(0.,0.5)
#plt.savefig('/Users/francescoaldoventurelli/Desktop/CIRCUITSSS/ERROR_QCNN.jpg')
#

### WATERFALL RINGLIKE 3L model  for  GALAXY
tr_acc16_wfrl6 = [1.0,1.0,1.0,1.0,1.0]
test_acc16_wfrl6 = [0.63, 0.65, 0.66,0.65,0.82]
# 10 immagini
tr_acc16_wfrl10 = [0.8,1.0,0.7,1.0,0.9]
test_acc16_wfrl10 = [0.61, 0.65, 0.69,0.73,0.69]
# 20 immagini
tr_acc16_wfrl20 = [0.9,0.8,0.65,0.85,0.8]
test_acc16_wfrl20 = [0.65, 0.62, 0.68,0.71,0.65]
# 30 immagini
tr_acc16_wfrl30 = [0.8,0.7666666666666667,0.7333333333333333,0.7333333333333333,0.7666666666666667]
test_acc16_wfrl30 = [0.66, 0.63, 0.66,0.66,0.74]
# 40 immagini
tr_acc16_wfrl40 = [0.85,0.825,0.725,0.375,0.775]
test_acc16_wfrl40 = [0.66, 0.64, 0.62,0.38,0.66]
# 50 immagini
tr_acc16_wfrl50 = [0.78,0.82,0.78,0.76,0.8]
test_acc16_wfrl50 = [0.65, 0.67, 0.66,0.67,0.74]

train_accf_WFRL = np.array([tr_acc16_wfrl6, tr_acc16_wfrl10, tr_acc16_wfrl20, tr_acc16_wfrl30, tr_acc16_wfrl40, tr_acc16_wfrl50])
test_accf_WFRL = np.array([test_acc16_wfrl6, test_acc16_wfrl10, test_acc16_wfrl20, test_acc16_wfrl30, test_acc16_wfrl40, test_acc16_wfrl50])
av_train_WFRL = [np.mean(sublist) for sublist in train_accf_WFRL]
std_train_WFRL= [np.std(sublist) for sublist in train_accf_WFRL]
av_test_WFRL= [np.mean(sublist) for sublist in test_accf_WFRL]
std_test_WFRL = [np.std(sublist) for sublist in test_accf_WFRL]

plt.plot(x, av_train_WFRL, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_WFRL, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_WFRL,yerr=std_train_WFWF,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_WFRL, yerr=std_test_WFWF,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("WFRL 3L",fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.2)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/WFRL_train_test.jpg', dpi=800)
#

tr_errorWFRL = train_error(av_train_WFRL)
te_errorWFRL = test_error(av_test_WFRL)

plt.plot(x,tr_errorWFRL, ls=':', label='Train error', color='darkblue', marker='s', linewidth=1.)
plt.plot(x,te_errorWFRL, ls=':', label='Test error', color='orangered', marker='v', linewidth=1.)
plt.legend(loc=4,prop={'size': 16})
plt.xlabel('Training set')
plt.ylabel('Value')
plt.title("Error progression WFRL")
plt.ylim(0.,0.5)
#plt.savefig('/Users/francescoaldoventurelli/Desktop/CIRCUITSSS/ERROR_QCNN.jpg')
#

### QCNN ANSATZ + WATERFALL FEATURE MAP
tr_acc16_wfQCNN6 = [0.6666666666666666,1.0,0.6666666666666666,0.8333333333333334,0.8333333333333334]
test_acc16_wfQCNN6 = [0.45, 0.61, 0.54,0.67,0.62]
tr_acc16_wfQCNN10 = [0.6,0.9,0.6,0.7,0.7]
test_acc16_wfQCNN10 = [0.33, 0.64, 0.54,0.7,0.73]
tr_acc16_wfQCNN20 = [0.75,0.7,0.9,0.7,0.8]
test_acc16_wfQCNN20 = [0.54, 0.58, 0.57,0.46,0.68]
tr_acc16_wfQCNN30 = [0.3,0.43333333333333335,0.8,0.8333333333333334,0.36666666666666664]
test_acc16_wfQCNN30 = [0.44, 0.4, 0.81,0.76,0.25]
tr_acc16_wfQCNN40 = [0.55,0.65,0.675,0.675,0.725]
test_acc16_wfQCNN40 = [0.57, 0.65, 0.72,0.71,0.75]
tr_acc16_wfQCNN50 = [0.7,0.76,0.7,0.78,0.82]
test_acc16_wfQCNN50 = [0.68, 0.68, 0.74,0.72,0.7]

train_accf_WFQCNN = np.array([tr_acc16_wfQCNN6, tr_acc16_wfQCNN10, tr_acc16_wfQCNN20, tr_acc16_wfQCNN30, tr_acc16_wfQCNN40, tr_acc16_wfQCNN50])
test_accf_WFQCNN = np.array([test_acc16_wfQCNN6, test_acc16_wfQCNN10, test_acc16_wfQCNN20, test_acc16_wfQCNN30, test_acc16_wfQCNN40, test_acc16_wfQCNN50])
av_train_WFQCNN = [np.mean(sublist) for sublist in train_accf_WFQCNN]
std_train_WFQCNN= [np.std(sublist) for sublist in train_accf_WFQCNN]
av_test_WFQCNN= [np.mean(sublist) for sublist in test_accf_WFQCNN]
std_test_WFQCNN = [np.std(sublist) for sublist in test_accf_WFQCNN]

plt.plot(x, av_train_WFQCNN, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_WFQCNN, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_WFQCNN,yerr=std_train_WFWF,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_WFQCNN, yerr=std_test_WFWF,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("WFQCNN",fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.2)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/WFQCNN_train_test.jpg', dpi=800)
#

tr_errorWFQCNN = train_error(av_train_WFQCNN)
te_errorWFQCNN = test_error(av_test_WFQCNN)

plt.plot(x,tr_errorWFQCNN, ls=':', label='Train error', color='darkblue', marker='s', linewidth=1.)
plt.plot(x,te_errorWFQCNN, ls=':', label='Test error', color='orangered', marker='v', linewidth=1.)
plt.legend(loc=4,prop={'size': 16})
plt.xlabel('Training set')
plt.ylabel('Value')
plt.title("Error progression WFQCNN")
plt.ylim(0.,0.5)
#plt.savefig('/Users/francescoaldoventurelli/Desktop/CIRCUITSSS/ERROR_QCNN.jpg')
#


##GALAXI DATASET RL-CZ CIRCUIT
train_acc_CZ_6 = [0.8333333333333334,1.0,0.6666666666666666,1.0,0.8333333333333334]
test_acc_CZ_6 = [0.78,0.8,0.71,0.73,0.81]
train_acc_CZ_10 = [0.8,1.0,0.9,0.8,0.9]
test_acc_CZ_10 = [0.69,0.74,0.74,0.77,0.81]
train_acc_CZ_20 = [0.7,0.75,0.75,0.7,0.65]
test_acc_CZ_20 = [0.75,0.81,0.75,0.75,0.72]
train_acc_CZ_30 = [ 0.26666666666666666,0.8666666666666667, 0.8333333333333334,0.8666666666666667,0.76]
test_acc_CZ_30 = [0.37,0.7,0.73,0.8,0.72]
train_acc_CZ_40 = [ 0.675,0.9, 0.75,0.725,0.75]
test_acc_CZ_40 = [0.8,0.79,0.76,0.73,0.73]
train_acc_CZ_50 = [ 0.7,0.82, 0.84,0.75,0.9]
test_acc_CZ_50 = [0.65,0.72,0.66,0.7,0.8]

train_accf_RLCZ = np.array([train_acc_CZ_6, train_acc_CZ_10, train_acc_CZ_20, train_acc_CZ_30, train_acc_CZ_40, train_acc_CZ_50])
test_accf_RLCZ = np.array([test_acc_CZ_6, test_acc_CZ_10, test_acc_CZ_20, test_acc_CZ_30, test_acc_CZ_40, test_acc_CZ_50])
av_train_RLCZ = [np.mean(sublist) for sublist in train_accf_RLCZ]
std_train_RLCZ= [np.std(sublist) for sublist in train_accf_RLCZ]
av_test_RLCZ= [np.mean(sublist) for sublist in test_accf_RLCZ]
std_test_RLCZ = [np.std(sublist) for sublist in test_accf_RLCZ]

plt.plot(x, av_train_RLCZ, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_RLCZ, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_RLCZ,yerr=std_train_WFWF,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_RLCZ, yerr=std_test_WFWF,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("RL-CZ",fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.2)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/RL_CZ_train_test.jpg', dpi=800)
##

#### WF-CZ model
train_acc_WFCZ_6 = [0.5, 0.8333333333333334, 0.8333333333333334,0.666666666666666,1.0]
test_acc_WFCZ_6 = [0.53,0.72,0.64,0.53,0.77]
train_acc_WFCZ_10 = [0.55, 0.6, 0.7,0.78,0.67]
test_acc_WFCZ_10 = [0.52,0.57,0.65,0.66,0.7]
train_acc_WFCZ_20 = [0.75, 0.4, 0.8,0.35,0.8]
test_acc_WFCZ_20 = [0.74,0.51,0.65,0.36,0.62]
train_acc_WFCZ_30 = [0.8, 0.6333333333333333, 0.8,0.633333333333333,0.7]
test_acc_WFCZ_30 = [0.73,0.66,0.76,0.7,0.68]
train_acc_WFCZ_40 = [0.875, 0.825, 0.7,0.825,0.425]
test_acc_WFCZ_40 = [0.74,0.69,0.71,0.75,0.49]
train_acc_WFCZ_50 = [0.74, 0.82, 0.64,0.72,0.8]
test_acc_WFCZ_50 = [0.73,0.74,0.54,0.65,0.68]

train_accf_WFCZ = np.array([train_acc_WFCZ_6, train_acc_WFCZ_10, train_acc_WFCZ_20, train_acc_WFCZ_30, train_acc_WFCZ_40, train_acc_WFCZ_50])
test_accf_WFCZ = np.array([test_acc_WFCZ_6, test_acc_WFCZ_10, test_acc_WFCZ_20, test_acc_WFCZ_30, test_acc_WFCZ_40, test_acc_WFCZ_50])
av_train_WFCZ = [np.mean(sublist) for sublist in train_accf_WFCZ]
std_train_WFCZ= [np.std(sublist) for sublist in train_accf_WFCZ]
av_test_WFCZ= [np.mean(sublist) for sublist in test_accf_WFCZ]
std_test_WFCZ = [np.std(sublist) for sublist in test_accf_WFCZ]

plt.plot(x, av_train_WFCZ, linewidth=2.1, alpha=0.8, color='darkblue', ls=':')
plt.plot(x, av_test_WFCZ, linewidth=2.1, alpha=0.8, color='orangered', ls=':')
plt.plot(x, random_guess, linewidth=2, marker='o', markerfacecolor='none', markersize=8, color='k', ls=':', label='Random guess')
plt.errorbar(x, av_train_WFCZ,yerr=std_train_WFWF,fmt='o',markerfacecolor='darkblue', markeredgecolor='darkblue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='darkblue')
plt.errorbar(x, av_test_WFCZ, yerr=std_test_WFWF,fmt='s',markerfacecolor='orangered', markeredgecolor='orangered', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='orangered')
plt.title("WF-CZ",fontsize=12, fontweight='semibold')
plt.xlabel('Training set',fontsize=12, fontweight='semibold')
plt.ylabel('Value',fontsize=12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets,fontsize=12, fontweight='semibold')
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.ylim(0,1.2)
plt.savefig('/Users/francescoaldoventurelli/Desktop/results/WF_CZ_train_test.jpg', dpi=800)
#


print("TRAIN RLQCNN MODEL", av_train_WFQCNN)
print("")
print("STD RLQCNN TRAIN", std_train_WFQCNN)

print("TEST RLQCNN MODEL", av_test_WFQCNN)
print("")
print("STD RLQCNN TEST", std_test_WFQCNN)