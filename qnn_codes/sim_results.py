import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
#sns.set_style('whitegrid')

#### Function for plotting
def plot_loss(train_loss_list,nitems):
    labels = ['run0', 'run1', 'run2', 'run4', 'run5']
    fig = plt.figure(figsize=(8,5))
    plt.xlim(0,20)
    x_vector = np.linspace(0,20,20)
    default_x_ticks = range(len(x_vector))
    plt.title("Training loss during steps")
    plt.suptitle("Training set of" +str(nitems)+ "images")
    plt.xlabel("Steps")
    plt.ylabel("Training loss")
    with plt.style.context('fivethirtyeight'):
        for j in range(len(train_loss_list)):
            plt.plot(train_loss_list[j], label =labels[j], marker='s', markersize = 8, linewidth=3)
            plt.legend(loc=1)
    plt.xticks(default_x_ticks)
    plt.grid(True)
    plt.savefig("/Users/francescoaldoventurelli/Desktop/workfolder/FIGUREXPRESENTATION/train_loss"+str(nitems)+".jpg")
    return fig


def plot_accuracy(train_acc_list,nitems):
    labels = ['run0', 'run1', 'run2', 'run4', 'run5']
    fig = plt.figure(figsize=(8,5))
    plt.xlim(0,20)
    plt.ylim(0,1)
    x_vector = np.linspace(0,20,20)
    default_x_ticks = range(len(x_vector))
    plt.title("Training accuracy during steps")
    plt.suptitle("Training set of" +str(nitems)+ "images")
    plt.xlabel("Steps")
    plt.ylabel("Training accuracy")
    with plt.style.context('fivethirtyeight'):
        for j in range(len(train_acc_list)):
            plt.plot(train_acc_list[j], label =labels[j], marker='s', markersize = 8, linewidth=3)
            plt.legend(loc=4)
    plt.xticks(default_x_ticks)
    plt.grid(True)
    plt.savefig("/Users/francescoaldoventurelli/Desktop/workfolder/FIGUREXPRESENTATION/train_acc"+str(nitems)+".jpg")
    return fig



#### Collect the training loss and accuracy for a specific dataset:
#### 20 TRAINING IMAGES

acc_tr_run1 = [0.4, 0.4, 0.45, 0.4, 0.55, 0.65, 0.65, 0.5, 0.55, 0.65, 0.65, 0.65, 0.6, 0.65, 0.65, 0.6, 0.7, 0.55, 0.6, 0.6]
acc_tr_run2 = [0.6, 0.6, 0.6, 0.6, 0.4, 0.65, 0.8, 0.75, 0.75, 0.7, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.85, 0.85, 0.8]
acc_tr_run3 = [0.45, 0.45, 0.4, 0.4, 0.45, 0.65, 0.65, 0.75, 0.75, 0.8, 0.8, 0.85, 0.8, 0.75, 0.8, 0.75, 0.85, 0.85, 0.85, 0.75]
acc_tr_run4 = [0.65, 0.75, 0.7, 0.7, 0.8, 0.75, 0.75, 0.7, 0.75, 0.7, 0.75, 0.75, 0.7, 0.75, 0.7, 0.8, 0.75, 0.75, 0.8, 0.75]
acc_tr_run5 = [0.55, 0.55, 0.55, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.55, 0.55, 0.55, 0.55, 0.55, 0.65, 0.6, 0.55, 0.6]

loss_tr_run1 = [14.189634323120117, 14.201765060424805, 14.107038497924805, 13.858335494995117, 13.759888648986816, 13.733870506286621, 13.65382194519043, 13.613234519958496, 13.487558364868164, 13.276970863342285, 13.269523620605469, 13.263172149658203, 13.256486892700195, 13.314948081970215, 13.242090225219727, 13.236519813537598, 13.137955665588379, 13.270099639892578, 13.213218688964844, 13.262648582458496]
loss_tr_run2 = [13.585563659667969, 13.624246597290039, 13.684134483337402, 13.576662063598633, 14.498303413391113, 13.641766548156738, 13.019351959228516, 12.992643356323242, 12.886720657348633, 12.915205001831055, 12.688310623168945, 12.636759757995605, 12.68268871307373, 12.878345489501953, 12.860472679138184, 12.817845344543457, 12.754432678222656, 12.734169960021973, 12.744776725769043, 12.753621101379395]
loss_tr_run3 = [14.217395782470703, 14.144543647766113, 14.004095077514648, 13.688714981079102, 13.715066909790039, 13.439437866210938, 13.45712661743164, 13.239516258239746, 13.298355102539062, 13.323211669921875, 13.221181869506836, 13.032403945922852, 13.040018081665039, 13.097269058227539, 13.163248062133789, 13.154923439025879, 13.035680770874023, 12.989042282104492, 12.985435485839844, 12.876226425170898]
loss_tr_run4 = [13.484291076660156, 13.374429702758789, 13.354923248291016, 13.190706253051758, 13.065155029296875, 12.774443626403809, 12.845293045043945, 12.823322296142578, 12.821361541748047, 12.835607528686523, 12.945083618164062, 12.94198989868164, 12.89652156829834, 12.828052520751953, 12.775330543518066, 12.713740348815918, 12.670052528381348, 12.759296417236328, 12.715648651123047, 12.74072265625]
loss_tr_run5 = [13.523509979248047, 13.539115905761719, 13.542342185974121, 13.478250503540039, 13.355352401733398, 13.483142852783203, 13.270648002624512, 13.309075355529785, 13.319738388061523, 13.297356605529785, 13.516668319702148, 13.51248836517334, 13.503137588500977, 13.303518295288086, 13.366034507751465, 13.301963806152344, 13.3701810836792, 13.4423189163208, 13.420414924621582, 13.316448211669922]

tracc20_fin = [0.5, 0.35,0.7,0.75,0.65]
testacc20_fin = [0.5857142857142857,0.38571428571428573,0.6285714285714286,0.7071428571428572,0.65]

### missing images on TESTING
datatrain20 = {
    'Missed images': (58, 86, 52, 41, 49),
    'Missed 0': (37, 24, 38, 36, 42),
    'Missed 1': (21, 62, 14, 5, 7),
}


all_train_acc = [acc_tr_run1, acc_tr_run2, acc_tr_run3, acc_tr_run4, acc_tr_run5]
all_train_losses = [loss_tr_run1, loss_tr_run2, loss_tr_run3, loss_tr_run4, loss_tr_run5]


#plot_accuracy(all_train_acc,20)
#plt.savefig("/Users/francescoaldoventurelli/Desktop/workfolder/FIGUREXPRESENTATION/train_acc20.jpg")
#plot_loss(all_train_losses,20)
#plt.savefig("/Users/francescoaldoventurelli/Desktop/workfolder/FIGUREXPRESENTATION/train_loss20.jpg")
#plt.show()
"""
recision, recall, f_score, support: (array([0.5, 0.5]), array([0.3, 0.7]), array([0.375     , 0.58333333]), array([10, 10]))
Precision, recall, f_score, support: (array([0.61111111, 0.56976744]), array([0.47142857, 0.7       ]), array([0.53225806, 0.62820513]), array([70, 70]))
Precision, recall, f_score, support: (array([0.4, 0.2]), array([0.6, 0.1]), array([0.48      , 0.13333333]), array([10, 10]))
Precision, recall, f_score, support: (array([0.42592593, 0.25      ]), array([0.65714286, 0.11428571]), array([0.51685393, 0.15686275]), array([70, 70]))

Precision, recall, f_score, support: (array([0.75      , 0.66666667]), array([0.6, 0.8]), array([0.66666667, 0.72727273]), array([10, 10]))
Precision, recall, f_score, support: (array([0.69565217, 0.59574468]), array([0.45714286, 0.8       ]), array([0.55172414, 0.68292683]), array([70, 70]))

Precision, recall, f_score, support: (array([0.77777778, 0.72727273]), array([0.7, 0.8]), array([0.73684211, 0.76190476]), array([10, 10]))
Precision, recall, f_score, support: (array([0.87179487, 0.64356436]), array([0.48571429, 0.92857143]), array([0.62385321, 0.76023392]), array([70, 70]))

Precision, recall, f_score, support: (array([0.8, 0.6]), array([0.4, 0.9]), array([0.53333333, 0.72      ]), array([10, 10]))
Precision, recall, f_score, support: (array([0.8, 0.6]), array([0.4, 0.9]), array([0.53333333, 0.72      ]), array([70, 70]))
"""

#### 50 TRAINING IMAGES

trloss50_1 = [36.66630172729492, 36.705421447753906, 36.18806076049805, 34.7927131652832, 34.02429962158203, 33.920127868652344, 34.11324691772461, 33.90579605102539, 33.7885627746582, 33.61577606201172, 33.59238052368164, 33.41950225830078, 33.36867141723633, 33.47068405151367, 33.14848709106445, 33.10810470581055, 33.02141189575195, 32.995323181152344, 33.02033996582031, 32.921932220458984]
tracc50_1 = [0.3, 0.3, 0.32, 0.48, 0.56, 0.62, 0.58, 0.54, 0.58, 0.56, 0.58, 0.58, 0.56, 0.6, 0.62, 0.62, 0.6, 0.6, 0.62, 0.64]

trloss50_2 = [33.4393424987793, 33.413944244384766, 33.228939056396484, 32.8802490234375, 32.89710998535156, 32.964656829833984, 32.92533874511719, 32.801204681396484, 32.793212890625, 32.69190979003906, 32.51605987548828, 32.36323165893555, 32.316715240478516, 32.35050582885742, 32.258731842041016, 32.39175033569336, 32.39010238647461, 32.36058807373047, 32.36381530761719, 32.3004035949707]
tracc50_2 = [0.72, 0.76, 0.7, 0.7, 0.72, 0.74, 0.74, 0.72, 0.76, 0.76, 0.76, 0.8, 0.82, 0.82, 0.8, 0.76, 0.74, 0.72, 0.72, 0.76]

trloss50_3 = [33.03147888183594, 33.0731086730957, 32.99980545043945, 32.71388244628906, 32.56739044189453, 32.26278305053711, 32.22633361816406, 32.0200080871582, 32.127628326416016, 32.19021224975586, 32.02696228027344, 32.07285690307617, 32.02090072631836, 31.902650833129883, 31.815324783325195, 31.713037490844727, 31.68959617614746, 31.659027099609375, 31.846406936645508, 32.72386169433594]
tracc50_3 = [0.6, 0.58, 0.64, 0.68, 0.72, 0.72, 0.72, 0.72, 0.68, 0.72, 0.74, 0.74, 0.7, 0.72, 0.76, 0.78, 0.78, 0.8, 0.8, 0.7]

trloss50_4 = [33.69325637817383, 33.54073715209961, 33.58333206176758, 33.51308059692383, 33.64030075073242, 33.58858871459961, 33.42715835571289, 33.49706268310547, 33.62570571899414, 33.47669219970703, 33.39528274536133, 33.28864288330078, 33.36903762817383, 33.41960906982422, 33.378196716308594, 33.4548454284668, 33.31368637084961, 33.3747444152832, 33.50954055786133, 33.49830627441406]
tracc50_4 = [0.62, 0.6, 0.62, 0.62, 0.54, 0.6, 0.66, 0.6, 0.6, 0.68, 0.66, 0.68, 0.64, 0.64, 0.68, 0.7, 0.62, 0.58, 0.56, 0.56]

trloss50_5 = [33.19783401489258, 33.08564758300781, 32.93317413330078, 32.754302978515625, 32.555259704589844, 32.56650161743164, 32.71092224121094, 32.325904846191406, 32.55644989013672, 32.47166442871094, 32.33280944824219, 32.18429946899414, 32.24790573120117, 32.19217300415039, 32.16231155395508, 32.419517517089844, 32.19634246826172, 32.155277252197266, 32.24381637573242, 32.09538269042969]
tracc50_5 = [0.66, 0.64, 0.72, 0.76, 0.76, 0.8, 0.72, 0.8, 0.74, 0.76, 0.78, 0.78, 0.76, 0.78, 0.76, 0.72, 0.68, 0.74, 0.66, 0.68]

####### QUELLE FINALI!!!!!
traccuracy_fin = [0.64,0.72,0.72,0.6,0.66]
testacc_fin = [0.6142857142857143,0.6571428571428571,0.7214285714285714,0.6714285714285714,0.7571428571428571]
#######

allloss50 = np.array([trloss50_1,trloss50_2,trloss50_3,trloss50_4,trloss50_5])
allacc50 = np.array([tracc50_1,tracc50_2,tracc50_3,tracc50_4,tracc50_5])
#plot_loss(allloss50,50)
#plt.savefig("/Users/francescoaldoventurelli/Desktop/workfolder/FIGUREXPRESENTATION/train_loss50.jpg")
#plot_accuracy(allacc50,50)
#plt.savefig("/Users/francescoaldoventurelli/Desktop/workfolder/FIGUREXPRESENTATION/train_acc50.jpg")
#plt.show()



datatrain50 = {
    'Missed images': (54, 48, 39, 46, 34),
    'Missed 0': (42, 39, 27, 29, 26),
    'Missed 1': (12, 9, 12, 17, 8),
}



##### ALTRI DATI (PRECISION, RECALL, F_SCORE, SUPPORT) sempre per 50 dati training

'''Precision, recall, f_score, support: (array([0.76923077, 0.59459459]), array([0.4 , 0.88]), array([0.52631579, 0.70967742]), array([25, 25]))
Precision, recall, f_score, support: (array([0.7 , 0.58]), array([0.4       , 0.82857143]), array([0.50909091, 0.68235294]), array([70, 70]))

Precision, recall, f_score, support: (array([0.86666667, 0.65714286]), array([0.52, 0.92]), array([0.65      , 0.76666667]), array([25, 25]))
Precision, recall, f_score, support: (array([0.775, 0.61 ]), array([0.44285714, 0.87142857]), array([0.56363636, 0.71764706]), array([70, 70]))

Precision, recall, f_score, support: (array([0.82352941, 0.66666667]), array([0.56, 0.88]), array([0.66666667, 0.75862069]), array([25, 25]))
Precision, recall, f_score, support: (array([0.78181818, 0.68235294]), array([0.61428571, 0.82857143]), array([0.688    , 0.7483871]), array([70, 70]))

Precision, recall, f_score, support: (array([0.64705882, 0.57575758]), array([0.44, 0.76]), array([0.52380952, 0.65517241]), array([25, 25]))
Precision, recall, f_score, support: (array([0.70689655, 0.64634146]), array([0.58571429, 0.75714286]), array([0.640625  , 0.69736842]), array([70, 70]))

Precision, recall, f_score, support: (array([0.72222222, 0.625     ]), array([0.52, 0.8 ]), array([0.60465116, 0.70175439]), array([25, 25]))
Precision, recall, f_score, support: (array([0.84615385, 0.70454545]), array([0.62857143, 0.88571429]), array([0.72131148, 0.78481013]), array([70, 70]))'''


#### DATASET DA 6 IMMAGINI DI TRAINING
tloss6_1=[4.163143157958984, 4.15041971206665, 4.096016883850098, 4.059155464172363, 4.018461227416992, 4.061602592468262, 4.082493782043457, 3.9608633518218994, 3.927248239517212, 3.893789052963257, 3.8663835525512695, 3.7975966930389404, 3.7022101879119873, 3.7454330921173096, 3.7755472660064697, 3.764200448989868, 3.780644416809082, 3.6714706420898438, 3.692064046859741, 3.7612228393554688]
tacc6_1 = [0.5, 0.5, 0.5, 0.3333333333333333, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.5, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666]
tloss6_2 = [3.8305344581604004, 3.8506102561950684, 3.7558372020721436, 3.754896640777588, 3.718581199645996, 4.085239887237549, 3.8331851959228516, 3.8389487266540527, 3.833547830581665, 3.8179383277893066, 3.7116000652313232, 3.6365504264831543, 3.7085700035095215, 3.6493258476257324, 3.6700923442840576, 3.6304757595062256, 3.729541063308716, 3.7505743503570557, 3.6921074390411377, 3.730464458465576]
tacc6_2=[0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
tloss6_3=[4.111103534698486, 4.090985298156738, 4.023991584777832, 3.9956960678100586, 4.218390941619873, 4.1941633224487305, 4.127290725708008, 4.104262828826904, 3.9683799743652344, 3.9623405933380127, 3.9684433937072754, 3.8612844944000244, 3.8458738327026367, 3.8677845001220703, 3.814316987991333, 3.7975001335144043, 3.8126254081726074, 3.9089276790618896, 3.7428605556488037, 3.6974825859069824]
tacc6_3=[0.6666666666666666, 0.6666666666666666, 0.5, 0.8333333333333334, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 1.0, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 1.0, 1.0]
tloss6_4=[4.256000995635986, 4.245211601257324, 4.25401496887207, 4.269079208374023, 4.237464904785156, 4.13287878036499, 3.966920852661133, 4.039975643157959, 3.737663507461548, 3.71734356880188, 3.6490070819854736, 3.6574201583862305, 3.653263807296753, 3.6495180130004883, 3.619147300720215, 3.575911521911621, 3.6221280097961426, 3.6509060859680176, 3.6078391075134277, 3.6008529663085938]
tacc6_4=[0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6666666666666666, 0.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
tloss6_5=[3.9554288387298584, 3.9575088024139404, 3.945848226547241, 3.817246675491333, 3.813969135284424, 3.7440266609191895, 3.8345658779144287, 3.9249515533447266, 4.001892566680908, 4.015516757965088, 3.7800986766815186, 3.6792452335357666, 3.6904327869415283, 3.6497321128845215, 3.6837899684906006, 3.6963021755218506, 3.6807384490966797, 3.5958621501922607, 3.662468671798706, 3.690272092819214]
tacc6_5=[0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.5, 0.5, 0.5, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 0.8333333333333334, 1.0, 0.8333333333333334, 1.0]

##### FINALI
tr_acc_fin_6 = [0.6666666666666666,1.0,0.833333333333333, 1.0,1.0]
test_acc_fin6 = [0.5714285714285714,0.5928571428571429,0.5714285714285714,0.7,0.7571428571428571]

loss6 = [tloss6_1,tloss6_2,tloss6_3,tloss6_4,tloss6_5]
acc6 = [tacc6_1,tacc6_2,tacc6_3,tacc6_4,tacc6_5]
#plot_accuracy(acc6,6)
#plot_loss(loss6,6)


datatrain6 =  {
    'Missed images': (60, 57, 60, 42, 34),
    'Missed 0': (50, 35, 36, 35, 23),
    'Missed 1': (10, 22, 24, 7, 11),
}
def histo_miss(image_data, nitmes):
    run = np.array([1,2,3,4,5])
    # Width of a bar 

    width = 0.25    
    multiplier = 0
    x = np.arange(1,len(run)+1,1)   
    fig, ax = plt.subplots(layout='constrained')
    cmap = plt.get_cmap('tab20') 
    plt.set_cmap(cmap)
    for attribute, measurement in image_data.items():
        offset = width * multiplier
        rects = ax.bar(x + offset, measurement, width, label=attribute, color = cmap(multiplier/2))
        ax.bar_label(rects, padding=3)
        multiplier += 1

    plt.legend()
    plt.title('Training set composed by' +str(nitmes)+ 'images')
    plt.suptitle('Misses on TEST SET')
    plt.ylim(0,80)
    plt.xlim(0,7)
    plt.xlabel('Run nÂ°')
    plt.ylabel('Number of images')
    plt.savefig("/Users/francescoaldoventurelli/Desktop/workfolder/FIGUREXPRESENTATION/miss_images_train_set"+str(nitmes)+".jpg")
    return fig



##### ALTRI DATI FSCORE, RECALL, PRECISION PER TRAINING DATA = 6
'''Precision, recall, f_score, support: (array([1. , 0.6]), array([0.33333333, 1.        ]), array([0.5 , 0.75]), array([3, 3]))
Precision, recall, f_score, support: (array([0.66666667, 0.54545455]), array([0.28571429, 0.85714286]), array([0.4       , 0.66666667]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.61403509, 0.57831325]), array([0.5       , 0.68571429]), array([0.5511811 , 0.62745098]), array([70, 70]))

Precision, recall, f_score, support: (array([1.  , 0.75]), array([0.66666667, 1.        ]), array([0.8       , 0.85714286]), array([3, 3]))
Precision, recall, f_score, support: (array([0.5862069 , 0.56097561]), array([0.48571429, 0.65714286]), array([0.53125   , 0.60526316]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.83333333, 0.64285714]), array([0.5, 0.9]), array([0.625, 0.75 ]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.81034483, 0.7195122 ]), array([0.67142857, 0.84285714]), array([0.734375  , 0.77631579]), array([70, 70]))'''


#### DATASET 10 IMMAGINI
tloss10_1=[6.8142547607421875, 6.789902687072754, 6.728642463684082, 6.743208885192871, 6.734358310699463, 6.624038219451904, 6.617398738861084, 6.977959632873535, 6.32152795791626, 6.373047351837158, 6.254117012023926, 6.327851295471191, 6.324060916900635, 6.260392189025879, 6.2245893478393555, 6.196759223937988, 6.253672122955322, 6.26923942565918, 6.274527072906494, 6.2579426765441895]
tacc10_1=[0.6, 0.6, 0.6, 0.6, 0.7, 0.7, 0.7, 0.6, 0.7, 0.7, 0.7, 0.6, 0.6, 0.6, 0.6, 0.7, 0.6, 0.6, 0.7, 0.6]
tloss10_2=[6.391053676605225, 6.394055366516113, 6.353065490722656, 6.392867088317871, 6.356993675231934, 6.241053581237793, 6.2013044357299805, 6.215433597564697, 6.262753486633301, 6.261359214782715, 6.290791988372803, 6.172033309936523, 6.1631879806518555, 6.213940620422363, 6.165519714355469, 6.133413314819336, 6.0668044090271, 6.074843883514404, 6.059952735900879, 6.067716121673584]
tacc10_2=[0.7, 0.7, 0.7, 0.7, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.9]
tloss10_3=[6.374355316162109, 6.368195056915283, 6.201268196105957, 6.139915466308594, 6.002058982849121, 5.972179412841797, 5.926621437072754, 5.944464683532715, 5.917059898376465, 5.827363014221191, 5.827155590057373, 5.881673812866211, 5.885056018829346, 5.900416374206543, 5.868422031402588, 5.883095741271973, 5.954153060913086, 5.967778205871582, 5.989104747772217, 5.987933158874512]
tacc10_3=[0.6, 0.6, 0.9, 0.7, 0.8, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.8, 0.8, 0.8]
tloss10_4=[6.289947032928467, 6.28501033782959, 6.298892974853516, 6.235414028167725, 6.258265018463135, 6.210960865020752, 6.215461254119873, 6.291642665863037, 6.2978434562683105, 6.211429119110107, 6.208388805389404, 6.203706741333008, 6.177968978881836, 6.145756244659424, 6.228708744049072, 6.209770679473877, 6.243544578552246, 6.254514217376709, 6.265585899353027, 6.25558614730835]
tacc10_4= [0.7, 0.7, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.7, 0.7, 0.8, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
tloss10_5=[6.606367111206055, 6.598066806793213, 6.589146614074707, 6.675910472869873, 6.617354869842529, 6.599506378173828, 6.572717666625977, 6.56874942779541, 6.5844645500183105, 6.484780788421631, 6.426987171173096, 6.495993614196777, 6.427447319030762, 6.4690680503845215, 6.482689380645752, 6.450521469116211, 6.484627723693848, 6.333127498626709, 6.267443656921387, 6.179350852966309]
tacc10_5=[0.6, 0.6, 0.7, 0.7, 0.9, 0.8, 0.9, 0.9, 0.8, 0.8, 0.8, 0.7, 0.8, 0.8, 0.7, 0.7, 0.7, 0.8, 0.9, 0.9]

train_acc10_fin=[0.7,0.9,0.9, 0.9,0.9]
test_acc10_fin=[0.6571428571428571,0.7071428571428572,0.7357142857142858,0.75,0.6285714285714286]

loss10_list=np.array([tloss10_1,tloss10_2,tloss10_3,tloss10_4,tloss10_5])
tracc10_list=np.array([tacc10_1,tacc10_2,tacc10_3,tacc10_4,tacc10_5])
#plot_loss(loss10_list,10)
#plot_accuracy(tracc10_list,10)
#plt.show()

datatrain10 =  {
    'Missed images': (48, 41, 37, 35, 52),
    'Missed 0': (35, 36, 32, 23, 40),
    'Missed 1': (13, 5, 5, 12, 12),
}

#histo_miss(datatrain6,6)
#histo_miss(datatrain10, 10)
#histo_miss(datatrain20, 20)
#histo_miss(datatrain50,50)


'''Precision, recall, f_score, support: (array([1.   , 0.625]), array([0.4, 1. ]), array([0.57142857, 0.76923077]), array([5, 5]))
Precision, recall, f_score, support: (array([0.72916667, 0.61956522]), array([0.5       , 0.81428571]), array([0.59322034, 0.7037037 ]), array([70, 70]))

Precision, recall, f_score, support: (array([1.        , 0.83333333]), array([0.8, 1. ]), array([0.88888889, 0.90909091]), array([5, 5]))
Precision, recall, f_score, support: (array([0.87179487, 0.64356436]), array([0.48571429, 0.92857143]), array([0.62385321, 0.76023392]), array([70, 70]))

Precision, recall, f_score, support: (array([1.        , 0.83333333]), array([0.8, 1. ]), array([0.88888889, 0.90909091]), array([5, 5]))
Precision, recall, f_score, support: (array([0.88372093, 0.67010309]), array([0.54285714, 0.92857143]), array([0.67256637, 0.77844311]), array([70, 70]))

Precision, recall, f_score, support: (array([1.        , 0.83333333]), array([0.8, 1. ]), array([0.88888889, 0.90909091]), array([5, 5]))
Precision, recall, f_score, support: (array([0.79661017, 0.71604938]), array([0.67142857, 0.82857143]), array([0.72868217, 0.76821192]), array([70, 70]))

Precision, recall, f_score, support: (array([1.        , 0.83333333]), array([0.8, 1. ]), array([0.88888889, 0.90909091]), array([5, 5]))
Precision, recall, f_score, support: (array([0.71428571, 0.59183673]), array([0.42857143, 0.82857143]), array([0.53571429, 0.69047619]), array([70, 70]))'''


#### DATASET 30 IMMAGINI:

tloss30_1=[21.572175979614258, 21.61795997619629, 21.51020622253418, 21.054731369018555, 20.666933059692383, 20.57199478149414, 20.337011337280273, 20.213411331176758, 20.107685089111328, 20.087833404541016, 20.00859260559082, 20.070980072021484, 19.977598190307617, 19.946823120117188, 19.8712100982666, 19.750202178955078, 19.679794311523438, 19.684833526611328, 19.683469772338867, 19.73012351989746]
tacc30_1=[0.36666666666666664, 0.36666666666666664, 0.3, 0.6, 0.6, 0.5333333333333333, 0.5666666666666667, 0.5666666666666667, 0.6, 0.5333333333333333, 0.6, 0.6, 0.5666666666666667, 0.5333333333333333, 0.5666666666666667, 0.5, 0.5333333333333333, 0.5333333333333333, 0.5666666666666667, 0.5666666666666667]
tloss30_2=[20.086162567138672, 20.135465621948242, 20.12081527709961, 20.074020385742188, 20.105825424194336, 20.179197311401367, 20.32480239868164, 20.225120544433594, 20.198558807373047, 20.192148208618164, 20.113170623779297, 20.02499008178711, 19.88791275024414, 19.897937774658203, 19.71583366394043, 19.839330673217773, 19.950481414794922, 19.89369773864746, 19.8667049407959, 19.935848236083984]
tacc30_2=[0.7333333333333333, 0.7333333333333333, 0.6666666666666666, 0.6666666666666666, 0.7333333333333333, 0.7333333333333333, 0.6666666666666666, 0.7, 0.7333333333333333, 0.7, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]
tloss30_3=[19.3826961517334, 19.402517318725586, 19.40447235107422, 19.053890228271484, 18.946975708007812, 18.79694366455078, 18.772003173828125, 18.736589431762695, 18.879365921020508, 18.85917854309082, 18.820552825927734, 18.714656829833984, 18.71229362487793, 18.701671600341797, 18.69846534729004, 18.700124740600586, 18.62845230102539, 18.612802505493164, 18.65262222290039, 18.526689529418945]
tacc30_3=[0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7333333333333333, 0.7, 0.7, 0.7333333333333333, 0.7, 0.6666666666666666, 0.7, 0.6666666666666666, 0.7333333333333333, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
tloss30_4=[19.538789749145508, 19.517101287841797, 19.250822067260742, 19.21552085876465, 19.31927490234375, 19.47792625427246, 19.418460845947266, 19.472030639648438, 19.421710968017578, 19.028305053710938, 19.021682739257812, 18.994388580322266, 18.97610855102539, 18.97800636291504, 18.87395477294922, 18.922136306762695, 18.90415382385254, 19.048418045043945, 18.990846633911133, 19.23862075805664]
tacc30_4= [0.5666666666666667, 0.5666666666666667, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.7, 0.7666666666666667, 0.8, 0.8333333333333334, 0.8, 0.8, 0.8333333333333334, 0.8666666666666667, 0.8666666666666667, 0.7666666666666667, 0.7666666666666667, 0.8]
tloss30_5=[19.736574172973633, 19.725828170776367, 19.656803131103516, 19.491729736328125, 19.529462814331055, 19.397668838500977, 19.438631057739258, 19.54214096069336, 19.45700454711914, 19.417226791381836, 19.311630249023438, 19.377147674560547, 19.397048950195312, 19.35727310180664, 19.43360710144043, 19.614147186279297, 19.592451095581055, 20.75160789489746, 20.761537551879883, 20.61995506286621]
tacc30_5=[0.6666666666666666, 0.6666666666666666, 0.6333333333333333, 0.6, 0.6333333333333333, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6333333333333333, 0.6333333333333333, 0.6666666666666666, 0.7, 0.6666666666666666, 0.6333333333333333, 0.5666666666666667, 0.6, 0.4, 0.5666666666666667, 0.4666666666666667]
train_acc30_fin=[0.6, 0.7333333333333333, 0.7, 0.7666666666666667,0.5666666666666667]
test_acc30_fin=[0.6214285714285714,0.7071428571428572,0.6714285714285714, 0.6714285714285714,0.7]

loss30=np.array([tloss30_1,tloss30_2,tloss30_3,tloss30_4,tloss30_5])
tracc30=np.array([tacc30_1,tacc30_2,tacc30_3,tacc30_4,tacc30_5])

#plot_loss(loss30,30)
#plot_accuracy(tracc30,30)
#plt.show()
"""
Precision, recall, f_score, support: (array([0.71428571, 0.56521739]), array([0.33333333, 0.86666667]), array([0.45454545, 0.68421053]), array([15, 15]))
Precision, recall, f_score, support: (array([0.68085106, 0.59139785]), array([0.45714286, 0.78571429]), array([0.54700855, 0.67484663]), array([70, 70]))

Precision, recall, f_score, support: (array([0.81818182, 0.68421053]), array([0.6       , 0.86666667]), array([0.69230769, 0.76470588]), array([15, 15]))
Precision, recall, f_score, support: (array([0.77358491, 0.66666667]), array([0.58571429, 0.82857143]), array([0.66666667, 0.7388535 ]), array([70, 70]))

Precision, recall, f_score, support: (array([0.75      , 0.66666667]), array([0.6, 0.8]), array([0.66666667, 0.72727273]), array([15, 15]))
Precision, recall, f_score, support: (array([0.72222222, 0.63953488]), array([0.55714286, 0.78571429]), array([0.62903226, 0.70512821]), array([70, 70]))

Precision, recall, f_score, support: (array([0.83333333, 0.72222222]), array([0.66666667, 0.86666667]), array([0.74074074, 0.78787879]), array([15, 15]))
Precision, recall, f_score, support: (array([0.77272727, 0.625     ]), array([0.48571429, 0.85714286]), array([0.59649123, 0.72289157]), array([70, 70]))

Precision, recall, f_score, support: (array([0.57142857, 0.5625    ]), array([0.53333333, 0.6       ]), array([0.55172414, 0.58064516]), array([15, 15]))
Precision, recall, f_score, support: (array([0.72580645, 0.67948718]), array([0.64285714, 0.75714286]), array([0.68181818, 0.71621622]), array([70, 70]))
"""


#### 100 TRAINING DATA

tloss100_1=[72.15888977050781, 72.10675048828125, 71.04960632324219, 69.09342956542969, 68.35132598876953, 67.94574737548828, 67.5982894897461, 67.24566650390625, 67.32418060302734, 67.28966522216797, 66.17711639404297, 66.16775512695312, 66.32952880859375, 66.0374755859375, 65.77799224853516, 65.82809448242188, 65.83281707763672, 65.91088104248047, 65.81128692626953, 65.92400360107422]
tacc100_1=[0.36, 0.36, 0.46, 0.52, 0.55, 0.56, 0.55, 0.56, 0.57, 0.57, 0.62, 0.63, 0.61, 0.67, 0.63, 0.66, 0.63, 0.69, 0.66, 0.68]
tloss100_2=[64.78639221191406, 64.865234375, 64.86180877685547, 64.96746826171875, 64.90982055664062, 64.85820770263672, 64.87013244628906, 64.7745590209961, 64.63240814208984, 64.75502014160156, 64.50788116455078, 64.37081146240234, 63.9744873046875, 64.17280578613281, 64.22980499267578, 64.13247680664062, 63.926998138427734, 64.0177993774414, 63.91668701171875, 65.1005859375]
tacc100_2=[0.77, 0.79, 0.78, 0.74, 0.73, 0.68, 0.71, 0.72, 0.7, 0.68, 0.71, 0.71, 0.74, 0.77, 0.78, 0.74, 0.79, 0.75, 0.74, 0.65]
tloss100_3=[65.51471710205078, 65.50372314453125, 65.34381866455078, 65.167724609375, 65.12570190429688, 64.9696044921875, 64.9288558959961, 64.9365234375, 64.93379211425781, 64.99919891357422, 65.05209350585938, 65.03680419921875, 64.8744888305664, 64.71533966064453, 64.60507202148438, 64.675048828125, 64.72506713867188, 64.71720886230469, 64.71342468261719, 71.17919921875]
tacc100_3= [0.64, 0.64, 0.63, 0.6, 0.63, 0.64, 0.66, 0.67, 0.68, 0.67, 0.7, 0.71, 0.73, 0.67, 0.72, 0.67, 0.69, 0.7, 0.71, 0.35]
tloss100_4=[66.9737777709961, 66.95314025878906, 66.58028411865234, 65.90819549560547, 65.92178344726562, 65.65557098388672, 65.50719451904297, 65.21109771728516, 65.28195190429688, 65.08211517333984, 65.16815185546875, 65.05475616455078, 64.9303207397461, 65.00151062011719, 64.95211791992188, 65.05164337158203, 64.70687103271484, 64.36555480957031, 64.332763671875, 64.41704559326172]
tacc100_4= [0.65, 0.67, 0.69, 0.71, 0.74, 0.71, 0.72, 0.68, 0.71, 0.69, 0.7, 0.7, 0.69, 0.69, 0.68, 0.67, 0.69, 0.71, 0.74, 0.73]
tloss100_5=[65.0936279296875, 64.99604797363281, 64.62955474853516, 64.3887710571289, 64.37269592285156, 64.22077178955078, 64.54560852050781, 64.70335388183594, 64.78071594238281, 64.55198669433594, 64.50309753417969, 64.43887329101562, 64.35855102539062, 64.46935272216797, 64.54788970947266, 64.44757080078125, 64.56961059570312, 64.32359313964844, 64.27594757080078, 64.25360107421875]
tacc100_5=[0.67, 0.65, 0.67, 0.71, 0.69, 0.68, 0.66, 0.67, 0.69, 0.73, 0.7, 0.7, 0.7, 0.71, 0.72, 0.72, 0.69, 0.73, 0.72, 0.72]
train_acc100_fin=[0.67, 0.64, 0.56, 0.7, 0.71]
test_acc100_fin=[0.6285714285714286,0.7357142857142858,0.5714285714285714, 0.7285714285714285,0.6785714285714286]

loss100=np.array([tloss100_1,tloss100_2,tloss100_3,tloss100_4,tloss100_5])
tracc100=np.array([tacc100_1,tacc100_2,tacc100_3,tacc100_4,tacc100_5])

missed100= [52, 37, 60, 38, 45]
missed0_100= [44, 31, 39, 35, 39]
missed1_100= [8, 6, 21, 3, 6]

#plot_loss(loss100,100)
#plot_accuracy(tracc100,100)
#plt.show()
"""
Precision, recall, f_score, support: (array([0.72972973, 0.63492063]), array([0.54, 0.8 ]), array([0.62068966, 0.7079646 ]), array([50, 50]))
Precision, recall, f_score, support: (array([0.76470588, 0.58490566]), array([0.37142857, 0.88571429]), array([0.5       , 0.70454545]), array([70, 70]))

Precision, recall, f_score, support: (array([0.85  , 0.5875]), array([0.34, 0.94]), array([0.48571429, 0.72307692]), array([50, 50]))
Precision, recall, f_score, support: (array([0.86666667, 0.67368421]), array([0.55714286, 0.91428571]), array([0.67826087, 0.77575758]), array([70, 70]))

Precision, recall, f_score, support: (array([0.58333333, 0.546875  ]), array([0.42, 0.7 ]), array([0.48837209, 0.61403509]), array([50, 50]))
Precision, recall, f_score, support: (array([0.59615385, 0.55681818]), array([0.44285714, 0.7       ]), array([0.50819672, 0.62025316]), array([70, 70]))

Precision, recall, f_score, support: (array([0.79411765, 0.65151515]), array([0.54, 0.86]), array([0.64285714, 0.74137931]), array([50, 50]))
Precision, recall, f_score, support: (array([0.92105263, 0.65686275]), array([0.5       , 0.95714286]), array([0.64814815, 0.77906977]), array([70, 70]))

Precision, recall, f_score, support: (array([0.83870968, 0.65217391]), array([0.52, 0.9 ]), array([0.64197531, 0.75630252]), array([50, 50]))
Precision, recall, f_score, support: (array([0.83783784, 0.62135922]), array([0.44285714, 0.91428571]), array([0.57943925, 0.73988439]), array([70, 70]))
"""
train_acc40_fin=[0.725,0.375, 0.7,0.825,0.725]
test_acc40_fin = [0.6857142857142857, 0.45714285714285713,0.75, 0.6714285714285714,0.6357142857142857]

#### plotto il grafico finale
training_sets = np.array([6,10,20,30,40,50])

train_accf = np.array([tr_acc_fin_6, train_acc10_fin, tracc20_fin, train_acc30_fin, train_acc40_fin, traccuracy_fin])
test_accf = np.array([test_acc_fin6,test_acc10_fin,testacc20_fin,test_acc30_fin,test_acc40_fin,testacc_fin])


av_train = [np.mean(sublist) for sublist in train_accf]
std_train = [np.std(sublist) for sublist in train_accf]
av_test = [np.mean(sublist) for sublist in test_accf]
std_test = [np.std(sublist) for sublist in test_accf]



print("Train acc averaged WFWF3:", av_train)
print("Std train acc WFWF3:", std_train)
print("Test acc averaged WFWF3:", av_test)
print("Std test acc WFWF3:", std_test)
xval = np.array([6,10,20,30,40,50,100])
x = np.array(training_sets)
#fig = plt.figure(figsize=(8,5))
y_70 = 0.7*np.ones(len(x))

plt.errorbar(x, av_train,yerr=std_train,marker='o',markerfacecolor='none', markeredgecolor='tab:blue', markersize=9,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='tab:blue', ls=':')
plt.errorbar(x, av_test, yerr=std_test,marker='s',markerfacecolor='none', markeredgecolor='tab:orange',markersize=9,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='tab:orange', ls=':')
#plt.plot(x, av_train, color='   blue')
#plt.plot(x, av_test, color='tab:orange')
#plt.fill_between(x, np.subtract(av_train, std_train), np.add(av_train, std_train), alpha=0.3, label='Standard Deviation Train', color='tab:blue')
#plt.fill_between(x, np.subtract(av_test, std_test), np.add(av_test, std_test), alpha=0.3, label='Standard Deviation Test', color='tab:orange')
#plt.plot(x, y_70, '--', linewidth=2.2,label='70 perc. accuracy', color='purple')
plt.title("WFWF3",fontsize = 12, fontweight='semibold')
plt.xlabel('Training set', fontsize = 12, fontweight='semibold')
plt.ylabel('Value',fontsize = 12, fontweight='semibold')
plt.legend(loc=4, prop={'size': 16})
plt.xticks(training_sets, fontsize = 12, fontweight='semibold')
yticks = np.linspace(0,1,11)    #
plt.yticks(yticks)
plt.savefig('/Users/francescoaldoventurelli/Desktop/WF_FM_WF_ANS3L.jpg', dpi=800)
plt.show()



#### 6 images of trainig with architecture == QCNN

tloss6_qcnn_1=[4.042214870452881, 3.9948127269744873, 4.112090587615967, 4.0342698097229, 4.032534599304199, 4.038477897644043, 3.9400525093078613, 3.9249978065490723, 3.765562057495117, 3.7789289951324463, 3.850475788116455, 3.8138394355773926, 3.84753155708313, 3.801154613494873, 3.873626470565796, 3.8555829524993896, 3.821687936782837, 3.861621856689453, 3.8638460636138916, 3.758345603942871]
tacc6_qcnn_1=[0.5, 0.5, 0.5, 0.6666666666666666, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]
tloss6_qcnn_2=[3.952878952026367, 4.032651901245117, 3.959677219390869, 4.010234832763672, 3.914900541305542, 3.9155125617980957, 3.8540775775909424, 3.836956024169922, 3.889089822769165, 3.900164842605591, 3.880059003829956, 3.8531179428100586, 3.864809513092041, 3.8033101558685303, 3.790365695953369, 3.8225631713867188, 3.8001651763916016, 3.792232036590576, 3.793351888656616, 3.813400983810425]
tacc6_qcnn_2=[0.8333333333333334, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
tloss6_qcnn_3=[3.9015159606933594, 3.9008162021636963, 3.8366446495056152, 3.736858367919922, 3.7926015853881836, 3.791663885116577, 3.7522871494293213, 3.7027106285095215, 3.731989860534668, 3.6969547271728516, 3.6355133056640625, 3.620588779449463, 3.636197090148926, 3.635897636413574, 3.6263134479522705, 3.6375198364257812, 3.6286420822143555, 3.7479665279388428, 3.7369401454925537, 3.729753017425537]
tacc6_qcnn_3= [0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 0.8333333333333334, 0.8333333333333334]
tloss6_qcnn_4=[3.7982916831970215, 3.801403284072876, 3.785928726196289, 3.867990493774414, 3.9661309719085693, 3.962670087814331, 3.9818875789642334, 3.9957454204559326, 3.929060220718384, 3.861799478530884, 3.8724939823150635, 3.8913087844848633, 3.7923853397369385, 3.7830257415771484, 3.7790534496307373, 3.763153076171875, 3.775212287902832, 3.719419479370117, 3.770914077758789, 3.7499704360961914]
tacc6_qcnn_4= [1.0, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6666666666666666, 0.5, 0.6666666666666666, 0.5, 0.6666666666666666, 0.5, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]
tloss6_qcnn_5=[4.162007808685303, 4.096374034881592, 4.131142616271973, 3.9732086658477783, 3.950390577316284, 3.885859727859497, 3.8801486492156982, 3.832423210144043, 3.8394060134887695, 3.942899465560913, 3.9334664344787598, 3.9075164794921875, 3.8802073001861572, 3.8822689056396484, 3.847172260284424, 3.785616397857666, 3.767443895339966, 3.753307819366455, 3.7267799377441406, 3.696713924407959]
tacc6_qcnn_5=[0.5, 0.5, 0.3333333333333333, 0.5, 0.8333333333333334, 0.5, 0.5, 0.6666666666666666, 0.8333333333333334, 0.6666666666666666, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.8333333333333334, 1.0, 0.8333333333333334]
train_acc6_fin_qcnn=[0.8333333333333334, 1.0, 1.0, 0.6666666666666666,  1.0]
test_acc6_fin_qcnn=[0.7785714285714286,0.6857142857142857,0.6857142857142857, 0.75,0.7214285714285714]

loss6qcnn=np.array([tloss6_qcnn_1,tloss6_qcnn_2,tloss6_qcnn_3,tloss6_qcnn_4,tloss6_qcnn_5])
tracc6qcnn=np.array([tacc6_qcnn_1,tacc6_qcnn_2,tacc6_qcnn_3,tacc6_qcnn_4,tacc6_qcnn_5])

missed_QCNN_6 = [31, 44, 44, 35, 39]
missed0_QCNN_6 = [30, 31, 33, 34, 32]
missed1_QCNN_6= [1, 13, 11, 1, 7]
plt.figure()
x_arr = np.arange(1,21,1)
train_loss_qcnn_av6 = np.mean(loss6qcnn, axis=0)
train_loss_qcnn_std6 = np.std(loss6qcnn, axis=0)
train_acc_qcnn_av6 = np.mean(tracc6qcnn, axis=0)
train_acc_qcnn_std6 = np.std(tracc6qcnn, axis=0)


'''plt.plot(x_arr, train_loss_qcnn_av6, marker='o', color='blue')
plt.fill_between(x_arr, np.subtract(train_loss_qcnn_av6, train_loss_qcnn_std6), np.add(train_loss_qcnn_av6,train_loss_qcnn_std6), alpha=0.3, color='blue')
plt.xlabel('Epochs')
plt.ylabel('Value')
plt.title('Train loss QCNN model 6 train images')
#plot_loss(loss6qcnn,6)
#plot_accuracy(tracc6qcnn,6)
plt.xticks(x_arr)
plt.savefig('/Users/francescoaldoventurelli/Desktop/AV_LOSS_QCNN.jpg',dpi=300)
plt.show()


plt.plot(x_arr, train_acc_qcnn_av6, marker='o', color='orange')
plt.fill_between(x_arr, np.subtract(train_acc_qcnn_av6, train_acc_qcnn_std6), np.add(train_acc_qcnn_av6,train_acc_qcnn_std6), alpha=0.3, color='orange')
plt.title('Train accuracy QCNN model 6 train images')
plt.xlabel('Epochs')
plt.ylabel('Value')
plt.xticks(x_arr)
plt.savefig('/Users/francescoaldoventurelli/Desktop/AV_ACC_QCNN.jpg',dpi=300)
plt.show()'''
"""

Precision, recall, f_score, support: (array([1.  , 0.75]), array([0.66666667, 1.        ]), array([0.8       , 0.85714286]), array([3, 3]))
Precision, recall, f_score, support: (array([0.97560976, 0.6969697 ]), array([0.57142857, 0.98571429]), array([0.72072072, 0.81656805]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.75      , 0.64772727]), array([0.55714286, 0.81428571]), array([0.63934426, 0.72151899]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.77083333, 0.64130435]), array([0.52857143, 0.84285714]), array([0.62711864, 0.72839506]), array([70, 70]))

Precision, recall, f_score, support: (array([1. , 0.6]), array([0.33333333, 1.        ]), array([0.5 , 0.75]), array([3, 3]))
Precision, recall, f_score, support: (array([0.97297297, 0.66990291]), array([0.51428571, 0.98571429]), array([0.6728972 , 0.79768786]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.84444444, 0.66315789]), array([0.54285714, 0.9       ]), array([0.66086957, 0.76363636]), array([70, 70]))

"""


#### Train images = 10 : architecture QCNN

tloss10_qcnn_1=[6.773342132568359, 6.676552772521973, 6.427356719970703, 6.508708953857422, 6.399574279785156, 6.49363374710083, 6.451951503753662, 6.455708980560303, 6.4538893699646, 6.938406467437744, 6.76746129989624, 6.672597408294678, 6.663209915161133, 6.608878135681152, 6.573071479797363, 6.6270880699157715, 6.584977626800537, 6.583030700683594, 6.6639533042907715, 6.593113899230957]
tacc10_qcnn_1=[0.5, 0.6, 0.9, 0.7, 0.8, 0.9, 0.8, 0.7, 0.8, 0.5, 0.7, 0.8, 0.8, 0.8, 0.9, 0.6, 0.7, 0.6, 0.6, 0.8]
tloss10_qcnn_2=[6.892938613891602, 6.833773136138916, 6.715901851654053, 6.667442798614502, 6.699986934661865, 6.755253314971924, 6.7634968757629395, 6.669595718383789, 6.689604759216309, 6.618103981018066, 6.658431529998779, 6.684212684631348, 6.702276229858398, 6.654304504394531, 6.677710056304932, 6.709716796875, 6.644127368927002, 6.548643112182617, 6.537023067474365, 6.492095470428467]
tacc10_qcnn_2=[0.6, 0.6, 0.6, 0.7, 0.6, 0.6, 0.6, 0.7, 0.8, 0.8, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.8, 0.9, 0.9]
tloss10_qcnn_3=[6.761322975158691, 6.754959583282471, 6.629297256469727, 6.641659259796143, 6.607110500335693, 6.457187652587891, 6.4771342277526855, 6.42119026184082, 6.413745403289795, 6.438899517059326, 6.421210765838623, 6.412404537200928, 6.452489852905273, 6.538219928741455, 6.476103782653809, 6.556463718414307, 6.5201640129089355, 6.316155433654785, 6.380415916442871, 6.141327381134033]
tacc10_qcnn_3= [0.5, 0.5, 0.6, 0.6, 0.6, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.6, 0.8, 1.0, 0.8, 1.0, 1.0, 0.9, 0.9]
tloss10_qcnn_4=[6.785621166229248, 6.749343395233154, 6.659485816955566, 6.724875450134277, 6.526501178741455, 6.449559211730957, 6.519015312194824, 6.557450771331787, 6.393701553344727, 6.378943920135498, 6.392818450927734, 6.428228855133057, 6.214521408081055, 6.253888130187988, 6.3118181228637695, 6.237011909484863, 6.328213214874268, 6.395400047302246, 6.409761905670166, 6.363459587097168]
tacc10_qcnn_4=  [0.7, 0.6, 0.8, 0.5, 0.8, 0.8, 0.7, 0.7, 0.7, 0.8, 0.8, 0.8, 0.9, 0.9, 0.9, 0.9, 0.9, 0.8, 0.8, 0.8]
tloss10_qcnn_5=[6.718592166900635, 6.684658527374268, 6.381843090057373, 6.372316360473633, 6.401002883911133, 6.3142900466918945, 6.364535331726074, 6.300785541534424, 6.404964923858643, 6.382437229156494, 6.352896690368652, 6.300513744354248, 6.820201873779297, 6.774567604064941, 6.731194972991943, 6.7456231117248535, 6.695099830627441, 6.7431769371032715, 6.758141994476318, 6.746994495391846]
tacc10_qcnn_5=[0.5, 0.5, 0.7, 0.8, 0.8, 0.9, 0.9, 0.8, 0.8, 0.8, 0.8, 0.9, 0.7, 0.6, 0.7, 0.7, 0.8, 0.7, 0.7, 0.8]
train_acc10_fin_qcnn=[0.6, 0.8, 0.9, 0.8, 0.7]
test_acc10_fin_qcnn=[0.5857142857142857,0.7285714285714285,0.6071428571428571, 0.6642857142857143,0.6857142857142857]

loss10qcnn=np.array([tloss10_qcnn_1,tloss10_qcnn_2,tloss10_qcnn_3,tloss10_qcnn_4,tloss10_qcnn_5])
tracc10qcnn=np.array([tacc10_qcnn_1,tacc10_qcnn_2,tacc10_qcnn_3,tacc10_qcnn_4,tacc10_qcnn_5])

missed_QCNN_10 = [58, 38, 55, 47, 44]
missed0_QCNN_10 = [37, 25, 29, 39, 28]
missed1_QCNN_10= [21, 13, 26, 8, 16]
#plot_loss(loss10qcnn,10)
#plot_accuracy(tracc10qcnn,10)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.6, 0.6]), array([0.6, 0.6]), array([0.6, 0.6]), array([5, 5]))
Precision, recall, f_score, support: (array([0.61111111, 0.56976744]), array([0.47142857, 0.7       ]), array([0.53225806, 0.62820513]), array([70, 70]))

Precision, recall, f_score, support: (array([0.8, 0.8]), array([0.8, 0.8]), array([0.8, 0.8]), array([5, 5]))
Precision, recall, f_score, support: (array([0.77586207, 0.69512195]), array([0.64285714, 0.81428571]), array([0.703125, 0.75    ]), array([70, 70]))

Precision, recall, f_score, support: (array([1.        , 0.83333333]), array([0.8, 1. ]), array([0.88888889, 0.90909091]), array([5, 5]))
Precision, recall, f_score, support: (array([0.6119403 , 0.60273973]), array([0.58571429, 0.62857143]), array([0.59854015, 0.61538462]), array([70, 70]))

Precision, recall, f_score, support: (array([0.8, 0.8]), array([0.8, 0.8]), array([0.8, 0.8]), array([5, 5]))
Precision, recall, f_score, support: (array([0.79487179, 0.61386139]), array([0.44285714, 0.88571429]), array([0.56880734, 0.7251462 ]), array([70, 70]))

Precision, recall, f_score, support: (array([0.66666667, 0.75      ]), array([0.8, 0.6]), array([0.72727273, 0.66666667]), array([5, 5]))
Precision, recall, f_score, support: (array([0.72413793, 0.65853659]), array([0.6       , 0.77142857]), array([0.65625   , 0.71052632]), array([70, 70]))
"""



#### Train images = 20 : architecture QCNN

tloss20_qcnn_1=[13.562616348266602, 13.536518096923828, 13.428543090820312, 13.73205280303955, 13.549699783325195, 13.553696632385254, 13.110504150390625, 12.873222351074219, 12.87153148651123, 12.77218246459961, 12.712152481079102, 12.766656875610352, 12.952696800231934, 12.81710433959961, 12.764965057373047, 12.691803932189941, 12.704834938049316, 12.562355041503906, 12.566366195678711, 12.431817054748535]
tacc20_qcnn_1=[0.6, 0.6, 0.65, 0.6, 0.8, 0.65, 0.8, 0.85, 0.75, 0.8, 0.85, 0.8, 0.7, 0.75, 0.8, 0.8, 0.85, 0.85, 0.85, 0.85]
tloss20_qcnn_2=[12.821955680847168, 12.831302642822266, 12.70044994354248, 12.773614883422852, 12.765425682067871, 12.763099670410156, 14.07281494140625, 14.12497615814209, 14.176862716674805, 13.991994857788086, 13.88899040222168, 13.813462257385254, 13.509078979492188, 13.503182411193848, 13.4807710647583, 13.437192916870117, 13.432415008544922, 13.470094680786133, 13.522377014160156, 13.53140926361084]
tacc20_qcnn_2=[0.75, 0.75, 0.75, 0.7, 0.8, 0.7, 0.25, 0.3, 0.4, 0.55, 0.5, 0.55, 0.75, 0.7, 0.65, 0.7, 0.7, 0.7, 0.8, 0.6]
tloss20_qcnn_3=[13.691386222839355, 13.669413566589355, 13.531349182128906, 13.511688232421875, 13.601783752441406, 13.529966354370117, 13.457687377929688, 13.660938262939453, 13.622844696044922, 13.583784103393555, 13.515464782714844, 13.470754623413086, 13.454446792602539, 13.587556838989258, 13.669978141784668, 13.578404426574707, 13.577463150024414, 13.545133590698242, 13.547831535339355, 13.583545684814453]
tacc20_qcnn_3= [0.7, 0.65, 0.7, 0.7, 0.65, 0.65, 0.7, 0.7, 0.7, 0.75, 0.7, 0.75, 0.75, 0.75, 0.55, 0.75, 0.65, 0.6, 0.65, 0.65]
tloss20_qcnn_4= [14.035911560058594, 14.013374328613281, 13.970142364501953, 13.803689002990723, 13.495453834533691, 13.407896041870117, 13.54670524597168, 13.431689262390137, 13.361214637756348, 13.27829647064209, 13.11384105682373, 13.160209655761719, 13.261151313781738, 13.508376121520996, 13.451369285583496, 13.370075225830078, 13.262931823730469, 13.186920166015625, 13.039239883422852, 13.323034286499023]
tacc20_qcnn_4=  [0.45, 0.4, 0.45, 0.65, 0.7, 0.75, 0.65, 0.7, 0.75, 0.65, 0.8, 0.8, 0.75, 0.65, 0.7, 0.75, 0.75, 0.9, 0.95, 0.75]
tloss20_qcnn_5=[13.865961074829102, 13.932550430297852, 13.788993835449219, 13.679118156433105, 13.526078224182129, 13.530937194824219, 13.483967781066895, 13.58787727355957, 13.279032707214355, 13.317822456359863, 13.204609870910645, 13.287775039672852, 13.277520179748535, 13.260187149047852, 13.336271286010742, 13.375388145446777, 13.405328750610352, 13.345724105834961, 13.299919128417969, 13.280852317810059]
tacc20_qcnn_5=[0.5, 0.5, 0.5, 0.5, 0.65, 0.65, 0.65, 0.7, 0.7, 0.7, 0.7, 0.65, 0.65, 0.7, 0.65, 0.7, 0.65, 0.75, 0.7, 0.7]
train_acc20_fin_qcnn=[0.9, 0.65, 0.7, 0.85, 0.7]
test_acc20_fin_qcnn=[0.7571428571428571,0.6214285714285714,0.6071428571428571,  0.6642857142857143,0.6142857142857143]

loss20qcnn=np.array([tloss20_qcnn_1,tloss20_qcnn_2,tloss20_qcnn_3,tloss20_qcnn_4,tloss20_qcnn_5])
tracc20qcnn=np.array([tacc20_qcnn_1,tacc20_qcnn_2,tacc20_qcnn_3,tacc20_qcnn_4,tacc20_qcnn_5])

missed_QCNN_20 = [34, 53, 55, 47, 54]
missed0_QCNN_20 = [30, 31, 32, 36, 41]
missed1_QCNN_20= [4, 22, 23, 11, 13]
#plot_loss(loss20qcnn,20)
#plot_accuracy(tracc20qcnn,20)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.9, 0.9]), array([0.9, 0.9]), array([0.9, 0.9]), array([10, 10]))
Precision, recall, f_score, support: (array([0.90909091, 0.6875    ]), array([0.57142857, 0.94285714]), array([0.70175439, 0.79518072]), array([70, 70]))

Precision, recall, f_score, support: (array([0.66666667, 0.63636364]), array([0.6, 0.7]), array([0.63157895, 0.66666667]), array([10, 10]))
Precision, recall, f_score, support: (array([0.63934426, 0.60759494]), array([0.55714286, 0.68571429]), array([0.59541985, 0.6442953 ]), array([70, 70]))

Precision, recall, f_score, support: (array([0.7, 0.7]), array([0.7, 0.7]), array([0.7, 0.7]), array([10, 10]))
Precision, recall, f_score, support: (array([0.62295082, 0.59493671]), array([0.54285714, 0.67142857]), array([0.58015267, 0.63087248]), array([70, 70]))

Precision, recall, f_score, support: (array([0.88888889, 0.81818182]), array([0.8, 0.9]), array([0.84210526, 0.85714286]), array([10, 10]))
Precision, recall, f_score, support: (array([0.75555556, 0.62105263]), array([0.48571429, 0.84285714]), array([0.59130435, 0.71515152]), array([70, 70]))


Precision, recall, f_score, support: (array([0.7, 0.7]), array([0.7, 0.7]), array([0.7, 0.7]), array([10, 10]))
Precision, recall, f_score, support: (array([0.69047619, 0.58163265]), array([0.41428571, 0.81428571]), array([0.51785714, 0.67857143]), array([70, 70]))


"""

#### Train images = 30 : architecture QCNN

tloss30_qcnn_1= [20.47638702392578, 20.47730255126953, 19.818593978881836, 19.703847885131836, 19.51364517211914, 19.43634033203125, 19.338891983032227, 19.114166259765625, 19.258075714111328, 19.042743682861328, 20.90755271911621, 20.548627853393555, 20.5878849029541, 20.311628341674805, 20.373302459716797, 20.331592559814453, 20.193099975585938, 20.178936004638672, 20.163227081298828, 20.324493408203125]
tacc30_qcnn_1= [0.6333333333333333, 0.5666666666666667, 0.8333333333333334, 0.8, 0.7333333333333333, 0.7666666666666667, 0.7, 0.7333333333333333, 0.7, 0.7333333333333333, 0.4, 0.5333333333333333, 0.5333333333333333, 0.7, 0.6666666666666666, 0.6666666666666666, 0.7333333333333333, 0.7333333333333333, 0.7666666666666667, 0.6]
tloss30_qcnn_2=  [20.300254821777344, 20.215795516967773, 20.200014114379883, 20.176618576049805, 20.180309295654297, 20.299211502075195, 20.404802322387695, 20.152042388916016, 20.214094161987305, 20.32819175720215, 20.266271591186523, 20.322938919067383, 20.326444625854492, 20.28494644165039, 20.284934997558594, 20.182933807373047, 20.18295669555664, 20.38688850402832, 20.523324966430664, 20.447965621948242]
tacc30_qcnn_2= [0.6333333333333333, 0.6333333333333333, 0.6, 0.5666666666666667, 0.7333333333333333, 0.5666666666666667, 0.6, 0.6333333333333333, 0.7, 0.7333333333333333, 0.7333333333333333, 0.6, 0.6666666666666666, 0.7, 0.6666666666666666, 0.7666666666666667, 0.7, 0.6, 0.5333333333333333, 0.5666666666666667]
tloss30_qcnn_3= [20.235868453979492, 20.281797409057617, 20.305696487426758, 20.191131591796875, 20.39981460571289, 20.237838745117188, 20.082876205444336, 19.850128173828125, 19.68829917907715, 19.494335174560547, 19.39948272705078, 19.418277740478516, 19.329973220825195, 19.46000862121582, 19.403648376464844, 19.36564064025879, 19.26183319091797, 19.249652862548828, 19.318872451782227, 19.286754608154297]
tacc30_qcnn_3=  [0.6, 0.6, 0.6, 0.6333333333333333, 0.5, 0.5666666666666667, 0.5666666666666667, 0.6333333333333333, 0.6666666666666666, 0.7666666666666667, 0.7666666666666667, 0.7333333333333333, 0.7666666666666667, 0.7666666666666667, 0.8, 0.8333333333333334, 0.8, 0.7666666666666667, 0.7, 0.7]
tloss30_qcnn_4= [19.816234588623047, 19.649227142333984, 19.55191421508789, 19.47804069519043, 19.601749420166016, 19.36408805847168, 19.16434097290039, 19.122140884399414, 19.034955978393555, 18.881855010986328, 19.00849151611328, 18.970012664794922, 19.008384704589844, 19.062252044677734, 19.1307373046875, 19.311450958251953, 19.26072883605957, 19.322858810424805, 19.31838607788086, 19.330331802368164]
tacc30_qcnn_4= [0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.7333333333333333, 0.6333333333333333, 0.7, 0.7333333333333333, 0.7, 0.7, 0.7333333333333333, 0.7666666666666667, 0.8, 0.7666666666666667, 0.7666666666666667, 0.7666666666666667, 0.6, 0.6333333333333333, 0.6, 0.6333333333333333, 0.6666666666666666]
tloss30_qcnn_5= [19.753747940063477, 19.670982360839844, 19.803251266479492, 19.61568260192871, 19.603633880615234, 19.580707550048828, 19.572406768798828, 19.551509857177734, 19.699764251708984, 19.592416763305664, 19.593263626098633, 19.648357391357422, 19.66176414489746, 19.571882247924805, 19.584442138671875, 19.65446662902832, 19.657821655273438, 19.711400985717773, 19.757143020629883, 19.674386978149414]
tacc30_qcnn_5= [0.7333333333333333, 0.7666666666666667, 0.7, 0.8, 0.7666666666666667, 0.7666666666666667, 0.8, 0.7333333333333333, 0.7333333333333333, 0.8, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.7666666666666667, 0.8333333333333334, 0.8, 0.8, 0.7666666666666667, 0.8333333333333334, 0.8333333333333334]

train_acc30_fin_qcnn=[0.8,0.4666666666666667, 0.7333333333333333,0.6666666666666666, 0.9333333333333333]
test_acc30_fin_qcnn=[0.6285714285714286,0.6714285714285714, 0.6285714285714286,0.5857142857142857,0.6642857142857143]

loss30qcnn=np.array([tloss30_qcnn_1,tloss30_qcnn_2,tloss30_qcnn_3,tloss30_qcnn_4,tloss30_qcnn_5])
tracc30qcnn=np.array([tacc30_qcnn_1,tacc30_qcnn_2,tacc30_qcnn_3,tacc30_qcnn_4,tacc30_qcnn_5])

missed_QCNN_30 =[52, 46, 52, 58, 47]
missed0_QCNN_30 =[25, 30, 39, 35, 38]
missed1_QCNN_30=[27, 16, 13, 23, 9]
#plot_loss(loss30qcnn,30)
#plot_accuracy(tracc30qcnn,30)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.8, 0.8]), array([0.8, 0.8]), array([0.8, 0.8]), array([15, 15]))
Precision, recall, f_score, support: (array([0.625     , 0.63235294]), array([0.64285714, 0.61428571]), array([0.63380282, 0.62318841]), array([70, 70]))

Precision, recall, f_score, support: (array([0.46153846, 0.47058824]), array([0.4       , 0.53333333]), array([0.42857143, 0.5       ]), array([15, 15]))
Precision, recall, f_score, support: (array([0.71428571, 0.64285714]), array([0.57142857, 0.77142857]), array([0.63492063, 0.7012987 ]), array([70, 70]))

Precision, recall, f_score, support: (array([0.81818182, 0.68421053]), array([0.6       , 0.86666667]), array([0.69230769, 0.76470588]), array([15, 15]))
Precision, recall, f_score, support: (array([0.70454545, 0.59375   ]), array([0.44285714, 0.81428571]), array([0.54385965, 0.68674699]), array([70, 70]))

Precision, recall, f_score, support: (array([0.69230769, 0.64705882]), array([0.6       , 0.73333333]), array([0.64285714, 0.6875    ]), array([15, 15]))
Precision, recall, f_score, support: (array([0.60344828, 0.57317073]), array([0.5       , 0.67142857]), array([0.546875  , 0.61842105]), array([70, 70]))

Precision, recall, f_score, support: (array([0.93333333, 0.93333333]), array([0.93333333, 0.93333333]), array([0.93333333, 0.93333333]), array([15, 15]))
Precision, recall, f_score, support: (array([0.7804878 , 0.61616162]), array([0.45714286, 0.87142857]), array([0.57657658, 0.72189349]), array([70, 70]))
"""

#### Train images = 40 : architecture QCNN

tloss40_qcnn_1=[27.418277740478516, 27.538286209106445, 26.58319664001465, 26.301769256591797, 26.319639205932617, 26.27719497680664, 25.977447509765625, 26.12110710144043, 26.03958511352539, 25.980499267578125, 25.79613494873047, 25.55874252319336, 25.513338088989258, 25.72012710571289, 25.752355575561523, 25.54972267150879, 25.355730056762695, 25.295255661010742, 25.379194259643555, 25.412092208862305]
tacc40_qcnn_1=[0.625, 0.525, 0.675, 0.675, 0.75, 0.75, 0.75, 0.725, 0.75, 0.775, 0.775, 0.75, 0.7, 0.7, 0.7, 0.775, 0.775, 0.8, 0.8, 0.75]
tloss40_qcnn_2=[26.092050552368164, 25.77225685119629, 25.957103729248047, 25.940044403076172, 25.711109161376953, 25.773134231567383, 26.14784049987793, 25.989208221435547, 26.047815322875977, 26.000675201416016, 25.91852378845215, 25.971895217895508, 25.701950073242188, 25.60354995727539, 25.665143966674805, 25.92626190185547, 25.90455436706543, 25.77956199645996, 25.78264617919922, 25.7308406829834]
tacc40_qcnn_2=[0.65, 0.725, 0.7, 0.7, 0.725, 0.7, 0.675, 0.7, 0.725, 0.7, 0.65, 0.725, 0.725, 0.7, 0.8, 0.7, 0.725, 0.725, 0.775, 0.75]
tloss40_qcnn_3=[25.1235294342041, 25.03809356689453, 25.001155853271484, 24.86393928527832, 24.756162643432617, 24.687814712524414, 24.751277923583984, 24.669809341430664, 24.63105010986328, 24.565078735351562, 24.66409683227539, 24.579147338867188, 24.641815185546875, 24.60307502746582, 24.54671287536621, 24.67192268371582, 24.670475006103516, 24.616275787353516, 24.59185028076172, 24.687450408935547]
tacc40_qcnn_3=[0.7, 0.75, 0.725, 0.75, 0.725, 0.75, 0.75, 0.75, 0.8, 0.85, 0.825, 0.8, 0.8, 0.8, 0.825, 0.8, 0.825, 0.8, 0.85, 0.825]
tloss40_qcnn_4= [25.612445831298828, 25.29240608215332, 25.170639038085938, 25.20167350769043, 25.269554138183594, 25.17878532409668, 25.351926803588867, 25.235279083251953, 25.218603134155273, 25.209184646606445, 25.23348045349121, 25.250873565673828, 25.145586013793945, 25.212705612182617, 25.30989646911621, 25.30902862548828, 25.380361557006836, 25.309921264648438, 25.28278160095215, 25.294599533081055]
tacc40_qcnn_4=  [0.7, 0.75, 0.775, 0.775, 0.775, 0.825, 0.775, 0.775, 0.8, 0.75, 0.75, 0.75, 0.8, 0.75, 0.75, 0.725, 0.725, 0.7, 0.75, 0.775]
tloss40_qcnn_5=[25.70699119567871, 25.69489288330078, 25.70417022705078, 25.69218635559082, 25.438541412353516, 25.33363151550293, 25.191728591918945, 25.17237663269043, 25.2495059967041, 25.166154861450195, 25.111623764038086, 25.135255813598633, 25.13397216796875, 25.147823333740234, 25.140331268310547, 25.145925521850586, 24.980121612548828, 25.066471099853516, 25.203025817871094, 25.273983001708984]
tacc40_qcnn_5=[0.75, 0.775, 0.725, 0.75, 0.75, 0.775, 0.8, 0.8, 0.8, 0.775, 0.825, 0.775, 0.775, 0.775, 0.8, 0.775, 0.825, 0.775, 0.725, 0.7]
train_acc40_fin_qcnn=[0.775, 0.75, 0.85,  0.75,  0.725]
test_acc40_fin_qcnn=[0.7571428571428571,0.7857142857142857, 0.7,0.7714285714285715,0.7642857142857142]

loss40qcnn=np.array([tloss40_qcnn_1,tloss40_qcnn_2,tloss40_qcnn_3,tloss40_qcnn_4,tloss40_qcnn_5])
tracc40qcnn=np.array([tacc40_qcnn_1,tacc40_qcnn_2,tacc40_qcnn_3,tacc40_qcnn_4,tacc40_qcnn_5])

missed_QCNN_40 =[34, 30, 42, 32, 33]
missed0_QCNN_40 = [32, 29, 35, 29, 29]
missed1_QCNN_40= [2, 1, 7, 3, 4]
#plot_loss(loss40qcnn,40)
#plot_accuracy(tracc40qcnn,40)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.86666667, 0.72      ]), array([0.65, 0.9 ]), array([0.74285714, 0.8       ]), array([20, 20]))
Precision, recall, f_score, support: (array([0.95, 0.68]), array([0.54285714, 0.97142857]), array([0.69090909, 0.8       ]), array([70, 70]))

Precision, recall, f_score, support: (array([0.8125    , 0.70833333]), array([0.65, 0.85]), array([0.72222222, 0.77272727]), array([20, 20]))
Precision, recall, f_score, support: (array([0.97619048, 0.70408163]), array([0.58571429, 0.98571429]), array([0.73214286, 0.82142857]), array([70, 70]))

Precision, recall, f_score, support: (array([0.9375    , 0.79166667]), array([0.75, 0.95]), array([0.83333333, 0.86363636]), array([20, 20]))
Precision, recall, f_score, support: (array([0.83333333, 0.64285714]), array([0.5, 0.9]), array([0.625, 0.75 ]), array([70, 70]))

Precision, recall, f_score, support: (array([0.91666667, 0.67857143]), array([0.55, 0.95]), array([0.6875    , 0.79166667]), array([20, 20]))
Precision, recall, f_score, support: (array([0.93181818, 0.69791667]), array([0.58571429, 0.95714286]), array([0.71929825, 0.80722892]), array([70, 70]))

Precision, recall, f_score, support: (array([0.84615385, 0.66666667]), array([0.55, 0.9 ]), array([0.66666667, 0.76595745]), array([20, 20]))
Precision, recall, f_score, support: (array([0.91111111, 0.69473684]), array([0.58571429, 0.94285714]), array([0.71304348, 0.8       ]), array([70, 70]))

"""


#### Train images = 50 : architecture QCNN

tloss50_qcnn_1=[34.48295211791992, 34.53296661376953, 33.93580627441406, 32.756038665771484, 32.61249542236328, 32.71611785888672, 32.75017166137695, 32.50200653076172, 32.58314514160156, 32.51068878173828, 32.500118255615234, 32.39152145385742, 32.4022331237793, 32.21925354003906, 32.17816925048828, 32.07389831542969, 32.24048614501953, 32.11476135253906, 31.979875564575195, 32.00556564331055]
tacc50_qcnn_1=[0.6, 0.52, 0.64, 0.76, 0.76, 0.74, 0.76, 0.7, 0.68, 0.72, 0.7, 0.72, 0.72, 0.76, 0.74, 0.76, 0.68, 0.68, 0.74, 0.74]
tloss50_qcnn_2= [32.39667892456055, 32.257633209228516, 32.28138732910156, 32.02352523803711, 32.16006851196289, 32.39139938354492, 32.5219841003418, 32.23808670043945, 32.32793426513672, 32.36515808105469, 34.635040283203125, 34.72614288330078, 34.530452728271484, 34.056358337402344, 34.64533233642578, 33.82503128051758, 34.79131317138672, 34.42597961425781, 34.25723648071289, 33.977203369140625]
tacc50_qcnn_2=[0.72, 0.74, 0.7, 0.74, 0.78, 0.76, 0.74, 0.78, 0.78, 0.78, 0.54, 0.48, 0.58, 0.64, 0.52, 0.66, 0.5, 0.6, 0.58, 0.62]
tloss50_qcnn_3= [34.29119873046875, 34.15495300292969, 34.08181381225586, 34.17196273803711, 34.12254333496094, 34.123924255371094, 34.05134582519531, 33.94919967651367, 34.121212005615234, 33.784908294677734, 33.81504440307617, 33.53920364379883, 33.52350616455078, 33.73129653930664, 33.76046371459961, 33.63288497924805, 33.68529510498047, 33.57699966430664, 33.632625579833984, 33.43785858154297]
tacc50_qcnn_3= [0.54, 0.58, 0.58, 0.62, 0.54, 0.58, 0.58, 0.6, 0.6, 0.68, 0.66, 0.66, 0.66, 0.68, 0.68, 0.68, 0.64, 0.66, 0.68, 0.78]
tloss50_qcnn_4= [33.91420364379883, 33.9109001159668, 34.02580261230469, 33.55610275268555, 33.39897155761719, 33.16468811035156, 33.21854019165039, 32.88939666748047, 33.00735855102539, 32.93197250366211, 33.03933334350586, 32.888824462890625, 32.80876159667969, 33.030609130859375, 33.08753967285156, 33.168487548828125, 33.02159881591797, 32.92820739746094, 32.954708099365234, 32.76766586303711]
tacc50_qcnn_4=  [0.7, 0.68, 0.7, 0.78, 0.78, 0.8, 0.82, 0.78, 0.74, 0.76, 0.76, 0.76, 0.78, 0.76, 0.76, 0.74, 0.76, 0.74, 0.74, 0.82]
tloss50_qcnn_5=[32.81608963012695, 32.779483795166016, 32.7977294921875, 32.66259765625, 32.70249938964844, 32.63375473022461, 32.46533203125, 32.3313102722168, 32.3390007019043, 32.32090759277344, 32.135005950927734, 32.210330963134766, 32.15164566040039, 32.18321990966797, 32.105709075927734, 32.24819564819336, 32.14931106567383, 32.206058502197266, 32.298927307128906, 32.22925567626953]
tacc50_qcnn_5=[0.72, 0.7, 0.72, 0.78, 0.78, 0.76, 0.78, 0.86, 0.84, 0.86, 0.84, 0.86, 0.82, 0.84, 0.88, 0.8, 0.86, 0.78, 0.8, 0.78]
train_acc50_fin_qcnn=[ 0.72,  0.66, 0.72,   0.8,  0.78]
test_acc50_fin_qcnn=[0.7357142857142858,0.6785714285714286, 0.7285714285714285, 0.7142857142857143,0.7642857142857142]

loss50qcnn=np.array([tloss50_qcnn_1,tloss50_qcnn_2,tloss50_qcnn_3,tloss50_qcnn_4,tloss50_qcnn_5])
tracc50qcnn=np.array([tacc50_qcnn_1,tacc50_qcnn_2,tacc50_qcnn_3,tacc50_qcnn_4,tacc50_qcnn_5])

missed_QCNN_50 =[37, 45, 38, 40, 33]
missed0_QCNN_50 =[34, 23, 26, 32, 28]
missed1_QCNN_50=[3, 22, 12, 8, 5]
#plot_loss(loss50qcnn,50)
#plot_accuracy(tracc50qcnn,50)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.76190476, 0.68965517]), array([0.64, 0.8 ]), array([0.69565217, 0.74074074]), array([25, 25]))
Precision, recall, f_score, support: (array([0.92307692, 0.66336634]), array([0.51428571, 0.95714286]), array([0.66055046, 0.78362573]), array([70, 70]))

Precision, recall, f_score, support: (array([0.7       , 0.63333333]), array([0.56, 0.76]), array([0.62222222, 0.69090909]), array([25, 25]))
Precision, recall, f_score, support: (array([0.68115942, 0.67605634]), array([0.67142857, 0.68571429]), array([0.67625899, 0.68085106]), array([70, 70]))

Precision, recall, f_score, support: (array([0.78947368, 0.67741935]), array([0.6 , 0.84]), array([0.68181818, 0.75      ]), array([25, 25]))
Precision, recall, f_score, support: (array([0.78571429, 0.69047619]), array([0.62857143, 0.82857143]), array([0.6984127 , 0.75324675]), array([70, 70]))

Precision, recall, f_score, support: (array([0.89473684, 0.74193548]), array([0.68, 0.92]), array([0.77272727, 0.82142857]), array([25, 25]))
Precision, recall, f_score, support: (array([0.82608696, 0.65957447]), array([0.54285714, 0.88571429]), array([0.65517241, 0.75609756]), array([70, 70]))

Precision, recall, f_score, support: (array([0.85      , 0.73333333]), array([0.68, 0.88]), array([0.75555556, 0.8       ]), array([25, 25]))
Precision, recall, f_score, support: (array([0.89361702, 0.69892473]), array([0.6       , 0.92857143]), array([0.71794872, 0.79754601]), array([70, 70]))
"""



#### QCNN FINAL RESULTS

#### plotto il grafico finale
training_sets = np.array([6,10,20,30,40,50])

train_accf_QCNN = np.array([train_acc6_fin_qcnn, train_acc10_fin_qcnn, train_acc20_fin_qcnn, train_acc30_fin_qcnn, train_acc40_fin_qcnn, train_acc50_fin_qcnn])
test_accf_QCNN = np.array([test_acc6_fin_qcnn,test_acc10_fin_qcnn,test_acc20_fin_qcnn,test_acc30_fin_qcnn,test_acc40_fin_qcnn,test_acc50_fin_qcnn])

av_train_qcnn = [np.mean(sublist) for sublist in train_accf_QCNN]
std_train_qcnn = [np.std(sublist) for sublist in train_accf_QCNN]
av_test_qcnn = [np.mean(sublist) for sublist in test_accf_QCNN]
std_test_qcnn = [np.std(sublist) for sublist in test_accf_QCNN]

print("TRAIN ACC AVERAGED WFQCNN:", av_train_qcnn)
print("TRAIN ACC STD WFQCNN:", std_train_qcnn)
print("TEST ACC AVERAGED WFQCNN:", av_test_qcnn)
print("TEST ACC STD WFQCNN:", std_test_qcnn)

x = np.array(training_sets)
#fig = plt.figure(figsize=(8,5))
ybest = 0.7*np.ones(len(x))
random_guess = 0.5*np.ones(len(x))
#plt.plot(x, av_train_qcnn, marker='v', label='Average train', linewidth=2.2)
#plt.plot(x, av_test_qcnn, marker='s', label='Average test', linewidth=2.2)

plt.errorbar(x, av_train_qcnn,yerr=std_train_qcnn,fmt='o',markerfacecolor='tab:blue', markeredgecolor='tab:blue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='tab:blue',ls=':')
plt.errorbar(x, av_test_qcnn, yerr=std_test_qcnn,fmt='s',markerfacecolor='tab:orange', markeredgecolor='tab:orange', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='tab:orange',ls=':')

#plt.plot(x, ybest, '--', linewidth=2.2,label='Best test accuracy value')
#plt.plot(x, ybest, '--', linewidth=2.2, label='70 perc. accuracy', color='purple')
plt.title("WFQCNN", fontsize = 12, fontweight='semibold')
plt.xlabel('Training set',fontsize = 12, fontweight='semibold')
plt.ylabel('Value',fontsize = 12, fontweight='semibold')
plt.legend(loc=4, prop={'size':16})
plt.xticks(training_sets,fontsize = 12, fontweight='semibold')

yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.savefig('/Users/francescoaldoventurelli/Desktop/QCNNansatz_WFfeaturemap.jpg', dpi=300)
plt.show()


##### QCNN ANSATZ + RING LIKE FEATURE MAP

#### 6 images of trainig with architecture == QCNN

tloss6_qcnn_RL_1=[3.699625253677368, 3.663923740386963, 3.6878747940063477, 3.676330804824829, 3.642021417617798, 3.6750335693359375, 3.637070417404175, 3.6902451515197754, 3.723405361175537, 3.687274217605591, 3.674206018447876, 3.6985268592834473, 3.7243759632110596, 3.6847574710845947, 3.7179596424102783, 3.7200746536254883, 3.7097716331481934, 3.765377998352051, 3.7858619689941406, 3.765735149383545]
tacc6_qcnn_RL_1=[0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0]
tloss6_qcnn_RL_2=[3.979017496109009, 3.988264560699463, 3.9591424465179443, 3.942422389984131, 3.867757558822632, 3.86201548576355, 3.865259885787964, 3.867967128753662, 3.797426462173462, 3.798896074295044, 3.8360636234283447, 3.8385515213012695, 3.847726345062256, 3.820859670639038, 4.123774528503418, 4.038256645202637, 4.125278949737549, 4.072275638580322, 4.074549674987793, 4.163702011108398]
tacc6_qcnn_RL_2=[0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 1.0, 0.8333333333333334, 1.0, 1.0, 0.5, 0.6666666666666666, 0.3333333333333333, 0.6666666666666666, 0.6666666666666666, 0.3333333333333333]
tloss6_qcnn_RL_3=[4.0567498207092285, 4.1005473136901855, 4.1186065673828125, 4.0871734619140625, 4.236831188201904, 4.249227523803711, 4.218129634857178, 4.092719078063965, 4.1262969970703125, 4.201621055603027, 3.9435977935791016, 3.9999282360076904, 3.9997291564941406, 4.068380355834961, 4.042233467102051, 4.107687950134277, 3.931612968444824, 3.9640867710113525, 4.102630615234375, 4.112515926361084]
tacc6_qcnn_RL_3=[0.5, 0.5, 0.3333333333333333, 0.5, 0.3333333333333333, 0.5, 0.5, 0.6666666666666666, 0.8333333333333334, 0.5, 0.8333333333333334, 0.6666666666666666, 0.8333333333333334, 0.5, 0.6666666666666666, 0.5, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.3333333333333333]
tloss6_qcnn_RL_4=[4.1685872077941895, 4.1602864265441895, 4.07407808303833, 4.052209854125977, 4.037301063537598, 4.0744171142578125, 4.092312812805176, 3.9919352531433105, 3.956677198410034, 3.9983904361724854, 3.931729793548584, 3.9376981258392334, 3.935776472091675, 3.964761734008789, 3.9492738246917725, 3.9423727989196777, 3.94710111618042, 3.9450366497039795, 3.9235661029815674, 3.9288253784179688]
tacc6_qcnn_RL_4= [0.5, 0.3333333333333333, 0.5, 0.5, 0.6666666666666666, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.5, 0.6666666666666666, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334]
tloss6_qcnn_RL_5=[4.1380839347839355, 4.163061618804932, 4.104292392730713, 4.147573471069336, 4.110901355743408, 4.027250289916992, 4.0804123878479, 4.066144943237305, 3.961643695831299, 3.9796128273010254, 3.92680025100708, 3.9083127975463867, 3.8446555137634277, 4.122337818145752, 4.219517707824707, 4.021857261657715, 4.022998809814453, 3.977282762527466, 4.036174297332764, 3.98858380317688]
tacc6_qcnn_RL_5=[0.3333333333333333, 0.5, 0.5, 0.5, 0.6666666666666666, 0.5, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 1.0, 1.0, 1.0, 0.6666666666666666, 0.3333333333333333, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 0.8333333333333334]

train_acc6_fin_qcnnRL=[0.8333333333333334, 0.8333333333333334, 0.6666666666666666, 1.0,  1.0]
test_acc6_fin_qcnnRL=[0.6071428571428571,0.5714285714285714, 0.45714285714285713, 0.5428571428571428,0.5357142857142857]

loss6qcnnRL=np.array([tloss6_qcnn_RL_1,tloss6_qcnn_RL_2,tloss6_qcnn_RL_3,tloss6_qcnn_RL_4,tloss6_qcnn_RL_5])
tracc6qcnnRL=np.array([tacc6_qcnn_RL_1,tacc6_qcnn_RL_2,tacc6_qcnn_RL_3,tacc6_qcnn_RL_4,tacc6_qcnn_RL_5])

missed_QCNN_6RL = [55, 60, 76, 64, 65]
missed0_QCNN_6RL = [39, 37, 35, 35, 37]
missed1_QCNN_6RL= [16, 23, 41, 29, 28]

x_arr = np.arange(1,21,1)
train_loss_qcnn_av6RL = np.mean(loss6qcnnRL, axis=0)
train_loss_qcnn_std6RL = np.std(loss6qcnnRL, axis=0)
train_acc_qcnn_av6RL = np.mean(tracc6qcnnRL, axis=0)
train_acc_qcnn_std6RL = np.std(tracc6qcnnRL, axis=0)



"""

Precision, recall, f_score, support: (array([1.  , 0.75]), array([0.66666667, 1.        ]), array([0.8       , 0.85714286]), array([3, 3]))
Precision, recall, f_score, support: (array([0.65957447, 0.58064516]), array([0.44285714, 0.77142857]), array([0.52991453, 0.66257669]), array([70, 70]))

Precision, recall, f_score, support: (array([0.75, 1.  ]), array([1.        , 0.66666667]), array([0.85714286, 0.8       ]), array([3, 3]))
Precision, recall, f_score, support: (array([0.58928571, 0.55952381]), array([0.47142857, 0.67142857]), array([0.52380952, 0.61038961]), array([70, 70]))

Precision, recall, f_score, support: (array([1. , 0.6]), array([0.33333333, 1.        ]), array([0.5 , 0.75]), array([3, 3]))
Precision, recall, f_score, support: (array([0.46052632, 0.453125  ]), array([0.5       , 0.41428571]), array([0.47945205, 0.43283582]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.546875  , 0.53947368]), array([0.5       , 0.58571429]), array([0.52238806, 0.56164384]), array([70, 70]))

Precision, recall, f_score, support: (array([1., 1.]), array([1., 1.]), array([1., 1.]), array([3, 3]))
Precision, recall, f_score, support: (array([0.54098361, 0.53164557]), array([0.47142857, 0.6       ]), array([0.50381679, 0.56375839]), array([70, 70]))

"""


#### Train images = 10 : architecture QCNN

tloss10_qcnn_RL_1=[6.242681980133057, 6.235224723815918, 6.278591156005859, 6.198885917663574, 6.15237283706665, 6.1639862060546875, 6.186404228210449, 6.325183391571045, 6.297275543212891, 6.310169696807861, 6.254296779632568, 6.250499248504639, 6.297874450683594, 6.346353054046631, 6.356356620788574, 6.341548442840576, 6.258205413818359, 6.223229885101318, 6.238986492156982, 6.242278575897217]
tacc10_qcnn_RL_1=[0.8, 0.8, 0.7, 0.8, 0.8, 0.8, 0.7, 0.6, 0.7, 0.6, 0.7, 0.7, 0.8, 0.8, 0.7, 0.8, 0.9, 0.9, 0.9, 0.9]
tloss10_qcnn_RL_2=[6.636332035064697, 6.604307651519775, 6.658901691436768, 6.548007011413574, 6.45498514175415, 6.39686918258667, 6.3858962059021, 6.333404064178467, 6.276463985443115, 6.327829360961914, 6.346680164337158, 6.316162109375, 6.341100215911865, 6.299643516540527, 6.289596080780029, 6.295304298400879, 6.222848892211914, 6.152714729309082, 6.124192714691162, 6.116158485412598]
tacc10_qcnn_RL_2=[0.6, 0.7, 0.7, 0.7, 0.9, 0.8, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 1.0, 0.9, 0.9, 0.9]
tloss10_qcnn_RL_3=[6.654911041259766, 6.6944451332092285, 6.65261173248291, 6.645681381225586, 6.524681568145752, 6.557950019836426, 6.669722557067871, 6.656686305999756, 6.687800884246826, 6.550405502319336, 6.5144243240356445, 6.455663681030273, 6.458257675170898, 6.478592872619629, 6.516788482666016, 6.508378982543945, 6.49904203414917, 6.5041117668151855, 6.543058395385742, 6.5734663009643555]
tacc10_qcnn_RL_3=[0.6, 0.7, 0.8, 0.7, 0.6, 0.6, 0.6, 0.6, 0.5, 0.8, 0.8, 0.9, 0.8, 0.8, 0.7, 0.7, 0.7, 0.8, 0.8, 0.7]
tloss10_qcnn_RL_4=[7.05280065536499, 7.139469623565674, 6.908960342407227, 6.867476940155029, 6.741395950317383, 6.758893966674805, 6.640705108642578, 6.628488063812256, 6.52849817276001, 6.672610282897949, 6.689586639404297, 6.635018825531006, 6.586044788360596, 6.573080539703369, 6.563232421875, 6.6451873779296875, 6.573119640350342, 6.408486843109131, 6.3097920417785645, 6.310935974121094]
tacc10_qcnn_RL_4=[0.4, 0.3, 0.5, 0.5, 0.7, 0.6, 0.7, 0.9, 0.9, 0.7, 0.6, 0.8, 0.8, 0.8, 0.9, 0.7, 0.9, 0.9, 0.9, 0.9]
tloss10_qcnn_RL_5=[7.072601795196533, 7.1106743812561035, 7.146703720092773, 6.948314189910889, 6.905399322509766, 6.716838836669922, 6.751946926116943, 6.83296537399292, 6.780868053436279, 6.880235195159912, 6.8227949142456055, 6.762106418609619, 6.603232383728027, 6.605412483215332, 6.5860595703125, 6.5986738204956055, 6.557005882263184, 6.597222328186035, 6.586272716522217, 6.513442516326904]
tacc10_qcnn_RL_5=[0.4, 0.4, 0.3, 0.5, 0.6, 0.6, 0.7, 0.7, 0.6, 0.4, 0.7, 0.7, 0.8, 0.9, 0.9, 0.8, 0.9, 0.9, 0.8, 1.0]

train_acc10_fin_qcnnRL=[0.9, 0.9, 0.4, 0.9, 0.9]
test_acc10_fin_qcnnRL=[0.5928571428571429,0.6071428571428571,0.35, 0.5785714285714286,0.6142857142857143]

loss10qcnnRL=np.array([tloss10_qcnn_RL_1,tloss10_qcnn_RL_2,tloss10_qcnn_RL_3,tloss10_qcnn_RL_4,tloss10_qcnn_RL_5])
tracc10qcnnRL=np.array([tacc10_qcnn_RL_1,tacc10_qcnn_RL_2,tacc10_qcnn_RL_3,tacc10_qcnn_RL_4,tacc10_qcnn_RL_5])

missed_QCNN_10RL = [57, 55, 91, 59, 54]
missed0_QCNN_10RL = [40, 36, 41, 34, 31]
missed1_QCNN_10RL= [17, 19, 50, 25, 23]
#plot_loss(loss10qcnn,10)
#plot_accuracy(tracc10qcnn,10)
#plt.show()

"""

Precision, recall, f_score, support: (array([1.        , 0.83333333]), array([0.8, 1. ]), array([0.88888889, 0.90909091]), array([5, 5]))
Precision, recall, f_score, support: (array([0.63829787, 0.56989247]), array([0.42857143, 0.75714286]), array([0.51282051, 0.65030675]), array([70, 70]))

Precision, recall, f_score, support: (array([0.83333333, 1.        ]), array([1. , 0.8]), array([0.90909091, 0.88888889]), array([5, 5]))
Precision, recall, f_score, support: (array([0.64150943, 0.5862069 ]), array([0.48571429, 0.72857143]), array([0.55284553, 0.64968153]), array([70, 70]))

Precision, recall, f_score, support: (array([0.42857143, 0.33333333]), array([0.6, 0.2]), array([0.5 , 0.25]), array([5, 5]))
Precision, recall, f_score, support: (array([0.36708861, 0.32786885]), array([0.41428571, 0.28571429]), array([0.38926174, 0.30534351]), array([70, 70]))

Precision, recall, f_score, support: (array([0.83333333, 1.        ]), array([1. , 0.8]), array([0.90909091, 0.88888889]), array([5, 5]))
Precision, recall, f_score, support: (array([0.59016393, 0.56962025]), array([0.51428571, 0.64285714]), array([0.54961832, 0.60402685]), array([70, 70]))

Precision, recall, f_score, support: (array([0.83333333, 1.        ]), array([1. , 0.8]), array([0.90909091, 0.88888889]), array([5, 5]))
Precision, recall, f_score, support: (array([0.62903226, 0.6025641 ]), array([0.55714286, 0.67142857]), array([0.59090909, 0.63513514]), array([70, 70]))

"""



#### Train images = 20 : architecture QCNN

tloss20_qcnn_RL_1=[12.879229545593262, 12.862651824951172, 12.845663070678711, 12.83825397491455, 12.730402946472168, 12.9371976852417, 13.078163146972656, 13.00787353515625, 12.915064811706543, 12.961074829101562, 12.989786148071289, 12.882378578186035, 12.936786651611328, 13.759121894836426, 13.842840194702148, 13.581331253051758, 13.82797622680664, 13.634344100952148, 14.025642395019531, 14.140082359313965]
tacc20_qcnn_RL_1=[0.7, 0.7, 0.75, 0.75, 0.7, 0.55, 0.55, 0.65, 0.65, 0.65, 0.65, 0.7, 0.75, 0.4, 0.4, 0.75, 0.55, 0.6, 0.5, 0.5]
tloss20_qcnn_RL_2=[13.966426849365234, 13.891639709472656, 13.5723295211792, 13.765067100524902, 13.759054183959961, 13.605234146118164, 13.680435180664062, 13.659330368041992, 13.53174877166748, 13.61391544342041, 13.606468200683594, 13.52319622039795, 13.44939136505127, 13.471305847167969, 13.394652366638184, 13.39210319519043, 13.35456657409668, 13.257993698120117, 13.1903715133667, 13.142549514770508]
tacc20_qcnn_RL_2=[0.5, 0.6, 0.7, 0.5, 0.55, 0.55, 0.55, 0.55, 0.6, 0.6, 0.6, 0.65, 0.5, 0.55, 0.6, 0.75, 0.75, 0.8, 0.8, 0.75]
tloss20_qcnn_RL_3=[13.603429794311523, 13.631814956665039, 13.60561752319336, 13.461297988891602, 13.429960250854492, 13.407604217529297, 13.584134101867676, 13.402090072631836, 13.456957817077637, 13.7081880569458, 13.509363174438477, 13.652383804321289, 13.691956520080566, 13.408292770385742, 13.44068431854248, 13.328523635864258, 13.232038497924805, 13.08330249786377, 13.216269493103027, 12.971525192260742]
tacc20_qcnn_RL_3=[0.65, 0.6, 0.55, 0.8, 0.7, 0.8, 0.7, 0.8, 0.75, 0.6, 0.65, 0.65, 0.65, 0.65, 0.75, 0.8, 0.8, 0.8, 0.65, 0.75]
tloss20_qcnn_RL_4=[13.529117584228516, 13.496173858642578, 13.45792007446289, 13.381509780883789, 13.361806869506836, 13.39073371887207, 13.3118896484375, 13.297757148742676, 13.304216384887695, 13.025964736938477, 13.352956771850586, 13.417191505432129, 13.375328063964844, 13.177532196044922, 13.112046241760254, 13.165435791015625, 13.142833709716797, 13.161336898803711, 13.126213073730469, 13.042481422424316]
tacc20_qcnn_RL_4=[0.7, 0.65, 0.7, 0.75, 0.7, 0.75, 0.8, 0.9, 0.75, 0.7, 0.6, 0.6, 0.65, 0.8, 0.75, 0.75, 0.7, 0.8, 0.75, 0.8]
tloss20_qcnn_RL_5=[13.87743091583252, 13.793846130371094, 13.868343353271484, 13.731582641601562, 13.643510818481445, 13.436904907226562, 13.369348526000977, 13.476829528808594, 13.42231273651123, 13.421521186828613, 13.255105972290039, 13.254375457763672, 13.19372272491455, 13.171357154846191, 13.242920875549316, 13.253387451171875, 13.213308334350586, 13.27759838104248, 13.31759262084961, 13.238042831420898]
tacc20_qcnn_RL_5=[0.5, 0.55, 0.5, 0.7, 0.65, 0.7, 0.75, 0.7, 0.7, 0.75, 0.65, 0.7, 0.7, 0.75, 0.6, 0.55, 0.65, 0.7, 0.75, 0.75]

train_acc20_fin_qcnnRL=[0.45, 0.8, 0.8, 0.8, 0.85]
test_acc20_fin_qcnnRL=[0.5428571428571428,0.6642857142857143,0.6357142857142857,0.5928571428571429,0.7428571428571429]

loss20qcnnRL=np.array([tloss20_qcnn_RL_1,tloss20_qcnn_RL_2,tloss20_qcnn_RL_3,tloss20_qcnn_RL_4,tloss20_qcnn_RL_5])
tracc20qcnnRL=np.array([tacc20_qcnn_RL_1,tacc20_qcnn_RL_2,tacc20_qcnn_RL_3,tacc20_qcnn_RL_4,tacc20_qcnn_RL_5])

missed_QCNN_20RL = [64, 47, 51, 57, 36]
missed0_QCNN_20RL = [34, 33, 35, 36, 24]
missed1_QCNN_20RL= [30, 14, 16, 21, 12]
#plot_loss(loss20qcnn,20)
#plot_accuracy(tracc20qcnn,20)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.46153846, 0.42857143]), array([0.6, 0.3]), array([0.52173913, 0.35294118]), array([10, 10]))
Precision, recall, f_score, support: (array([0.54545455, 0.54054054]), array([0.51428571, 0.57142857]), array([0.52941176, 0.55555556]), array([70, 70]))

Precision, recall, f_score, support: (array([1.        , 0.71428571]), array([0.6, 1. ]), array([0.75      , 0.83333333]), array([10, 10]))
Precision, recall, f_score, support: (array([0.7254902 , 0.62921348]), array([0.52857143, 0.8       ]), array([0.61157025, 0.70440252]), array([70, 70]))

Precision, recall, f_score, support: (array([0.875, 0.75 ]), array([0.7, 0.9]), array([0.77777778, 0.81818182]), array([10, 10]))
Precision, recall, f_score, support: (array([0.68627451, 0.60674157]), array([0.5       , 0.77142857]), array([0.5785124 , 0.67924528]), array([70, 70]))

Precision, recall, f_score, support: (array([0.875, 0.75 ]), array([0.7, 0.9]), array([0.77777778, 0.81818182]), array([10, 10]))
Precision, recall, f_score, support: (array([0.61818182, 0.57647059]), array([0.48571429, 0.7       ]), array([0.544     , 0.63225806]), array([70, 70]))

Precision, recall, f_score, support: (array([0.88888889, 0.81818182]), array([0.8, 0.9]), array([0.84210526, 0.85714286]), array([10, 10]))
Precision, recall, f_score, support: (array([0.79310345, 0.70731707]), array([0.65714286, 0.82857143]), array([0.71875   , 0.76315789]), array([70, 70]))

"""

### Train images = 30 : architecture QCNN

tloss30_qcnn_RL_1=[19.18959617614746, 19.253808975219727, 19.213993072509766, 19.264663696289062, 19.251338958740234, 19.228363037109375, 19.154211044311523, 19.15257453918457, 19.206974029541016, 19.18429946899414, 19.321327209472656, 19.45960807800293, 19.440336227416992, 19.37029457092285, 19.40196990966797, 19.253271102905273, 19.272552490234375, 19.271806716918945, 19.348844528198242, 19.3196964263916]
tacc30_qcnn_RL_1=[0.7333333333333333, 0.7333333333333333, 0.7, 0.7333333333333333, 0.6666666666666666, 0.7, 0.7666666666666667, 0.7, 0.7, 0.7333333333333333, 0.7333333333333333, 0.7, 0.7, 0.6666666666666666, 0.7, 0.7666666666666667, 0.8333333333333334, 0.8333333333333334, 0.8, 0.8]
tloss30_qcnn_RL_2=[19.702505111694336, 19.67205810546875, 19.74080467224121, 19.649734497070312, 19.51862335205078, 19.581785202026367, 19.523508071899414, 19.577289581298828, 19.59571647644043, 19.71416664123535, 19.7528076171875, 19.590852737426758, 19.537120819091797, 19.528385162353516, 19.566680908203125, 19.541072845458984, 19.600276947021484, 19.70391273498535, 19.770341873168945, 19.73834991455078]
tacc30_qcnn_RL_2=[0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.7, 0.7666666666666667, 0.7333333333333333, 0.7, 0.7, 0.6666666666666666, 0.7, 0.6666666666666666, 0.7333333333333333, 0.7, 0.6, 0.6666666666666666, 0.6333333333333333, 0.7, 0.6333333333333333, 0.6666666666666666]
tloss30_qcnn_RL_3=[20.514101028442383, 20.556421279907227, 20.327173233032227, 20.343849182128906, 20.228513717651367, 20.184505462646484, 20.189550399780273, 20.228511810302734, 20.16993522644043, 20.18345069885254, 20.12348747253418, 20.379993438720703, 20.10380744934082, 20.12843132019043, 20.116920471191406, 20.16205596923828, 20.24049186706543, 20.129169464111328, 20.108064651489258, 20.152542114257812]
tacc30_qcnn_RL_3=[0.4666666666666667, 0.5, 0.6333333333333333, 0.6, 0.6333333333333333, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6333333333333333, 0.7, 0.6333333333333333, 0.6, 0.6333333333333333, 0.6333333333333333, 0.7, 0.6666666666666666, 0.6333333333333333, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]
tloss30_qcnn_RL_4=[20.0194091796875, 20.051401138305664, 19.892717361450195, 19.77712059020996, 19.783613204956055, 19.576648712158203, 19.65839195251465, 19.464017868041992, 19.41535758972168, 19.47938346862793, 19.394540786743164, 19.37801742553711, 19.31661033630371, 19.113571166992188, 19.150991439819336, 19.172454833984375, 19.15035057067871, 19.342960357666016, 19.38605308532715, 19.471548080444336]
tacc30_qcnn_RL_4=[0.7, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.7333333333333333, 0.8, 0.7, 0.7666666666666667, 0.8, 0.7666666666666667, 0.8666666666666667, 0.8333333333333334, 0.8666666666666667, 0.8666666666666667, 0.8666666666666667, 0.8666666666666667, 0.9, 0.8666666666666667, 0.7666666666666667, 0.8]
tloss30_qcnn_RL_5=[20.042722702026367, 20.00617790222168, 19.923763275146484, 19.85015106201172, 19.5485782623291, 19.414052963256836, 19.400089263916016, 19.51716423034668, 19.59208869934082, 19.65121841430664, 19.672380447387695, 19.743305206298828, 19.87590789794922, 19.850004196166992, 19.927377700805664, 19.898765563964844, 19.964597702026367, 19.956653594970703, 19.87457847595215, 19.686283111572266]
tacc30_qcnn_RL_5=[0.6333333333333333, 0.5666666666666667, 0.7, 0.7333333333333333, 0.7, 0.8, 0.8333333333333334, 0.7333333333333333, 0.8, 0.7666666666666667, 0.7333333333333333, 0.7333333333333333, 0.6333333333333333, 0.6666666666666666, 0.6333333333333333, 0.5666666666666667, 0.6, 0.6333333333333333, 0.6333333333333333, 0.7]

train_acc30_fin_qcnnRL=[0.8333333333333334, 0.7, 0.6333333333333333, 0.8, 0.7333333333333333]
test_acc30_fin_qcnnRL=[0.6714285714285714,0.6571428571428571,0.6214285714285714,0.5714285714285714,0.6]

loss30qcnnRL=np.array([tloss30_qcnn_RL_1,tloss30_qcnn_RL_2,tloss30_qcnn_RL_3,tloss30_qcnn_RL_4,tloss30_qcnn_RL_5])
tracc30qcnnRL=np.array([tacc30_qcnn_RL_1,tacc30_qcnn_RL_2,tacc30_qcnn_RL_3,tacc30_qcnn_RL_4,tacc30_qcnn_RL_5])

missed_QCNN_30RL = [46, 48, 53, 60, 56]
missed0_QCNN_30RL = [34, 28, 29, 34, 31]
missed1_QCNN_30RL= [12, 20, 24, 26, 25]
#plot_loss(loss20qcnn,20)
#plot_accuracy(tracc20qcnn,20)
#plt.show()

"""

Precision, recall, f_score, support: (array([1.  , 0.75]), array([0.66666667, 1.        ]), array([0.8       , 0.85714286]), array([15, 15]))
Precision, recall, f_score, support: (array([0.75      , 0.63043478]), array([0.51428571, 0.82857143]), array([0.61016949, 0.71604938]), array([70, 70]))

Precision, recall, f_score, support: (array([0.75      , 0.66666667]), array([0.6, 0.8]), array([0.66666667, 0.72727273]), array([15, 15]))
Precision, recall, f_score, support: (array([0.67741935, 0.64102564]), array([0.6       , 0.71428571]), array([0.63636364, 0.67567568]), array([70, 70]))

Precision, recall, f_score, support: (array([0.64285714, 0.625     ]), array([0.6       , 0.66666667]), array([0.62068966, 0.64516129]), array([15, 15]))
Precision, recall, f_score, support: (array([0.63076923, 0.61333333]), array([0.58571429, 0.65714286]), array([0.60740741, 0.63448276]), array([70, 70]))

Precision, recall, f_score, support: (array([0.84615385, 0.76470588]), array([0.73333333, 0.86666667]), array([0.78571429, 0.8125    ]), array([15, 15]))
Precision, recall, f_score, support: (array([0.58064516, 0.56410256]), array([0.51428571, 0.62857143]), array([0.54545455, 0.59459459]), array([70, 70]))

Precision, recall, f_score, support: (array([0.73333333, 0.73333333]), array([0.73333333, 0.73333333]), array([0.73333333, 0.73333333]), array([15, 15]))
Precision, recall, f_score, support: (array([0.609375  , 0.59210526]), array([0.55714286, 0.64285714]), array([0.58208955, 0.61643836]), array([70, 70]))

"""



### Train images = 40 : architecture QCNN

tloss40_qcnn_RL_1=[26.201866149902344, 26.202476501464844, 26.128198623657227, 26.288028717041016, 25.967458724975586, 25.957834243774414, 25.992990493774414, 25.726518630981445, 25.87210464477539, 25.683908462524414, 25.643648147583008, 25.637866973876953, 27.61246681213379, 27.857818603515625, 27.633325576782227, 27.61801528930664, 27.57339859008789, 27.368534088134766, 27.144622802734375, 26.882307052612305]
tacc40_qcnn_RL_1=[0.7, 0.7, 0.675, 0.625, 0.675, 0.625, 0.675, 0.725, 0.7, 0.75, 0.75, 0.8, 0.525, 0.475, 0.525, 0.6, 0.575, 0.55, 0.725, 0.775]
tloss40_qcnn_RL_2=[27.10464096069336, 27.123741149902344, 27.19265365600586, 26.97861671447754, 26.706531524658203, 26.76932144165039, 26.79466438293457, 26.70941925048828, 26.75128936767578, 26.71825408935547, 26.65869903564453, 26.56827163696289, 26.617704391479492, 26.518447875976562, 26.402286529541016, 26.644268035888672, 26.45772933959961, 26.252700805664062, 26.306428909301758, 26.179542541503906]
tacc40_qcnn_RL_2=[0.675, 0.7, 0.65, 0.625, 0.775, 0.675, 0.65, 0.625, 0.625, 0.675, 0.65, 0.725, 0.725, 0.7, 0.75, 0.675, 0.775, 0.8, 0.8, 0.875]
tloss40_qcnn_RL_3=[27.641002655029297, 27.623126983642578, 27.387964248657227, 27.18691062927246, 26.92188262939453, 26.989057540893555, 26.870519638061523, 26.641876220703125, 26.418392181396484, 26.334230422973633, 26.33321189880371, 26.41501235961914, 26.556766510009766, 26.494556427001953, 26.336572647094727, 26.463193893432617, 26.266498565673828, 26.236515045166016, 26.25322723388672, 26.091646194458008]
tacc40_qcnn_RL_3=[0.575, 0.6, 0.625, 0.65, 0.7, 0.7, 0.65, 0.7, 0.775, 0.75, 0.8, 0.75, 0.675, 0.725, 0.775, 0.75, 0.725, 0.775, 0.8, 0.8]
tloss40_qcnn_RL_4=[26.88823127746582, 26.918018341064453, 26.55870819091797, 26.568801879882812, 26.562685012817383, 26.51771354675293, 26.506511688232422, 26.480857849121094, 26.505014419555664, 26.35881996154785, 26.33007049560547, 26.415241241455078, 26.367712020874023, 26.835063934326172, 26.790822982788086, 26.61808967590332, 26.55092430114746, 26.535465240478516, 25.979236602783203, 25.95581817626953]
tacc40_qcnn_RL_4=[0.675, 0.6, 0.775, 0.75, 0.75, 0.75, 0.675, 0.725, 0.725, 0.75, 0.775, 0.675, 0.725, 0.675, 0.725, 0.7, 0.625, 0.75, 0.8, 0.775]
tloss40_qcnn_RL_5=[26.918251037597656, 26.887746810913086, 26.707672119140625, 26.320077896118164, 26.290407180786133, 26.261144638061523, 26.46607780456543, 26.47893524169922, 26.504507064819336, 26.466367721557617, 26.487558364868164, 26.570404052734375, 26.50448989868164, 26.574630737304688, 27.57999038696289, 27.24958038330078, 27.22349739074707, 27.12665557861328, 27.201492309570312, 27.15277671813965]
tacc40_qcnn_RL_5=[0.575, 0.6, 0.575, 0.675, 0.65, 0.7, 0.6, 0.65, 0.625, 0.675, 0.65, 0.65, 0.625, 0.65, 0.6, 0.625, 0.675, 0.625, 0.65, 0.775]

train_acc40_fin_qcnnRL=[0.75, 0.6, 0.825, 0.8, 0.675]
test_acc40_fin_qcnnRL=[0.5928571428571429,0.6857142857142857,0.6857142857142857,0.7214285714285714,0.5642857142857143]

loss40qcnnRL=np.array([tloss40_qcnn_RL_1,tloss40_qcnn_RL_2,tloss40_qcnn_RL_3,tloss40_qcnn_RL_4,tloss40_qcnn_RL_5])
tracc40qcnnRL=np.array([tacc40_qcnn_RL_1,tacc40_qcnn_RL_2,tacc40_qcnn_RL_3,tacc40_qcnn_RL_4,tacc40_qcnn_RL_5])

missed_QCNN_40RL = [57, 44, 44, 39, 61]
missed0_QCNN_40RL = [36, 23, 27, 28, 28]
missed1_QCNN_40RL= [21, 21, 17, 11, 33]
#plot_loss(loss40qcnnRL,40)
#plot_accuracy(tracc40qcnn4RL,40)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.8125    , 0.70833333]), array([0.65, 0.85]), array([0.72222222, 0.77272727]), array([20, 20]))
Precision, recall, f_score, support: (array([0.61818182, 0.57647059]), array([0.48571429, 0.7       ]), array([0.544     , 0.63225806]), array([70, 70]))

Precision, recall, f_score, support: (array([0.61111111, 0.59090909]), array([0.55, 0.65]), array([0.57894737, 0.61904762]), array([20, 20]))
Precision, recall, f_score, support: (array([0.69117647, 0.68055556]), array([0.67142857, 0.7       ]), array([0.68115942, 0.69014085]), array([70, 70]))

Precision, recall, f_score, support: (array([1.        , 0.74074074]), array([0.65, 1.  ]), array([0.78787879, 0.85106383]), array([20, 20]))
Precision, recall, f_score, support: (array([0.71666667, 0.6625    ]), array([0.61428571, 0.75714286]), array([0.66153846, 0.70666667]), array([70, 70]))

Precision, recall, f_score, support: (array([0.83333333, 0.77272727]), array([0.75, 0.85]), array([0.78947368, 0.80952381]), array([20, 20]))
Precision, recall, f_score, support: (array([0.79245283, 0.67816092]), array([0.6       , 0.84285714]), array([0.68292683, 0.75159236]), array([70, 70]))

Precision, recall, f_score, support: (array([0.70588235, 0.65217391]), array([0.6 , 0.75]), array([0.64864865, 0.69767442]), array([20, 20]))
Precision, recall, f_score, support: (array([0.56      , 0.56923077]), array([0.6       , 0.52857143]), array([0.57931034, 0.54814815]), array([70, 70]))

"""


### Train images = 50 : architecture QCNN

tloss50_qcnn_RL_1=[32.94343566894531, 33.024864196777344, 32.8388671875, 32.97708511352539, 32.542728424072266, 32.305240631103516, 32.245323181152344, 32.11699676513672, 32.07839584350586, 32.13791275024414, 32.454341888427734, 32.52733612060547, 32.45103454589844, 32.367801666259766, 32.34537124633789, 32.22621154785156, 32.283912658691406, 32.275569915771484, 32.384464263916016, 32.55179977416992]
tacc50_qcnn_RL_1=[0.66, 0.64, 0.64, 0.6, 0.64, 0.72, 0.8, 0.74, 0.8, 0.82, 0.74, 0.74, 0.74, 0.8, 0.76, 0.8, 0.8, 0.8, 0.74, 0.7]
tloss50_qcnn_RL_2=[33.350276947021484, 33.16032409667969, 33.05282211303711, 33.10457229614258, 33.197410583496094, 33.141231536865234, 33.082759857177734, 33.00753402709961, 33.231014251708984, 33.17416000366211, 33.14017868041992, 33.15044021606445, 33.055564880371094, 33.02056121826172, 33.04777526855469, 33.09617614746094, 33.31631851196289, 33.27821731567383, 33.20166778564453, 34.33687973022461]
tacc50_qcnn_RL_2=[0.64, 0.62, 0.68, 0.72, 0.7, 0.7, 0.68, 0.72, 0.68, 0.66, 0.68, 0.66, 0.7, 0.66, 0.7, 0.72, 0.68, 0.68, 0.7, 0.66]
tloss50_qcnn_RL_3=[34.36674880981445, 34.225799560546875, 34.20856857299805, 33.9818000793457, 33.877925872802734, 33.6286506652832, 32.960086822509766, 32.9993782043457, 33.1142578125, 33.062007904052734, 33.00248336791992, 32.96958923339844, 32.86836624145508, 32.825008392333984, 32.764122009277344, 32.905025482177734, 32.7815055847168, 32.67930221557617, 32.697540283203125, 32.67161178588867]
tacc50_qcnn_RL_3=[0.6, 0.64, 0.54, 0.64, 0.74, 0.72, 0.8, 0.8, 0.76, 0.82, 0.78, 0.82, 0.8, 0.8, 0.8, 0.78, 0.78, 0.84, 0.82, 0.8]
tloss50_qcnn_RL_4=[32.61465835571289, 32.56378173828125, 32.511749267578125, 32.79302215576172, 32.70494079589844, 32.38496780395508, 32.30777359008789, 32.24795913696289, 32.3758659362793, 32.073333740234375, 32.21440887451172, 32.38843536376953, 32.69236755371094, 32.70547103881836, 32.71290969848633, 32.690086364746094, 32.66234588623047, 32.558250427246094, 32.72014617919922, 32.597129821777344]
tacc50_qcnn_RL_4=[0.74, 0.76, 0.76, 0.72, 0.76, 0.8, 0.84, 0.8, 0.76, 0.8, 0.84, 0.74, 0.74, 0.74, 0.74, 0.74, 0.72, 0.76, 0.74, 0.8]
tloss50_qcnn_RL_5=[32.73439407348633, 32.63245391845703, 32.64830780029297, 32.61067581176758, 32.68427276611328, 32.649627685546875, 32.78634262084961, 32.71883010864258, 32.603397369384766, 32.65007781982422, 32.567604064941406, 32.62668991088867, 32.64093017578125, 32.64604949951172, 32.793819427490234, 32.765647888183594, 32.751075744628906, 32.79859924316406, 32.512882232666016, 32.56143569946289]
tacc50_qcnn_RL_5=[0.76, 0.76, 0.78, 0.74, 0.72, 0.72, 0.76, 0.74, 0.72, 0.72, 0.68, 0.72, 0.76, 0.76, 0.7, 0.74, 0.72, 0.7, 0.74, 0.72]

train_acc50_fin_qcnnRL=[0.7, 0.44, 0.82, 0.76, 0.72]
test_acc50_fin_qcnnRL=[0.6928571428571428,0.4642857142857143,0.7285714285714285, 0.8142857142857143,0.7857142857142857]

loss50qcnnRL=np.array([tloss50_qcnn_RL_1,tloss50_qcnn_RL_2,tloss50_qcnn_RL_3,tloss50_qcnn_RL_4,tloss50_qcnn_RL_5])
tracc50qcnnRL=np.array([tacc50_qcnn_RL_1,tacc50_qcnn_RL_2,tacc50_qcnn_RL_3,tacc50_qcnn_RL_4,tacc50_qcnn_RL_5])

missed_QCNN_50RL = [43, 75, 38, 26, 30]
missed0_QCNN_50RL = [29, 37, 25, 21, 23]
missed1_QCNN_50RL= [14, 38, 13, 5, 7]
#plot_loss(loss40qcnnRL,40)
#plot_accuracy(tracc40qcnn4RL,40)
#plt.show()

"""

Precision, recall, f_score, support: (array([0.77777778, 0.65625   ]), array([0.56, 0.84]), array([0.65116279, 0.73684211]), array([25, 25]))
Precision, recall, f_score, support: (array([0.74545455, 0.65882353]), array([0.58571429, 0.8       ]), array([0.656     , 0.72258065]), array([70, 70]))

Precision, recall, f_score, support: (array([0.44827586, 0.42857143]), array([0.52, 0.36]), array([0.48148148, 0.39130435]), array([25, 25]))
Precision, recall, f_score, support: (array([0.46478873, 0.46376812]), array([0.47142857, 0.45714286]), array([0.46808511, 0.46043165]), array([70, 70]))

Precision, recall, f_score, support: (array([0.94444444, 0.75      ]), array([0.68, 0.96]), array([0.79069767, 0.84210526]), array([25, 25]))
Precision, recall, f_score, support: (array([0.77586207, 0.69512195]), array([0.64285714, 0.81428571]), array([0.703125, 0.75    ]), array([70, 70]))

Precision, recall, f_score, support: (array([0.88235294, 0.6969697 ]), array([0.6 , 0.92]), array([0.71428571, 0.79310345]), array([25, 25]))
Precision, recall, f_score, support: (array([0.90740741, 0.75581395]), array([0.7       , 0.92857143]), array([0.79032258, 0.83333333]), array([70, 70]))

Precision, recall, f_score, support: (array([0.78947368, 0.67741935]), array([0.6 , 0.84]), array([0.68181818, 0.75      ]), array([25, 25]))
Precision, recall, f_score, support: (array([0.87037037, 0.73255814]), array([0.67142857, 0.9       ]), array([0.75806452, 0.80769231]), array([70, 70]))

"""


#### QCNN + RINGLIKE FM FINAL RESULTS

#### plotto il grafico finale
training_sets = np.array([6,10,20,30,40,50])

train_accf_QCNN_RL = np.array([train_acc6_fin_qcnnRL, train_acc10_fin_qcnnRL, train_acc20_fin_qcnnRL, train_acc30_fin_qcnnRL, train_acc40_fin_qcnnRL, train_acc50_fin_qcnnRL])
test_accf_QCNN_RL = np.array([test_acc6_fin_qcnnRL,test_acc10_fin_qcnnRL,test_acc20_fin_qcnnRL,test_acc30_fin_qcnnRL,test_acc40_fin_qcnnRL,test_acc50_fin_qcnnRL])

av_train_qcnn_RL = [np.mean(sublist) for sublist in train_accf_QCNN_RL]
std_train_qcnn_RL = [np.std(sublist) for sublist in train_accf_QCNN_RL]
av_test_qcnn_RL = [np.mean(sublist) for sublist in test_accf_QCNN_RL]
std_test_qcnn_RL = [np.std(sublist) for sublist in test_accf_QCNN_RL]

print("TRAIN ACC AVERAGED RLQCNN:", av_train_qcnn_RL)
print("TRAIN ACC STD RLQCNN:", std_train_qcnn_RL)
print("TEST ACC AVERAGED RLQCNN:", av_test_qcnn_RL)
print("TEST ACC STD RLQCNN:", std_test_qcnn_RL)

x = np.array(training_sets)

ybest = 0.7*np.ones(len(x))
random_guess = 0.5*np.ones(len(x))
#plt.plot(x, av_train_qcnn, marker='v', label='Average train', linewidth=2.2)
#plt.plot(x, av_test_qcnn, marker='s', label='Average test', linewidth=2.2)
plt.errorbar(x, av_train_qcnn_RL,yerr=std_train_qcnn_RL,fmt='o',markerfacecolor='tab:blue', markeredgecolor='tab:blue', fillstyle='none', markersize=10,label='Train acc.', barsabove=True, capsize=4,capthick=1,color='tab:blue', ls=':')
plt.errorbar(x, av_test_qcnn_RL, yerr=std_test_qcnn_RL,fmt='s',markerfacecolor='tab:orange', markeredgecolor='tab:orange', fillstyle='none',markersize=10,label='Test acc.',barsabove=True, capsize=4,capthick=1,color='tab:orange', ls=':')
#plt.fill_between(x, np.subtract(av_train_qcnn_RL, std_train_qcnn_RL), np.add(av_train_qcnn_RL, std_train_qcnn_RL), alpha=0.1, label='Standard Deviation Train', color='blue')
#plt.fill_between(x, np.subtract(av_test_qcnn_RL, std_test_qcnn_RL), np.add(av_test_qcnn_RL, std_test_qcnn_RL), alpha=0.2, label='Standard Deviation Test', color='orange')
#plt.plot(x, ybest, '--', linewidth=2.2,label='Best test accuracy value')
#plt.plot(x, ybest, '--', linewidth=2., label='70 perc. accuracy', color='purple')
plt.title("RLQCNN", fontsize = 12, fontweight='semibold')
plt.xlabel('Training set', fontsize = 12, fontweight='semibold')
plt.ylabel('Value', fontsize = 12, fontweight='semibold')
plt.legend(loc=4,prop={'size': 16})
plt.xticks(training_sets)
yticks = np.linspace(0,1,11)
plt.yticks(yticks)
plt.savefig('/Users/francescoaldoventurelli/Desktop/QCNNansatz_RLfeaturemap.jpg', dpi=800)
plt.show()



def train_error(train_acc):
    tr_acc = np.asarray(train_acc)
    tr_error = np.zeros(len(train_acc))
    for i in range(len(train_acc)):
        tr_error[i]=1.0-tr_acc[i]
    return tr_error

def test_error(test_acc):
    test_acc = np.asarray(test_acc)
    test_error = np.zeros(len(test_acc))
    for i in range(len(test_acc)):
        test_error[i]=1.0-test_acc[i]
    return test_error

#print(train_error(train_acc50_fin_qcnnRL))

#print(test_error(test_acc50_fin_qcnnRL))
tr_error1 = train_error(av_train_qcnn_RL)
te_error1 = test_error(av_test_qcnn_RL)
tr_error2 = train_error(av_train_qcnn)
te_error2 = test_error(av_test_qcnn)

def gen_error(tr_error, te_error):
    generalization_error = np.subtract(te_error,tr_error)
    return generalization_error


g1 = gen_error(tr_error1, te_error1)
g2 = gen_error(tr_error2, te_error2)

print(g1)

x = np.array([6,10,20,30,40,50])
plt.plot(x,g1, marker='o', markersize=12,color='tab:blue',markeredgecolor='brown',label='QCNN + Ring-like fm')
plt.bar(x, tr_error1, alpha=0.3, width=4, label='Train error QCNN + RL', color='magenta')
plt.bar(x, te_error1, alpha=0.1, width=4, label='Test error QCNN + RL', color='blue')
#plt.plot(x,tr_error1, marker='o', markersize=6,color='darkblue', label='QCNN + Ring-like fm TRAIN ERROR')
#plt.plot(x,g2, marker='s', markersize=6,color='orange', label='QCNN + Waterfall fm')
#plt.plot(x,tr_error2, marker='s', markersize=6,color='darkorange', label='QCNN + Waterfall fm TRAIN ERROR')
#plt.plot(x,te_error1, marker='o', markersize=6,color='royalblue', label='QCNN + Ring-like fm TEST ERROR')
#plt.plot(x,te_error2, marker='s', markersize=6,color='orangered', label='QCNN + Waterfall fm TEST ERROR')
plt.xlabel('Train set')
plt.ylabel('Gen error Mean')
#plt.yscale('log')
plt.title('Generalization error')
plt.legend(loc=1)
plt.savefig('/Users/francescoaldoventurelli/Desktop/gen_error.jpg', dpi=300)
plt.show()



xmodels = ['WFWF3', 'WFQCNN', 'RLQCNN']
wfwf_train_acc = np.mean(av_train)
wfwf_test_acc = np.mean(av_test)
wfqcnn_train_acc = np.mean(av_train_qcnn)
wfqcnn_test_acc = np.mean(av_test_qcnn)
rlqcnn_train_acc = np.mean(av_train_qcnn_RL)
rlqcnn_test_acc = np.mean(av_test_qcnn_RL)
test_winning = [wfwf_test_acc,wfqcnn_test_acc,rlqcnn_test_acc]
train_winning = [wfwf_train_acc,wfqcnn_train_acc,rlqcnn_train_acc]

colors=['tab:red', 'tab:blue', 'tab:green']
plt.bar(xmodels,test_winning, label='Test acc.', color=[i for i in colors])
plt.legend()
plt.xlabel('Model')
plt.ylabel('Test acc.')
plt.ylim(0,1.)
plt.show()


plt.bar(xmodels,train_winning, label='Train acc.', color=[i for i in colors])
plt.legend()
plt.xlabel('Model')
plt.ylabel('Train acc.')
plt.ylim(0,1.)
plt.show()


####  QCNN + RL ENCODING SCHEME, WHERE THE QUBIT 0 IS MEASURED

### 6 TRAINING DATA POINTS

lossqcnn0q_6_1 = [4.107759952545166, 4.103800296783447, 4.096443176269531, 4.088813304901123, 4.069823265075684, 4.066412925720215, 4.055389404296875, 4.051719665527344, 4.185665607452393, 4.174457550048828, 4.166507720947266, 4.159579277038574, 4.107528209686279, 4.100400924682617, 4.089755058288574, 4.104116439819336, 4.107695579528809, 4.107695579528809]
accqcnn0q_6_1 = [0.5, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.5, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]
lossqcnn0q_6_2 = [4.203949928283691, 4.200188636779785, 4.196442604064941, 4.166670799255371, 4.1606316566467285, 4.145586013793945, 4.141885280609131, 4.127173900604248, 4.023776054382324, 4.14991569519043, 4.154027938842773, 4.108036994934082, 4.0032196044921875, 4.035764217376709, 4.031850337982178, 4.035203456878662, 4.034672737121582, 4.038619041442871, 4.026213645935059, 4.066498756408691]
accqcnn0q_6_2 = [0.5, 0.5, 0.5, 0.6666666666666666, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3333333333333333, 0.3333333333333333, 0.5, 0.5, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666]
lossqcnn0q_6_3 = [4.2444682121276855, 4.2317070960998535, 4.1102519035339355, 3.995833396911621, 3.947162389755249, 3.9171297550201416, 3.8700218200683594, 3.8562796115875244, 3.8340587615966797, 3.8235464096069336, 3.798063039779663, 3.790677309036255, 3.7803759574890137, 3.7770824432373047, 3.7806763648986816, 3.7881202697753906, 3.790677309036255, 3.8490898609161377, 3.866910934448242, 3.870004653930664]
accqcnn0q_6_3 = [0.5, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334]
lossqcnn0q_6_4 = [4.091794013977051, 4.088139533996582, 4.215422630310059, 4.149816513061523, 4.049487590789795, 4.0029497146606445, 3.9922735691070557, 3.985039710998535, 3.975123405456543, 3.942715644836426, 3.9386186599731445, 3.9378721714019775, 3.9329686164855957, 3.916294574737549, 4.422718524932861, 4.048346042633057, 4.0591044425964355, 4.2728447914123535, 4.062192916870117, 3.9354496002197266]
accqcnn0q_6_4 = [0.6666666666666666, 0.6666666666666666, 0.5, 0.5, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.6666666666666666, 0.8333333333333334, 0.16666666666666666, 0.6666666666666666, 0.6666666666666666, 0.3333333333333333, 0.6666666666666666, 0.6666666666666666]
lossqcnn0q_6_5 = [4.599051475524902, 4.59478759765625, 4.594179630279541, 4.593890190124512, 4.584755897521973, 4.465513706207275, 4.272395610809326, 4.018894195556641, 3.9512836933135986, 3.924309730529785, 3.8631412982940674, 3.864527702331543, 3.8196167945861816, 3.8172240257263184, 3.821183681488037, 3.81730055809021, 3.816265821456909, 3.8204541206359863, 3.82474946975708, 3.84362530708313]
accqcnn0q_6_5 = [0.16666666666666666, 0.16666666666666666, 0.16666666666666666, 0.16666666666666666, 0.16666666666666666, 0.0, 0.3333333333333333, 0.6666666666666666, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334]

tr_accqcnn0q_6 = [0.6666666666666666,0.5,0.8333333333333334,0.6666666666666666,0.6666666666666666]
test_accqncc0q_6 = [0.6285714285714286,0.5285714285714286,0.5857142857142857,0.4785714285714286,0.40714285714285714]

## 10 immagini

tr_accqcnn0q_10 = [0.6,0.7,0.9,0.7,0.8]
test_accqncc0q_10 = [0.4714285714285714,0.6285714285714286,0.6285714285714286,0.5142857142857142,0.6214285714285714]